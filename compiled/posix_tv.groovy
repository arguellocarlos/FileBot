{def fBL = System.getProperty("user.name");def zet = "/run/media/${fBL}";def PQZ = "$zet/Videos";def bt = [home,"$zet/Data","$zet/Music","$zet/Videos","$zet/Games","$zet/Books"].collect { it as File }.sort { qcu, FO ->  qcu.exists() <=> FO.exists() ?: qcu.diskSpace <=> FO.diskSpace }.last();def TWH = PQZ ? PQZ : bt;"$TWH/"}{"Videos/"}{def Oqd = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def dfS = "TheMovieDB::TV";def tj = [[271026, dfS],[220118, dfS],[ 74180, dfS]];def Dkr = [[236530, dfS]];def gh = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def FDq = gh == "IMDb" ? "tt${id}" : id;def SL = any { info.adult } { false };def NeD = tj.find { it[0] == FDq && it[1] == gh } != null;def at = Dkr.find { it[0] == FDq && it[1] == gh } != null;def YE = info.Keywords.findAll { it in Oqd } || NeD || SL;YE = at ? false : YE;YE ? "R18+ " : ""}{def Oc = ["CN", "JP", "KR", "KP", "TW", "HK"];def uzx = ["aeni", "donghua", "anime"];def AO = any {anime} || info.Keywords.findAll { it in uzx } || (Oc.contains(country) && genres =~ /Animation/);AO ? "Anime/" : "TV Series/"}{def dfS = "TheMovieDB::TV";def QQg = [[mb: 68854, glL: "From Me to You", kim: dfS],[mb: 94904, glL: "My Next Life as a Villainess", kim: dfS],[mb: 229743, glL: "VTuber Legend", kim: dfS],[mb: 234538, glL: "Demon Lord 2099", kim: dfS],[mb: 237045, glL: "Cherry Magic!", kim: dfS],[mb: 240633, glL: "A Journey Through Another World", kim: dfS],[mb: 245285, glL: "Failure Frame", kim: dfS],[mb: 271026, glL: "Taisho Era Contract Marriage", kim: dfS]];def gh = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def FDq = gh == "IMDb" ? "tt${id}" : id;def dfm = n;QQg.each {if (it.mb == FDq && it.kim == gh) {dfm = it.glL}};def KBp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def APc = dfm.replaceAll(KBp.collect { "\\" + it }.join('|'), '');APc = APc.replaceAll(/(\s|\.)*$/, '');APc}{def dfS = "TheMovieDB::TV";def Sgl = [[ 68854, dfS],[123542, dfS],[204098, dfS],[235973, dfS],[239779, dfS],[240125, dfS],[257162, dfS],[259140, dfS],[262295, dfS],[271026, dfS],[273190, dfS],[275695, dfS]];def gFH = Sgl.find { it[0] == id && it[1] == info.database } != null;def duR = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def gNi = duR[info.database];gFH ? " ($y) [${gNi}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def KBp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def APc = sn.replaceAll(KBp.collect { "\\" + it }.join('|'), '_');def VEm = n.replaceAll(KBp.collect { "\\" + it }.join('|'), '_');def fM = APc.contains(VEm) ? "" : APc;fM == 'Season '+ s ? "" : fM ? " - " + fM : ""}{"/"}{def zZj = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def T_ = zZj.find { mG ->  fn.contains(mG) } ?: "";def wJ = any {(fn =~ /^\[(.*?)\]/)[0][1]} {T_} {group} {""};wJ ? "[$wJ] " : ""}{def dfS = "TheMovieDB::TV";def QQg = [[mb: 68854, glL: "From Me to You", kim: dfS],[mb: 94904, glL: "My Next Life as a Villainess", kim: dfS],[mb: 229743, glL: "VTuber Legend", kim: dfS],[mb: 234538, glL: "Demon Lord 2099", kim: dfS],[mb: 237045, glL: "Cherry Magic!", kim: dfS],[mb: 240633, glL: "A Journey Through Another World", kim: dfS],[mb: 245285, glL: "Failure Frame", kim: dfS],[mb: 271026, glL: "Taisho Era Contract Marriage", kim: dfS]];def gh = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def FDq = gh == "IMDb" ? "tt${id}" : id;def dfm = n;QQg.each {if (it.mb == FDq && it.kim == gh) {dfm = it.glL}};def KBp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def APc = dfm.replaceAll(KBp.collect { "\\" + it }.join('|'), '');APc = APc.replaceAll(/(\s|\.)*$/, '');APc}{" - "}{s00e00}{def KBp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def APc = t.replaceAll(KBp.collect { "\\" + it }.join('|'), '_');def PO = any { e } { special };APc = APc.length() > 100 ? " " : " - $APc ";APc == " - Episode $PO " ? " " : APc}{" ["}{def LL = [[KC: "ABEMA", KN: ["ABEMA"]],[KC: "Bilibili.tv", KN: ["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"]],[KC: "Hulu", KN: ["HULU"]],[KC: "iQIYI", KN: ["IQ.WEB-DL", "IQIYI"]],[KC: "Laftel.tv", KN: ["LAFTEL", "LFTL"]],[KC: "MeWatch", KN: ["MW.WEB-DL"]],[KC: "Netflix", KN: ["NF.WEB-DL", "NF WEB"]],[KC: "Prime Video", KN: ["AMZN"]],[KC: "Shahid", KN: ["SHAHID"]],[KC: "TVer", KN: ["TVER"]],[KC: "U-NEXT", KN: ["UNEXT"]],[KC: "YouTube", KN: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def AB = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def gM = ["Erai-raws", "SubsPlease"];def sv = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def lgl = any {def Wca = LL.find { RYM ->  RYM.KN.find { uJ ->  fn.contains(uJ) } }?.KN.qcu() ?: "";Wca = Wca.replace(".WEB-DL", "");Wca ? "${Wca}.WEB-DL" : ""} {source} {AB.find { Hyp ->  group == Hyp || sv == Hyp } ? "WEBRip" : ""} {def WlX = gM.find { SgR ->  group == SgR || sv == SgR} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : WlX} {vs} {""};lgl ? "$lgl " : ""}{def kjq = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $kjq, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def uyE = " Dub";def JWV = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : uyE;JWV = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : JWV;JWV}{def hj = any { audioLanguages.size() } { 0 };def JWV = hj > 2 ? " MAud" : hj > 1 ? " DAud" : null;def QBO = hj > 5 ? audioLanguages.take(5) : audioLanguages;JWV ? JWV + QBO.joining(" ", " (", "").upper() + (hj > 5 ? " ...)" : ")") : ""}{def CQ = any { textLanguages.size() } { 0 };def JWV = CQ > 2 ? ", MSub" : CQ > 1 ? ", DSub" : null;def QBO = CQ > 5 ? textLanguages.take(5) : textLanguages;JWV ? JWV + QBO.joining(" ", " (", "").upper() + (CQ > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def ku = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Rh = subt;ku.values().each { woh -> if (Rh.contains(woh)) {Rh = Rh.replace(woh, "")}};f.subtitle ? ku.iso3b + Rh : ""}{f.image ? "-thumb" : ""}