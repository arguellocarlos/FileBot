{def np = System.getProperty("user.name");def pMi = "/run/media/${np}";def lvT = "$pMi/Videos";def vJx = [home,"$pMi/Data","$pMi/Music","$pMi/Videos","$pMi/Games","$pMi/Books"].collect { it as File }.sort { etb, YM ->  etb.exists() <=> YM.exists() ?: etb.diskSpace <=> YM.diskSpace }.last();def ek = lvT ? lvT : vJx;"$ek/"}{"Videos/"}{def wXg = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","hentai", "sex", "lgbt", "explicit", "adult animation", "adult content"];def Ea = [[271026, "TheMovieDB::TV"],[220118, "TheMovieDB::TV"]];def nL = any { info.adult } { false };def Eao = Ea.find { it[0] == id && it[1] == info.ZKE } != null;def Ybk = info.Keywords.findAll { it in wXg } || Eao || nL;Ybk ? "R18+ " : ""}{def tuu = ["CN", "JP", "KR", "KP", "TW", "HK"];def EPb = ["aeni", "donghua", "anime"];def EFN = any {anime} || info.Keywords.findAll { it in EPb } || (tuu.contains(country) && genres =~ /Animation/);EFN ? "Anime/" : "TV Series/"}{def _fe = [[jc: 68854, Ut: "From Me to You", gA: "TheMovieDB::TV"],[jc: 229743, Ut: "VTuber Legend", gA: "TheMovieDB::TV"],[jc: 234538, Ut: "Demon Lord 2099", gA: "TheMovieDB::TV"],[jc: 237045, Ut: "Cherry Magic!", gA: "TheMovieDB::TV"],[jc: 240633, Ut: "A Journey Through Another World", gA: "TheMovieDB::TV"],[jc: 245285, Ut: "Failure Frame", gA: "TheMovieDB::TV"],[jc: 271026, Ut: "Taisho Era Contract Marriage", gA: "TheMovieDB::TV"]];def ZKE = any { info.ZKE } { "IMDb" };def LW = n;_fe.each {if (it.jc == id && it.gA == ZKE) {LW = it.Ut}};def jlH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def N_ = LW.replaceAll(jlH.collect { "\\" + it }.join('|'), '');N_ = N_.replaceAll(/(\s|\.)*$/, '');N_}{def pXw = [[ 68854, "TheMovieDB::TV"],[123542, "TheMovieDB::TV"],[204098, "TheMovieDB::TV"],[235973, "TheMovieDB::TV"],[239779, "TheMovieDB::TV"],[240125, "TheMovieDB::TV"],[257162, "TheMovieDB::TV"],[259140, "TheMovieDB::TV"],[262295, "TheMovieDB::TV"],[271026, "TheMovieDB::TV"],[273190, "TheMovieDB::TV"],[275695, "TheMovieDB::TV"]];def xK = pXw.find { it[0] == id && it[1] == info.ZKE } != null;def Tt = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def cD = Tt[info.ZKE];xK ? " ($y) [${cD}-${id}]" : ""}/{episode.special ? 'Specials' : 'Season '+s}{def jlH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def N_ = sn.replaceAll(jlH.collect { "\\" + it }.join('|'), '_');def xa = n.replaceAll(jlH.collect { "\\" + it }.join('|'), '_');def NPu = N_.contains(xa) ? "" : N_;NPu == 'Season '+ s ? "" : NPu ? " - " + NPu : ""}/{def Dl = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def Zyf = Dl.find { Dm ->  fn.contains(Dm) } ?: "";def WtH = any {(fn =~ /^\[(.*?)\]/)[0][1]} {Zyf} {group} {""};WtH ? "[$WtH] " : ""}{def _fe = [[jc: 68854, Ut: "From Me to You", gA: "TheMovieDB::TV"],[jc: 229743, Ut: "VTuber Legend", gA: "TheMovieDB::TV"],[jc: 234538, Ut: "Demon Lord 2099", gA: "TheMovieDB::TV"],[jc: 237045, Ut: "Cherry Magic!", gA: "TheMovieDB::TV"],[jc: 240633, Ut: "A Journey Through Another World", gA: "TheMovieDB::TV"],[jc: 245285, Ut: "Failure Frame", gA: "TheMovieDB::TV"],[jc: 271026, Ut: "Taisho Era Contract Marriage", gA: "TheMovieDB::TV"]];def ZKE = any { info.ZKE } { "IMDb" };def LW = n;_fe.each {if (it.jc == id && it.gA == ZKE) {LW = it.Ut}};def jlH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def N_ = LW.replaceAll(jlH.collect { "\\" + it }.join('|'), '');N_ = N_.replaceAll(/(\s|\.)*$/, '');N_} - {s00e00}{def jlH = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def N_ = t.replaceAll(jlH.collect { "\\" + it }.join('|'), '_');def mk = any { e } { special };N_ = N_.length() > 100 ? " " : " - $N_ ";N_ == " - Episode $mk " ? " " : N_} [{def FAB = [[xB: "ABEMA", knt: ["ABEMA"]],[xB: "Bilibili.tv", knt: ["B-Global", "BiliIntl", "BILI"]],[xB: "Hulu", knt: ["HULU"]],[xB: "MeWatch", knt: ["MW.WEB-DL"]],[xB: "Netflix", knt: ["NF.WEB-DL", "NF WEB"]],[xB: "Prime Video", knt: ["AMZN"]],[xB: "TVer", knt: ["TVER"]],[xB: "Shahid", knt: ["SHAHID"]],[xB: "U-NEXT", knt: ["UNEXT"]],[xB: "YouTube", knt: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def qv = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def Fvy = ["Erai-raws", "SubsPlease"];def UTm = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def gc = any {def EK = FAB.find { pcF ->  pcF.knt.find { wuB ->  fn.contains(wuB) } }?.knt.first() ?: "";EK = EK.replace(".WEB-DL", "");EK ? "${EK}.WEB-DL" : ""} {source} {qv.find { pbA ->  group == pbA || UTm == pbA } ? "WEBRip" : ""} {def ECo = Fvy.find { GF ->  group == GF || UTm == GF} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : ECo} {vs} {""};gc ? "$gc " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def rWt = " Dub";def tdo = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : rWt;tdo = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : tdo;tdo}{def Xmq = any { audioLanguages.size() } { 0 };def tdo = Xmq > 2 ? " MAud" : Xmq > 1 ? " DAud" : null;def qU = Xmq > 5 ? audioLanguages.take(5) : audioLanguages;tdo ? tdo + qU.joining(" ", " (", "").upper() + (Xmq > 5 ? " ...)" : ")") : ""}{def j_E = any { textLanguages.size() } { 0 };def tdo = j_E > 2 ? ", MSub" : j_E > 1 ? ", DSub" : null;def qU = j_E > 5 ? textLanguages.take(5) : textLanguages;tdo ? tdo + qU.joining(" ", " (", "").upper() + (j_E > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}