{def AJ = System.getProperty("user.name");def QXM = "/run/media/${AJ}";def GJi = "$QXM/Videos";def nwa = [home,"$QXM/Data","$QXM/Music","$QXM/Videos","$QXM/Games","$QXM/Books"].collect { it as File }.sort { HBM, wS ->  HBM.exists() <=> wS.exists() ?: HBM.diskSpace <=> wS.diskSpace }.last();def etc = GJi ? GJi : nwa;"$etc/"}{def bBT = /(CN|JP|KR|KP|TW|HK)/;def qOP = /(aeni|donghua|anime)/;def qiw = anime || info.Keywords =~ qOP || (genres =~ /Animation/ && country =~ bBT) ? true : false;qiw ? "Videos/Anime/" : "Videos/TV Series/"}{def SU = [[yfW: 229743, Qx: "VTuber Legend"],[yfW: 240633, Qx: "A Journey Through Another World"],[yfW: 245285, Qx: "Failure Frame"],[yfW: 237045, Qx: "Cherry Magic!"],[yfW: 68854, Qx: "From Me to You"],[yfW: 271026, Qx: "Taisho Era Contract Marriage"],[yfW: 234538, Qx: "Demon Lord 2099"]];def cF = n;SU.each {if (it.yfW == tmdbid && type.toString() != "Movie") {cF = it.Qx}};def Rex = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def mu = cF.replaceAll(Rex.collect { "\\" + it }.join('|'), '');mu = mu.replaceAll(/(\s|\.)*$/, '');mu}{def LWn = [68854,235973,262295,259140,204098,239779,273190,271026,240125,275695,123542,257162];def vV = LWn.find { RlQ ->  tmdbid == RlQ } ?: "";vV ? " ($y) [tmdbid-$vV]" : ""}/{episode.special ? 'Specials' : 'Season '+s}{def Rex = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def mu = sn.replaceAll(Rex.collect { "\\" + it }.join('|'), '_');def kr = n.replaceAll(Rex.collect { "\\" + it }.join('|'), '_');def lXI = mu.contains(kr) ? "" : mu;lXI == 'Season '+ s ? "" : lXI ? " - " + lXI : ""}/{def GJH = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def vr = GJH.find { XJ ->  fn.contains(XJ) } ?: "";def Xbz = any {(fn =~ /^\[(.*?)\]/)[0][1]} {vr} {group} {""};Xbz ? "[$Xbz] " : ""}{def SU = [[yfW: 229743, Qx: "VTuber Legend"],[yfW: 240633, Qx: "A Journey Through Another World"],[yfW: 245285, Qx: "Failure Frame"],[yfW: 237045, Qx: "Cherry Magic!"],[yfW: 68854, Qx: "From Me to You"],[yfW: 271026, Qx: "Taisho Era Contract Marriage"],[yfW: 234538, Qx: "Demon Lord 2099"]];def cF = n;SU.each {if (it.yfW == tmdbid && type.toString() != "Movie") {cF = it.Qx}};def Rex = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def mu = cF.replaceAll(Rex.collect { "\\" + it }.join('|'), '');mu = mu.replaceAll(/(\s|\.)*$/, '');mu} - {s00e00}{def Rex = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def mu = t.replaceAll(Rex.collect { "\\" + it }.join('|'), '_');mu.length() > 100 ? " " : " - $mu "} [{def ju = [[dj: "Bilibili.tv", Eou: ["B-Global", "BiliIntl", "BILI"]],[dj: "Prime Video", Eou: ["AMZN"]],[dj: "U-NEXT", Eou: ["UNEXT"]],[dj: "ABEMA", Eou: ["ABEMA"]],[dj: "Hulu", Eou: ["HULU"]],[dj: "Shahid", Eou: ["SHAHID"]],[dj: "YouTube", Eou: ["YT.WEB-DL", "YOUTUBE", "YTB"]],[dj: "Netflix", Eou: ["NF.WEB-DL", "NF WEB"]]];def zc = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def uAl = ["Erai-raws", "SubsPlease"];def toh = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def KS = any {def cc = ju.find { in ->  in.Eou.find { kiP ->  fn.contains(kiP) } }?.Eou.first() ?: "";cc = cc.replace(".WEB-DL", "");cc ? "${cc}.WEB-DL" : ""} {source} {zc.find { hv ->  group == hv || toh == hv } ? "WEBRip" : ""} {def MK = uAl.find { DOi ->  group == DOi || toh == DOi} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : MK} {vs} {""};KS ? "$KS " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def Ofj = " Dub";def NFO = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Ofj;NFO = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : NFO;NFO}{def StZ = any { audioLanguages.size() } { 0 };def NFO = StZ > 2 ? " MAud" : StZ > 1 ? " DAud" : null;def Lis = StZ > 5 ? audioLanguages.take(5) : audioLanguages;NFO ? NFO + Lis.joining(" ", " (", "").upper() + (StZ > 5 ? " ...)" : ")") : ""}{def jxE = any { textLanguages.size() } { 0 };def NFO = jxE > 2 ? ", MSub" : jxE > 1 ? ", DSub" : null;def Lis = jxE > 5 ? textLanguages.take(5) : textLanguages;NFO ? NFO + Lis.joining(" ", " (", "").upper() + (jxE > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}