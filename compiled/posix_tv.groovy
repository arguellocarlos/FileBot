{def yi = System.getProperty("user.name");def AA = "/run/media/${yi}";def tSA = "$AA/Videos";def RCd = [home,"$AA/Data","$AA/Music","$AA/Videos","$AA/Games","$AA/Books"].collect { it as File }.sort { hko, pzW ->  hko.exists() <=> pzW.exists() ?: hko.diskSpace <=> pzW.diskSpace }.last();def xGD = tSA ? tSA : RCd;"$xGD/"}{def cNX = /(CN|JP|KR|KP|TW|HK)/;def SUT = /(aeni|donghua|anime)/;def LE = anime || info.Keywords =~ SUT || (genres =~ /Animation/ && country =~ cNX) ? true : false;LE ? "Videos/Anime/" : "Videos/TV Series/"}{def uU = [[fTW: 229743, Jz: "VTuber Legend"],[fTW: 240633, Jz: "A Journey Through Another World"],[fTW: 245285, Jz: "Failure Frame"],[fTW: 237045, Jz: "Cherry Magic!"],[fTW: 68854, Jz: "From Me to You"],[fTW: 271026, Jz: "Taisho Era Contract Marriage"],[fTW: 234538, Jz: "Demon Lord 2099"]];def jwJ = n;uU.each {if (it.fTW == tmdbid && type.toString() != "Movie") {jwJ = it.Jz}};def yEN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def iUt = jwJ.replaceAll(yEN.collect { "\\" + it }.join('|'), '');iUt = iUt.replaceAll(/(\s|\.)*$/, '');iUt}{def AtZ = [68854,235973,262295,259140,204098,239779,273190,271026,240125,275695,123542,257162];def Hb = AtZ.find { LdC ->  tmdbid == LdC } ?: "";Hb ? " ($y) [tmdbid-$Hb]" : ""}/{episode.special ? 'Specials' : 'Season '+s}{def yEN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def iUt = sn.replaceAll(yEN.collect { "\\" + it }.join('|'), '_');def qy = n.replaceAll(yEN.collect { "\\" + it }.join('|'), '_');def MR = iUt.contains(qy) ? "" : iUt;MR == 'Season '+ s ? "" : MR ? " - " + MR : ""}/{def yMO = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def XV = yMO.find { RrF ->  fn.contains(RrF) } ?: "";def XfR = any {(fn =~ /^\[(.*?)\]/)[0][1]} {XV} {group} {""};XfR ? "[$XfR] " : ""}{def uU = [[fTW: 229743, Jz: "VTuber Legend"],[fTW: 240633, Jz: "A Journey Through Another World"],[fTW: 245285, Jz: "Failure Frame"],[fTW: 237045, Jz: "Cherry Magic!"],[fTW: 68854, Jz: "From Me to You"],[fTW: 271026, Jz: "Taisho Era Contract Marriage"],[fTW: 234538, Jz: "Demon Lord 2099"]];def jwJ = n;uU.each {if (it.fTW == tmdbid && type.toString() != "Movie") {jwJ = it.Jz}};def yEN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def iUt = jwJ.replaceAll(yEN.collect { "\\" + it }.join('|'), '');iUt = iUt.replaceAll(/(\s|\.)*$/, '');iUt} - {s00e00}{def yEN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def iUt = t.replaceAll(yEN.collect { "\\" + it }.join('|'), '_');def Vyq = any { e } { special };iUt = iUt.length() > 100 ? " " : " - $iUt ";iUt == " - Episode $Vyq " ? " " : iUt} [{def uK = [[Wu: "Bilibili.tv", kpV: ["B-Global", "BiliIntl", "BILI"]],[Wu: "Prime Video", kpV: ["AMZN"]],[Wu: "U-NEXT", kpV: ["UNEXT"]],[Wu: "ABEMA", kpV: ["ABEMA"]],[Wu: "Hulu", kpV: ["HULU"]],[Wu: "Shahid", kpV: ["SHAHID"]],[Wu: "YouTube", kpV: ["YT.WEB-DL", "YOUTUBE", "YTB"]],[Wu: "Netflix", kpV: ["NF.WEB-DL", "NF WEB"]]];def ZBG = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def Azk = ["Erai-raws", "SubsPlease"];def AbC = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def Lq = any {def fJ = uK.find { so ->  so.kpV.find { _e ->  fn.contains(_e) } }?.kpV.first() ?: "";fJ = fJ.replace(".WEB-DL", "");fJ ? "${fJ}.WEB-DL" : ""} {source} {ZBG.find { Zx ->  group == Zx || AbC == Zx } ? "WEBRip" : ""} {def ZA = Azk.find { _ID ->  group == _ID || AbC == _ID} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : ZA} {vs} {""};Lq ? "$Lq " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def ivi = " Dub";def JgX = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : ivi;JgX = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : JgX;JgX}{def nBY = any { audioLanguages.size() } { 0 };def JgX = nBY > 2 ? " MAud" : nBY > 1 ? " DAud" : null;def fW = nBY > 5 ? audioLanguages.take(5) : audioLanguages;JgX ? JgX + fW.joining(" ", " (", "").upper() + (nBY > 5 ? " ...)" : ")") : ""}{def RB = any { textLanguages.size() } { 0 };def JgX = RB > 2 ? ", MSub" : RB > 1 ? ", DSub" : null;def fW = RB > 5 ? textLanguages.take(5) : textLanguages;JgX ? JgX + fW.joining(" ", " (", "").upper() + (RB > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}