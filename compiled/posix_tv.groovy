{def oAq = System.getProperty("user.name");def iz = "/run/media/${oAq}";def CVB = "$iz/Videos";def Ca = [home,"$iz/Data","$iz/Music","$iz/Videos","$iz/Games","$iz/Books"].collect { it as File }.sort { sZ, LlL ->  sZ.exists() <=> LlL.exists() ?: sZ.diskSpace <=> LlL.diskSpace }.last();def Ayl = CVB ? CVB : Ca;"$Ayl/"}{"Videos/"}{def Vfx = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def fA = "TheMovieDB::TV";def ib = [[271026, fA],[220118, fA],[ 74180, fA]];def akD = [[236530, fA]];def FKe = any { info.database } { "IMDb" };def ut = FKe == "IMDb" ? "tt${id}" : id;def nu = any { info.adult } { false };def GZ = ib.find { it[0] == ut && it[1] == FKe } != null;def dor = akD.find { it[0] == ut && it[1] == FKe } != null;def aw = info.Keywords.findAll { it in Vfx } || GZ || nu;aw = dor ? false : aw;aw ? "R18+ " : ""}{def Of = ["CN", "JP", "KR", "KP", "TW", "HK"];def Wf = ["aeni", "donghua", "anime"];def HQI = any {anime} || info.Keywords.findAll { it in Wf } || (Of.contains(country) && genres =~ /Animation/);HQI ? "Anime/" : "TV Series/"}{def fA = "TheMovieDB::TV";def EU = [[q_H: 68854, Gmj: "From Me to You", quE: fA],[q_H: 229743, Gmj: "VTuber Legend", quE: fA],[q_H: 234538, Gmj: "Demon Lord 2099", quE: fA],[q_H: 237045, Gmj: "Cherry Magic!", quE: fA],[q_H: 240633, Gmj: "A Journey Through Another World", quE: fA],[q_H: 245285, Gmj: "Failure Frame", quE: fA],[q_H: 271026, Gmj: "Taisho Era Contract Marriage", quE: fA]];def FKe = any { info.database } { "IMDb" };def ut = FKe == "IMDb" ? "tt${id}" : id;def bWv = n;EU.each {if (it.q_H == ut && it.quE == FKe) {bWv = it.Gmj}};def Kn = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rp = bWv.replaceAll(Kn.collect { "\\" + it }.join('|'), '');rp = rp.replaceAll(/(\s|\.)*$/, '');rp}{def fA = "TheMovieDB::TV";def IC = [[ 68854, fA],[123542, fA],[204098, fA],[235973, fA],[239779, fA],[240125, fA],[257162, fA],[259140, fA],[262295, fA],[271026, fA],[273190, fA],[275695, fA]];def oGD = IC.find { it[0] == id && it[1] == info.database } != null;def mQx = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def etY = mQx[info.database];oGD ? " ($y) [${etY}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def Kn = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rp = sn.replaceAll(Kn.collect { "\\" + it }.join('|'), '_');def IG = n.replaceAll(Kn.collect { "\\" + it }.join('|'), '_');def Ki = rp.contains(IG) ? "" : rp;Ki == 'Season '+ s ? "" : Ki ? " - " + Ki : ""}{"/"}{def qXJ = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def CYY = qXJ.find { Iu ->  fn.contains(Iu) } ?: "";def Vhp = any {(fn =~ /^\[(.*?)\]/)[0][1]} {CYY} {group} {""};Vhp ? "[$Vhp] " : ""}{def fA = "TheMovieDB::TV";def EU = [[q_H: 68854, Gmj: "From Me to You", quE: fA],[q_H: 229743, Gmj: "VTuber Legend", quE: fA],[q_H: 234538, Gmj: "Demon Lord 2099", quE: fA],[q_H: 237045, Gmj: "Cherry Magic!", quE: fA],[q_H: 240633, Gmj: "A Journey Through Another World", quE: fA],[q_H: 245285, Gmj: "Failure Frame", quE: fA],[q_H: 271026, Gmj: "Taisho Era Contract Marriage", quE: fA]];def FKe = any { info.database } { "IMDb" };def ut = FKe == "IMDb" ? "tt${id}" : id;def bWv = n;EU.each {if (it.q_H == ut && it.quE == FKe) {bWv = it.Gmj}};def Kn = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rp = bWv.replaceAll(Kn.collect { "\\" + it }.join('|'), '');rp = rp.replaceAll(/(\s|\.)*$/, '');rp}{" - "}{s00e00}{def Kn = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rp = t.replaceAll(Kn.collect { "\\" + it }.join('|'), '_');def VqK = any { e } { special };rp = rp.length() > 100 ? " " : " - $rp ";rp == " - Episode $VqK " ? " " : rp}{" ["}{def ncZ = [[Wp: "ABEMA", Izy: ["ABEMA"]],[Wp: "Bilibili.tv", Izy: ["B-Global", "BiliIntl", "BILI"]],[Wp: "Hulu", Izy: ["HULU"]],[Wp: "MeWatch", Izy: ["MW.WEB-DL"]],[Wp: "Netflix", Izy: ["NF.WEB-DL", "NF WEB"]],[Wp: "Prime Video", Izy: ["AMZN"]],[Wp: "TVer", Izy: ["TVER"]],[Wp: "Shahid", Izy: ["SHAHID"]],[Wp: "U-NEXT", Izy: ["UNEXT"]],[Wp: "YouTube", Izy: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def kRP = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def MWu = ["Erai-raws", "SubsPlease"];def Wj = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def IU = any {def gFb = ncZ.find { ev ->  ev.Izy.find { eN ->  fn.contains(eN) } }?.Izy.first() ?: "";gFb = gFb.replace(".WEB-DL", "");gFb ? "${gFb}.WEB-DL" : ""} {source} {kRP.find { Ga ->  group == Ga || Wj == Ga } ? "WEBRip" : ""} {def BDq = MWu.find { FYA ->  group == FYA || Wj == FYA} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : BDq} {vs} {""};IU ? "$IU " : ""}{def dAn = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $dAn, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def hW = " Dub";def eI = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : hW;eI = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : eI;eI}{def Up = any { audioLanguages.size() } { 0 };def eI = Up > 2 ? " MAud" : Up > 1 ? " DAud" : null;def ulp = Up > 5 ? audioLanguages.take(5) : audioLanguages;eI ? eI + ulp.joining(" ", " (", "").upper() + (Up > 5 ? " ...)" : ")") : ""}{def PHe = any { textLanguages.size() } { 0 };def eI = PHe > 2 ? ", MSub" : PHe > 1 ? ", DSub" : null;def ulp = PHe > 5 ? textLanguages.take(5) : textLanguages;eI ? eI + ulp.joining(" ", " (", "").upper() + (PHe > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def cV = ["ass", "srt", "ssa", "vtt", "ttml"];def mOV = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def FaV = subt;mOV.values().each { pqU -> if (FaV.contains(pqU)) {FaV = FaV.replace(pqU, "")}};cV.contains(ext) ? mOV.iso3b + FaV : ""}{def cV = ["jpg", "jpeg", "png", "bmp"];cV.contains(ext) ? "-thumb" : ""}