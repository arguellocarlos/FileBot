{def QiL = System.getProperty("user.name");def CTp = "/run/media/${QiL}";def gE = "$CTp/Videos";def lsF = [home,"$CTp/Data","$CTp/Music","$CTp/Videos","$CTp/Games","$CTp/Books"].collect { it as File }.sort { ww,iZ ->  ww.exists() <=> iZ.exists() ?:ww.diskSpace <=> iZ.diskSpace }.last();def lh = gE ? gE : lsF;"$lh/"}{"Videos/"}{def OtS = ["boys' love (bl)","gay theme","yaoi","yuri","lesbian","hentai","hentai","sex","lgbt","explicit","adult animation","adult content"];def Ga = "TheMovieDB::TV";def _i = [[271026,Ga],[220118,Ga]];def W_ = [[236530,Ga]];def oj = any { info.database } { "IMDb" };def uk = oj == "IMDb" ? "tt${id}" : id;def uVH = any { info.adult } { false };def XkH = _i.find { it[0] == uk && it[1] == oj } != null;def gHY = W_.find { it[0] == uk && it[1] == oj } != null;def NzF = info.Keywords.findAll { it in OtS } || XkH || uVH;NzF = gHY ? false : NzF;NzF ? "R18+ " : ""}{def GhZ = ["CN","JP","KR","KP","TW","HK"];def KiL = ["aeni","donghua","anime"];def FP = any {anime} || info.Keywords.findAll { it in KiL } || (GhZ.contains(country) && genres =~ /Animation/);FP ? "Anime/" : "TV Series/"}{def Ga = "TheMovieDB::TV";def LpP = [[Jul:68854,wE:"From Me to You",ms:Ga],[Jul:229743,wE:"VTuber Legend",ms:Ga],[Jul:234538,wE:"Demon Lord 2099",ms:Ga],[Jul:237045,wE:"Cherry Magic!",ms:Ga],[Jul:240633,wE:"A Journey Through Another World",ms:Ga],[Jul:245285,wE:"Failure Frame",ms:Ga],[Jul:271026,wE:"Taisho Era Contract Marriage",ms:Ga]];def oj = any { info.database } { "IMDb" };def uk = oj == "IMDb" ? "tt${id}" : id;def AQb = n;LpP.each {if (it.Jul == uk && it.ms == oj) {AQb = it.wE}};def wo = ['\\','/',':','*','?','"','<','>','|'];def KHa = AQb.replaceAll(wo.collect { "\\" + it }.join('|'),'');KHa = KHa.replaceAll(/(\s|\.)*$/,'');KHa}{def Ga = "TheMovieDB::TV";def rNi = [[ 68854,Ga],[123542,Ga],[204098,Ga],[235973,Ga],[239779,Ga],[240125,Ga],[257162,Ga],[259140,Ga],[262295,Ga],[271026,Ga],[273190,Ga],[275695,Ga]];def Abh = rNi.find { it[0] == id && it[1] == info.database } != null;def Yl = ["TheMovieDB::TV":"tmdbid","AniDB":"anidbid","TheTVDB":"tvdbid","TVmaze":"tvmazeid"];def lX = Yl[info.database];Abh ? " ($y) [${lX}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def wo = ['\\','/',':','*','?','"','<','>','|'];def KHa = sn.replaceAll(wo.collect { "\\" + it }.join('|'),'_');def Ad = n.replaceAll(wo.collect { "\\" + it }.join('|'),'_');def lOd = KHa.contains(Ad) ? "" : KHa;lOd == 'Season '+ s ? "" : lOd ? " - " + lOd : ""}{"/"}{def Yx = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def nS = Yx.find { eKg ->  fn.contains(eKg) } ?:"";def vnS = any {(fn =~ /^\[(.*?)\]/)[0][1]} {nS} {group} {""};vnS ? "[$vnS] " : ""}{def Ga = "TheMovieDB::TV";def LpP = [[Jul:68854,wE:"From Me to You",ms:Ga],[Jul:229743,wE:"VTuber Legend",ms:Ga],[Jul:234538,wE:"Demon Lord 2099",ms:Ga],[Jul:237045,wE:"Cherry Magic!",ms:Ga],[Jul:240633,wE:"A Journey Through Another World",ms:Ga],[Jul:245285,wE:"Failure Frame",ms:Ga],[Jul:271026,wE:"Taisho Era Contract Marriage",ms:Ga]];def oj = any { info.database } { "IMDb" };def uk = oj == "IMDb" ? "tt${id}" : id;def AQb = n;LpP.each {if (it.Jul == uk && it.ms == oj) {AQb = it.wE}};def wo = ['\\','/',':','*','?','"','<','>','|'];def KHa = AQb.replaceAll(wo.collect { "\\" + it }.join('|'),'');KHa = KHa.replaceAll(/(\s|\.)*$/,'');KHa}{" - "}{s00e00}{def wo = ['\\','/',':','*','?','"','<','>','|'];def KHa = t.replaceAll(wo.collect { "\\" + it }.join('|'),'_');def nUa = any { e } { special };KHa = KHa.length() > 100 ? " " : " - $KHa ";KHa == " - Episode $nUa " ? " " : KHa}{" ["}{def Wio = [[ZfS:"ABEMA",xx:["ABEMA"]],[ZfS:"Bilibili.tv",xx:["B-Global","BiliIntl","BILI"]],[ZfS:"Hulu",xx:["HULU"]],[ZfS:"MeWatch",xx:["MW.WEB-DL"]],[ZfS:"Netflix",xx:["NF.WEB-DL","NF WEB"]],[ZfS:"Prime Video",xx:["AMZN"]],[ZfS:"TVer",xx:["TVER"]],[ZfS:"Shahid",xx:["SHAHID"]],[ZfS:"U-NEXT",xx:["UNEXT"]],[ZfS:"YouTube",xx:["YT.WEB-DL","YOUTUBE","YTB"]]];def _h = ["ASW","Judas","JRx7","EMBER","KawaSubs","GuodongSubs"];def om = ["Erai-raws","SubsPlease"];def pvn = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def u_ = any {def qAG = Wio.find { KV ->  KV.xx.find { GR ->  fn.contains(GR) } }?.xx.first() ?:"";qAG = qAG.replace(".WEB-DL","");qAG ? "${qAG}.WEB-DL" : ""} {source} {_h.find { Cf ->  group == Cf || pvn == Cf } ? "WEBRip" : ""} {def Gs = om.find { ZYZ ->  group == ZYZ || pvn == ZYZ} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : Gs} {vs} {""};u_ ? "$u_ " : ""}{def Nr = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $Nr,$ac"}{" "}{af.format(8:'DD+ 7.1',7:'6.1',6:'DD 5.1',5:'5.0',3:'2.1',2:'2.0',1:'1.0')}{def wU_ = " Dub";def pXp = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : wU_;pXp = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : pXp;pXp}{def WC = any { audioLanguages.size() } { 0 };def pXp = WC > 2 ? " MAud" : WC > 1 ? " DAud" : null;def Do = WC > 5 ? audioLanguages.take(5) : audioLanguages;pXp ? pXp + Do.joining(" "," (","").upper() + (WC > 5 ? " ...)" : ")") : ""}{def hgk = any { textLanguages.size() } { 0 };def pXp = hgk > 2 ? ",MSub" : hgk > 1 ? ",DSub" : null;def Do = hgk > 5 ? textLanguages.take(5) : textLanguages;pXp ? pXp + Do.joining(" "," (","").upper() + (hgk > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def mej = ["ass","srt","ssa","vtt","ttml"];def DeZ = ["name":"." + lang.name,"iso3b":"." + lang.ISO3B,"iso3":"." +lang.ISO3,"iso2":"." + lang.ISO2];def Ui = subt;DeZ.values().each { kJn -> if (Ui.contains(kJn)) {Ui = Ui.replace(kJn,"")}};mej.contains(ext) ? DeZ.iso3b + Ui : ""}{def mej = ["jpg","jpeg","png","bmp"];mej.contains(ext) ? "-thumb" : ""}