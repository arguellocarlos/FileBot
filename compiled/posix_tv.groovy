{def hW = System.getProperty("user.name");def vaR = "/run/media/${hW}";def CI = "$vaR/Videos";def mM = [home,"$vaR/Data","$vaR/Music","$vaR/Videos","$vaR/Games","$vaR/Books"].collect { it as File }.sort { rw, fnr ->  rw.exists() <=> fnr.exists() ?: rw.diskSpace <=> fnr.diskSpace }.last();def Nlg = CI ? CI : mM;"$Nlg/"}{"Videos/"}{def pVS = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def pb = "TheMovieDB::TV";def dk = [[271026, pb],[220118, pb],[ 74180, pb]];def sgL = [[236530, pb]];def qK = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def zm = qK == "IMDb" ? "tt${id}" : id;def fUI = any { info.adult } { false };def dP = dk.find { it[0] == zm && it[1] == qK } != null;def RTd = sgL.find { it[0] == zm && it[1] == qK } != null;def IBK = info.Keywords.findAll { it in pVS } || dP || fUI;IBK = RTd ? false : IBK;IBK ? "R18+ " : ""}{def DM = ["CN", "JP", "KR", "KP", "TW", "HK"];def fa = ["aeni", "donghua", "anime"];def yk = any {anime} || info.Keywords.findAll { it in fa } || (DM.contains(country) && genres =~ /Animation/);yk ? "Anime/" : "TV Series/"}{def pb = "TheMovieDB::TV";def q__ = [[HDw: 68854, Wyg: "From Me to You", xTu: pb],[HDw: 94904, Wyg: "My Next Life as a Villainess", xTu: pb],[HDw: 229743, Wyg: "VTuber Legend", xTu: pb],[HDw: 234538, Wyg: "Demon Lord 2099", xTu: pb],[HDw: 237045, Wyg: "Cherry Magic!", xTu: pb],[HDw: 240633, Wyg: "A Journey Through Another World", xTu: pb],[HDw: 245285, Wyg: "Failure Frame", xTu: pb],[HDw: 271026, Wyg: "Taisho Era Contract Marriage", xTu: pb]];def qK = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def zm = qK == "IMDb" ? "tt${id}" : id;def oP = n;q__.each {if (it.HDw == zm && it.xTu == qK) {oP = it.Wyg}};def TVj = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eP = oP.replaceAll(TVj.collect { "\\" + it }.join('|'), '');eP = eP.replaceAll(/(\s|\.)*$/, '');eP}{def pb = "TheMovieDB::TV";def jeT = [[ 68854, pb],[123542, pb],[204098, pb],[235973, pb],[239779, pb],[240125, pb],[257162, pb],[259140, pb],[262295, pb],[271026, pb],[273190, pb],[275695, pb]];def mfZ = jeT.find { it[0] == id && it[1] == info.database } != null;def DI = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def LnG = DI[info.database];mfZ ? " ($y) [${LnG}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def TVj = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eP = sn.replaceAll(TVj.collect { "\\" + it }.join('|'), '_');def wzR = n.replaceAll(TVj.collect { "\\" + it }.join('|'), '_');def UP = eP.contains(wzR) ? "" : eP;UP == 'Season '+ s ? "" : UP ? " - " + UP : ""}{"/"}{def qN = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def Wtx = qN.find { JE ->  fn.contains(JE) } ?: "";def HJ = any {(fn =~ /^\[(.*?)\]/)[0][1]} {Wtx} {group} {""};HJ ? "[$HJ] " : ""}{def pb = "TheMovieDB::TV";def q__ = [[HDw: 68854, Wyg: "From Me to You", xTu: pb],[HDw: 94904, Wyg: "My Next Life as a Villainess", xTu: pb],[HDw: 229743, Wyg: "VTuber Legend", xTu: pb],[HDw: 234538, Wyg: "Demon Lord 2099", xTu: pb],[HDw: 237045, Wyg: "Cherry Magic!", xTu: pb],[HDw: 240633, Wyg: "A Journey Through Another World", xTu: pb],[HDw: 245285, Wyg: "Failure Frame", xTu: pb],[HDw: 271026, Wyg: "Taisho Era Contract Marriage", xTu: pb]];def qK = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def zm = qK == "IMDb" ? "tt${id}" : id;def oP = n;q__.each {if (it.HDw == zm && it.xTu == qK) {oP = it.Wyg}};def TVj = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eP = oP.replaceAll(TVj.collect { "\\" + it }.join('|'), '');eP = eP.replaceAll(/(\s|\.)*$/, '');eP}{" - "}{s00e00}{def TVj = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eP = t.replaceAll(TVj.collect { "\\" + it }.join('|'), '_');def Wl = any { e } { special };eP = eP.length() > 100 ? " " : " - $eP ";eP == " - Episode $Wl " ? " " : eP}{" ["}{def sky = [[lJ: "ABEMA", MLz: ["ABEMA"]],[lJ: "Bilibili.tv", MLz: ["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"]],[lJ: "Hulu", MLz: ["HULU"]],[lJ: "iQIYI", MLz: ["IQ.WEB-DL", "IQIYI"]],[lJ: "MeWatch", MLz: ["MW.WEB-DL"]],[lJ: "Netflix", MLz: ["NF.WEB-DL", "NF WEB"]],[lJ: "Prime Video", MLz: ["AMZN"]],[lJ: "Shahid", MLz: ["SHAHID"]],[lJ: "TVer", MLz: ["TVER"]],[lJ: "U-NEXT", MLz: ["UNEXT"]],[lJ: "YouTube", MLz: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def xc = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def bF = ["Erai-raws", "SubsPlease"];def dS = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def wdx = any {def FPR = sky.find { cuz ->  cuz.MLz.find { Ng ->  fn.contains(Ng) } }?.MLz.rw() ?: "";FPR = FPR.replace(".WEB-DL", "");FPR ? "${FPR}.WEB-DL" : ""} {source} {xc.find { Jp ->  group == Jp || dS == Jp } ? "WEBRip" : ""} {def Oq = bF.find { CD ->  group == CD || dS == CD} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : Oq} {vs} {""};wdx ? "$wdx " : ""}{def Dc = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $Dc, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def Kb = " Dub";def Ef = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Kb;Ef = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Ef;Ef}{def vN = any { audioLanguages.size() } { 0 };def Ef = vN > 2 ? " MAud" : vN > 1 ? " DAud" : null;def exW = vN > 5 ? audioLanguages.take(5) : audioLanguages;Ef ? Ef + exW.joining(" ", " (", "").upper() + (vN > 5 ? " ...)" : ")") : ""}{def Rf = any { textLanguages.size() } { 0 };def Ef = Rf > 2 ? ", MSub" : Rf > 1 ? ", DSub" : null;def exW = Rf > 5 ? textLanguages.take(5) : textLanguages;Ef ? Ef + exW.joining(" ", " (", "").upper() + (Rf > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def Zs = ["ass", "srt", "ssa", "vtt", "ttml"];def BYd = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def xz = subt;BYd.values().each { MN -> if (xz.contains(MN)) {xz = xz.replace(MN, "")}};Zs.contains(ext) ? BYd.iso3b + xz : ""}{def Zs = ["jpg", "jpeg", "png", "bmp"];Zs.contains(ext) ? "-thumb" : ""}