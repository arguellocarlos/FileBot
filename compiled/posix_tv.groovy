{def iN = System.getProperty("user.name");def eix = "/run/media/${iN}";def iD = "$eix/Videos";def nT = [home,"$eix/Data","$eix/Music","$eix/Videos","$eix/Games","$eix/Books"].collect { it as File }.sort { Rq, Hy ->  Rq.exists() <=> Hy.exists() ?: Rq.diskSpace <=> Hy.diskSpace }.last();def Scd = iD ? iD : nT;"$Scd/"}{def VW = /(CN|JP|KR|KP|TW|HK)/;def GzK = /(aeni|donghua|anime)/;def arH = anime || info.Keywords =~ GzK || (genres =~ /Animation/ && country =~ VW) ? true : false;arH ? "Videos/Anime/" : "Videos/TV Series/"}{def zwz = [[Gz: 229743, aB: "VTuber Legend"],[Gz: 240633, aB: "A Journey Through Another World"],[Gz: 245285, aB: "Failure Frame"],[Gz: 237045, aB: "Cherry Magic!"],[Gz: 68854, aB: "From Me to You"],[Gz: 271026, aB: "Taisho Era Contract Marriage"],[Gz: 234538, aB: "Demon Lord 2099"]];def Pn = n;zwz.each {if (it.Gz == tmdbid && type.toString() != "Movie") {Pn = it.aB}};def mF = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wc = Pn.replaceAll(mF.collect { "\\" + it }.join('|'), '');wc = wc.replaceAll(/(\s|\.)*$/, '');wc}{def Rwy = [68854,235973,262295,259140,204098,239779,273190,271026,240125,275695,123542,257162];def Hx = Rwy.find { msU ->  tmdbid == msU } ?: "";Hx ? " ($y) [tmdbid-$Hx]" : ""}/{episode.special ? 'Specials' : 'Season '+s}{def mF = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wc = sn.replaceAll(mF.collect { "\\" + it }.join('|'), '_');def uC = n.replaceAll(mF.collect { "\\" + it }.join('|'), '_');def lV = wc.contains(uC) ? "" : wc;lV == 'Season '+ s ? "" : lV ? " - " + lV : ""}/{def fFT = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def qJ = fFT.find { CY ->  fn.contains(CY) } ?: "";def So = any {(fn =~ /^\[(.*?)\]/)[0][1]} {qJ} {group} {""};So ? "[$So] " : ""}{def zwz = [[Gz: 229743, aB: "VTuber Legend"],[Gz: 240633, aB: "A Journey Through Another World"],[Gz: 245285, aB: "Failure Frame"],[Gz: 237045, aB: "Cherry Magic!"],[Gz: 68854, aB: "From Me to You"],[Gz: 271026, aB: "Taisho Era Contract Marriage"],[Gz: 234538, aB: "Demon Lord 2099"]];def Pn = n;zwz.each {if (it.Gz == tmdbid && type.toString() != "Movie") {Pn = it.aB}};def mF = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wc = Pn.replaceAll(mF.collect { "\\" + it }.join('|'), '');wc = wc.replaceAll(/(\s|\.)*$/, '');wc} - {s00e00}{def mF = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wc = t.replaceAll(mF.collect { "\\" + it }.join('|'), '_');def mk = any { e } { special };wc = wc.length() > 100 ? " " : " - $wc ";wc == " - Episode $mk " ? " " : wc} [{def SZn = [[xP: "ABEMA", Mc: ["ABEMA"]],[xP: "Bilibili.tv", Mc: ["B-Global", "BiliIntl", "BILI"]],[xP: "Hulu", Mc: ["HULU"]],[xP: "MeWatch", Mc: ["MW.WEB-DL"]],[xP: "Netflix", Mc: ["NF.WEB-DL", "NF WEB"]],[xP: "Prime Video", Mc: ["AMZN"]],[xP: "TVer", Mc: ["TVER"]],[xP: "Shahid", Mc: ["SHAHID"]],[xP: "U-NEXT", Mc: ["UNEXT"]],[xP: "YouTube", Mc: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def VqC = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def Ej = ["Erai-raws", "SubsPlease"];def _L = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def GPR = any {def Gq = SZn.find { Do ->  Do.Mc.find { zl ->  fn.contains(zl) } }?.Mc.first() ?: "";Gq = Gq.replace(".WEB-DL", "");Gq ? "${Gq}.WEB-DL" : ""} {source} {VqC.find { eL ->  group == eL || _L == eL } ? "WEBRip" : ""} {def Rf = Ej.find { eT ->  group == eT || _L == eT} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : Rf} {vs} {""};GPR ? "$GPR " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def pr_ = " Dub";def Mt = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : pr_;Mt = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Mt;Mt}{def oUp = any { audioLanguages.size() } { 0 };def Mt = oUp > 2 ? " MAud" : oUp > 1 ? " DAud" : null;def _dE = oUp > 5 ? audioLanguages.take(5) : audioLanguages;Mt ? Mt + _dE.joining(" ", " (", "").upper() + (oUp > 5 ? " ...)" : ")") : ""}{def BTd = any { textLanguages.size() } { 0 };def Mt = BTd > 2 ? ", MSub" : BTd > 1 ? ", DSub" : null;def _dE = BTd > 5 ? textLanguages.take(5) : textLanguages;Mt ? Mt + _dE.joining(" ", " (", "").upper() + (BTd > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}