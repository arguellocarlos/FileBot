{def jZ = { System.getProperty(it) };def mY = jZ("os.name").toLowerCase().contains("windows");def fy = jZ("user.name");def XUB = "/run/media/${fy}";def sE = mY ? "H:/" : "$XUB/Videos";def dCv = [[bKk: "Books", Hc: "F:/", RB: "$XUB/Books"],[bKk: "Data", Hc: "D:/", RB: "$XUB/Data"],[bKk: "Games", Hc: "G:/", RB: "$XUB/Games"],[bKk: "Music", Hc: "E:/", RB: "$XUB/Music"],[bKk: "Videos", Hc: "H:/", RB: "$XUB/Videos"]];def Kq = (dCv.collect { it[mY ? "Hc" : "RB"] as File }.sort { Vva, Zrz ->  Vva.exists() <=> Zrz.exists() ?: Vva.diskSpace <=> Zrz.diskSpace }).last();def _BI = sE ?: Kq;"$_BI/"}{"Videos/"}{def gvJ = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def Ry = "TheMovieDB::TV";def RnR = [[271026, Ry],[220118, Ry],[ 74180, Ry]];def FG = [[236530, Ry]];def Shz = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def vnF = Shz == "IMDb" ? "tt${id}" : id;def YKb = any { info.adult } { false };def rp = RnR.find { it[0] == vnF && it[1] == Shz } != null;def fX = FG.find { it[0] == vnF && it[1] == Shz } != null;def Pz = info.Keywords.findAll { it in gvJ } || rp || YKb;Pz = fX ? false : Pz;Pz ? "R18+ " : ""}{def JpJ = ["CN", "JP", "KR", "KP", "TW", "HK"];def pu = ["aeni", "donghua", "anime"];def os = any {anime} || info.Keywords.findAll { it in pu } || (JpJ.contains(country) && genres =~ /Animation/);os ? "Anime/" : "TV Series/"}{def Ry = "TheMovieDB::TV";def OMG = [[lHV: 68854, bT: "From Me to You", Gv: Ry],[lHV: 94904, bT: "My Next Life as a Villainess", Gv: Ry],[lHV: 229743, bT: "VTuber Legend", Gv: Ry],[lHV: 234538, bT: "Demon Lord 2099", Gv: Ry],[lHV: 237045, bT: "Cherry Magic!", Gv: Ry],[lHV: 240633, bT: "A Journey Through Another World", Gv: Ry],[lHV: 245285, bT: "Failure Frame", Gv: Ry],[lHV: 271026, bT: "Taisho Era Contract Marriage", Gv: Ry]];def Shz = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def vnF = Shz == "IMDb" ? "tt${id}" : id;def _g = n;OMG.each {if (it.lHV == vnF && it.Gv == Shz) {_g = it.bT}};def MEd = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eq = _g.replaceAll(MEd.collect { "\\" + it }.join('|'), '');eq = eq.replaceAll(/(\s|\.)*$/, '');eq}{def Ry = "TheMovieDB::TV";def lGP = [[ 68854, Ry],[123542, Ry],[204098, Ry],[235973, Ry],[239779, Ry],[240125, Ry],[257162, Ry],[259140, Ry],[262295, Ry],[271026, Ry],[273190, Ry],[275695, Ry]];def Yc = lGP.find { it[0] == id && it[1] == info.database } != null;def Rv = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def Mac = Rv[info.database];Yc ? " ($y) [${Mac}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def MEd = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eq = sn.replaceAll(MEd.collect { "\\" + it }.join('|'), '_');def Ie = n.replaceAll(MEd.collect { "\\" + it }.join('|'), '_');def YFG = eq.contains(Ie) ? "" : eq;YFG == 'Season '+ s ? "" : YFG ? " - " + YFG : ""}{"/"}{def ggK = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def qt = ggK.find { IX ->  fn.contains(IX) } ?: "";def vz = any {(fn =~ /^\[(.*?)\]/)[0][1]} {qt} {group} {""};vz ? "[$vz] " : ""}{def Ry = "TheMovieDB::TV";def OMG = [[lHV: 68854, bT: "From Me to You", Gv: Ry],[lHV: 94904, bT: "My Next Life as a Villainess", Gv: Ry],[lHV: 229743, bT: "VTuber Legend", Gv: Ry],[lHV: 234538, bT: "Demon Lord 2099", Gv: Ry],[lHV: 237045, bT: "Cherry Magic!", Gv: Ry],[lHV: 240633, bT: "A Journey Through Another World", Gv: Ry],[lHV: 245285, bT: "Failure Frame", Gv: Ry],[lHV: 271026, bT: "Taisho Era Contract Marriage", Gv: Ry]];def Shz = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def vnF = Shz == "IMDb" ? "tt${id}" : id;def _g = n;OMG.each {if (it.lHV == vnF && it.Gv == Shz) {_g = it.bT}};def MEd = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eq = _g.replaceAll(MEd.collect { "\\" + it }.join('|'), '');eq = eq.replaceAll(/(\s|\.)*$/, '');eq}{" - "}{s00e00}{def MEd = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eq = t.replaceAll(MEd.collect { "\\" + it }.join('|'), '_');def Fs = any { e } { special };eq = eq.length() > 100 ? " " : " - $eq ";eq == " - Episode $Fs " ? " " : eq}{" ["}{def LYf = [["ABEMA"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["HULU"],["IQIYI", "IQ.WEB-DL"],["LAFTEL", "LFTL"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["AMZN"],["SHAHID"],["TVER"],["UNEXT"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def GB = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def Kmw = ["Erai-raws", "SubsPlease"];def aTz = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def RF = any {def yu = LYf.find { OR ->  OR.find { ljE ->  fn.lower().contains(ljE.lower()) } }[0];yu = yu.replace(".WEB-DL", "");yu ? "${yu}.WEB-DL" : ""} {} {source} {GB.find { bR ->  group == bR || aTz == bR } ? "WEBRip" : ""} {def qgX = Kmw.find { quP ->  group == quP || aTz == quP} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : qgX} {vs} {""};RF ? "$RF " : ""}{def QK = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $QK, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def SUl = " Dub";def Jz = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : SUl;Jz = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Jz;Jz}{def hc = any { audioLanguages.size() } { 0 };def Jz = hc > 2 ? " MAud" : hc > 1 ? " DAud" : null;def ay = hc > 5 ? audioLanguages.take(5) : audioLanguages;Jz ? Jz + ay.joining(" ", " (", "").upper() + (hc > 5 ? " ...)" : ")") : ""}{def WS = any { textLanguages.size() } { 0 };def Jz = WS > 2 ? ", MSub" : WS > 1 ? ", DSub" : null;def ay = WS > 5 ? textLanguages.take(5) : textLanguages;Jz ? Jz + ay.joining(" ", " (", "").upper() + (WS > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def uYy = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def ZKE = subt;uYy.values().each { _kz -> if (ZKE.contains(_kz)) {ZKE = ZKE.replace(_kz, "")}};uYy.iso3b + ZKE}}{f.image ? "-thumb" : ""}