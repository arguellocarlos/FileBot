{def pOK = { System.getProperty(it) };def Fc = pOK("os.name").toLowerCase().contains("windows");def IBg = pOK("user.name");def Dd = "/run/media/${IBg}";def mj = Fc ? "H:/" : "$Dd/Videos";def zS = [[swa: "Books", wHm: "F:/", maV: "$Dd/Books"],[swa: "Data", wHm: "D:/", maV: "$Dd/Data"],[swa: "Games", wHm: "G:/", maV: "$Dd/Games"],[swa: "Music", wHm: "E:/", maV: "$Dd/Music"],[swa: "Videos", wHm: "H:/", maV: "$Dd/Videos"]];def Mu = (zS.collect { it[Fc ? "wHm" : "maV"] as File }.sort { luz, xxC ->  luz.exists() <=> xxC.exists() ?: luz.diskSpace <=> xxC.diskSpace }).last();def xXL = mj ?: Mu;"$xXL/"}{"Videos/"}{def DGL = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def mDd = "TheMovieDB::TV";def GV = [[271026, mDd],[220118, mDd],[ 74180, mDd]];def AC = [[236530, mDd]];def rdE = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Jkd = rdE == "IMDb" ? "tt${id}" : id;def Sq = any { info.adult } { false };def VJ = GV.find { it[0] == Jkd && it[1] == rdE } != null;def jv_ = AC.find { it[0] == Jkd && it[1] == rdE } != null;def eii = info.Keywords.findAll { it in DGL } || VJ || Sq;eii = jv_ ? false : eii;eii ? "R18+ " : ""}{def Hu = ["CN", "JP", "KR", "KP", "TW", "HK"];def Pxw = ["aeni", "donghua", "anime"];def tfR = any {anime} || info.Keywords.findAll { it in Pxw } || (Hu.contains(country) && genres =~ /Animation/);tfR ? "Anime/" : "TV Series/"}{def mDd = "TheMovieDB::TV";def RXP = [[VeN: 68854, BR: "From Me to You", zL: mDd],[VeN: 94904, BR: "My Next Life as a Villainess", zL: mDd],[VeN: 229743, BR: "VTuber Legend", zL: mDd],[VeN: 234538, BR: "Demon Lord 2099", zL: mDd],[VeN: 237045, BR: "Cherry Magic!", zL: mDd],[VeN: 240633, BR: "A Journey Through Another World", zL: mDd],[VeN: 245285, BR: "Failure Frame", zL: mDd],[VeN: 271026, BR: "Taisho Era Contract Marriage", zL: mDd]];def rdE = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Jkd = rdE == "IMDb" ? "tt${id}" : id;def aJs = n;RXP.each {if (it.VeN == Jkd && it.zL == rdE) {aJs = it.BR}};def Hx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wA = aJs.replaceAll(Hx.collect { "\\" + it }.join('|'), '');wA = wA.replaceAll(/(\s|\.)*$/, '');wA}{def mDd = "TheMovieDB::TV";def bnz = [[ 68854, mDd],[123542, mDd],[204098, mDd],[235973, mDd],[239779, mDd],[240125, mDd],[257162, mDd],[259140, mDd],[262295, mDd],[271026, mDd],[273190, mDd],[275695, mDd]];def JzI = bnz.find { it[0] == id && it[1] == info.database } != null;def JUH = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def PT = JUH[info.database];JzI ? " ($y) [${PT}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def Hx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wA = sn.replaceAll(Hx.collect { "\\" + it }.join('|'), '_');def Loc = n.replaceAll(Hx.collect { "\\" + it }.join('|'), '_');def vBJ = wA.contains(Loc) ? "" : wA;vBJ == 'Season '+ s ? "" : vBJ ? " - " + vBJ : ""}{"/"}{def qBo = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def xjg = qBo.find { jCJ ->  fn.contains(jCJ) } ?: "";def eQ = any {(fn =~ /^\[(.*?)\]/)[0][1]} {xjg} {group} {""};eQ ? "[$eQ] " : ""}{def mDd = "TheMovieDB::TV";def RXP = [[VeN: 68854, BR: "From Me to You", zL: mDd],[VeN: 94904, BR: "My Next Life as a Villainess", zL: mDd],[VeN: 229743, BR: "VTuber Legend", zL: mDd],[VeN: 234538, BR: "Demon Lord 2099", zL: mDd],[VeN: 237045, BR: "Cherry Magic!", zL: mDd],[VeN: 240633, BR: "A Journey Through Another World", zL: mDd],[VeN: 245285, BR: "Failure Frame", zL: mDd],[VeN: 271026, BR: "Taisho Era Contract Marriage", zL: mDd]];def rdE = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Jkd = rdE == "IMDb" ? "tt${id}" : id;def aJs = n;RXP.each {if (it.VeN == Jkd && it.zL == rdE) {aJs = it.BR}};def Hx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wA = aJs.replaceAll(Hx.collect { "\\" + it }.join('|'), '');wA = wA.replaceAll(/(\s|\.)*$/, '');wA}{" - "}{s00e00}{def Hx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def wA = t.replaceAll(Hx.collect { "\\" + it }.join('|'), '_');def Psc = any { e } { special };wA = wA.length() > 100 ? " " : " - $wA ";wA == " - Episode $Psc " ? " " : wA}{" ["}{def lj = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["LAFTEL", "LFTL"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def MwT = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def YjW = ["Erai-raws", "SubsPlease"];def mL = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def IRd = any {def VYZ = lj.find { Acv ->  Acv.find { RMT ->  fn.lower().contains(RMT.lower()) } }[0];VYZ = VYZ.replace(".WEB-DL", "");VYZ ? "${VYZ}.WEB-DL" : ""} {} {source} {MwT.find { iyD ->  group == iyD || mL == iyD } ? "WEBRip" : ""} {def AcU = YjW.find { wF ->  group == wF || mL == wF} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : AcU} {vs} {""};IRd ? "$IRd " : ""}{def uch = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $uch, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def PZz = " Dub";def Ya = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : PZz;Ya = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Ya;Ya}{def KB = any { audioLanguages.size() } { 0 };def Ya = KB > 2 ? " MAud" : KB > 1 ? " DAud" : null;def tnP = KB > 5 ? audioLanguages.take(5) : audioLanguages;Ya ? Ya + tnP.joining(" ", " (", "").upper() + (KB > 5 ? " ...)" : ")") : ""}{def RHj = any { textLanguages.size() } { 0 };def Ya = RHj > 2 ? ", MSub" : RHj > 1 ? ", DSub" : null;def tnP = RHj > 5 ? textLanguages.take(5) : textLanguages;Ya ? Ya + tnP.joining(" ", " (", "").upper() + (RHj > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def hTR = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def VWG = subt;hTR.values().each { TVs -> if (VWG.contains(TVs)) {VWG = VWG.replace(TVs, "")}};hTR.iso3b + VWG}}{f.image ? "-thumb" : ""}