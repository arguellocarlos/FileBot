{def BL = { System.getProperty(it) };def oxY = BL("os.name").toLowerCase().contains("windows");def uJx = BL("user.name");def kG = "/run/media/${uJx}";def vCZ = oxY ? "H:/" : "$kG/Videos";def Gt = [[Ou: "Books", TlD: "F:/", vO: "$kG/Books"],[Ou: "Data", TlD: "D:/", vO: "$kG/Data"],[Ou: "Games", TlD: "G:/", vO: "$kG/Games"],[Ou: "Music", TlD: "E:/", vO: "$kG/Music"],[Ou: "Videos", TlD: "H:/", vO: "$kG/Videos"]];def yd = (Gt.collect { it[oxY ? "TlD" : "vO"] as File }.sort { apY, qDC ->  apY.exists() <=> qDC.exists() ?: apY.diskSpace <=> qDC.diskSpace }).last();def Mc = vCZ ?: yd;"$Mc/"}{"Videos/"}{def Xs = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def kB = "TheMovieDB::TV";def xa = [[ 74180, kB],[ 93821, kB],[ 95897, kB],[220118, kB],[271026, kB]];def YK = [[236530, kB]];def FmE = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def QOv = FmE == "IMDb" ? "tt${id}" : id;def Qqz = any { info.adult } { false };def ZVM = xa.find { it[0] == QOv && it[1] == FmE } != null;def gyc = YK.find { it[0] == QOv && it[1] == FmE } != null;def hp = info.Keywords.findAll { it in Xs } || ZVM || Qqz;hp = gyc ? false : hp;hp ? "R18+ " : ""}{def mGn = ["CN", "JP", "KR", "KP", "TW", "HK"];def Np = ["aeni", "donghua", "anime"];def Cnj = any {anime} || info.Keywords.findAll { it in Np } || (mGn.contains(country) && genres =~ /Animation/);Cnj ? "Anime Movies/" : "Movies/"}{def kB = "TheMovieDB::TV";def dnh = [[lE: 68854, Ym: "From Me to You", iru: kB],[lE: 219816, Ym: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", iru: kB],[lE: 259559, Ym: "Headhunted to Another World", iru: kB],[lE: 276204, Ym: "Bogus Skill Fruitmaster", iru: kB]];def FmE = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def QOv = FmE == "IMDb" ? "tt${id}" : id;def WS = n;dnh.each {if (it.lE == QOv && it.iru == FmE) {WS = it.Ym}};def Ug = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def FR_ = WS.replaceAll(Ug.collect { "\\" + it }.join('|'), '');FR_ = FR_.replaceAll(/(\s|\.)*$/, '');FR_}{" ("}{y}{")"}{"/"}{def zr = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws"];def bo = zr.find { fnz ->  fn.contains(fnz) } ?: "";def wM = any {(fn =~ /^\[(.*?)\]/)[0][1]} {bo} {group} {""};wM ? "[$wM] " : ""}{def kB = "TheMovieDB::TV";def dnh = [[lE: 68854, Ym: "From Me to You", iru: kB],[lE: 219816, Ym: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", iru: kB],[lE: 259559, Ym: "Headhunted to Another World", iru: kB],[lE: 276204, Ym: "Bogus Skill Fruitmaster", iru: kB]];def FmE = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def QOv = FmE == "IMDb" ? "tt${id}" : id;def WS = n;dnh.each {if (it.lE == QOv && it.iru == FmE) {WS = it.Ym}};def Ug = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def FR_ = WS.replaceAll(Ug.collect { "\\" + it }.join('|'), '');FR_ = FR_.replaceAll(/(\s|\.)*$/, '');FR_}{" ("}{y}{")"}{" ["}{def FDH = [["ABEMA"],["ADN"],["BBC"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def tm = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def _fI = ["Erai-raws", "SubsPlease"];def rdH = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def RRw = any {def oZL = FDH.find { ooY ->  ooY.find { Pp ->  fn.lower().contains(Pp.lower()) } }[0];oZL = oZL.replace(".WEB-DL", "");def mxU = source.contains("WEB-DL");def DtJ = source ? ".${source}" : "";mxU ? "${oZL}.WEB-DL" : oZL ? "${oZL}${DtJ}" : ""} {} {source} {tm.find { rIT ->  group == rIT || rdH == rIT } ? "WEBRip" : ""} {def iIS = _fI.find { saQ ->  group == saQ || rdH == saQ} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : iIS} {vs} {""};RRw ? "$RRw " : ""}{def ClY = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $ClY, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def dd = " Dub";def Wq = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : dd;Wq = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Wq;Wq}{def hfU = any { audioLanguages.size() } { 0 };def Wq = hfU > 2 ? " MAud" : hfU > 1 ? " DAud" : null;def xp = hfU > 5 ? audioLanguages.take(5) : audioLanguages;Wq ? Wq + xp.joining(" ", " (", "").upper() + (hfU > 5 ? " ...)" : ")") : ""}{def fkX = any { textLanguages.size() } { 0 };def Wq = fkX > 2 ? ", MSub" : fkX > 1 ? ", DSub" : null;def xp = fkX > 5 ? textLanguages.take(5) : textLanguages;Wq ? Wq + xp.joining(" ", " (", "").upper() + (fkX > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def nkY = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Fp = subt;nkY.values().each { xP -> if (Fp.contains(xP)) {Fp = Fp.replace(xP, "")}};nkY.iso3b + Fp}}{f.image ? "-thumb" : ""}