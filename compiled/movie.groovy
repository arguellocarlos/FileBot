{def Tc = { System.getProperty(it) };def HgL = Tc("os.name").toLowerCase().contains("windows");def vd = Tc("user.name");def _r = "/run/media/${vd}";def da = HgL ? "H:/" : "$_r/Videos";def mAo = [[AR: "Books", tP: "F:/", CRG: "$_r/Books"],[AR: "Data", tP: "D:/", CRG: "$_r/Data"],[AR: "Games", tP: "G:/", CRG: "$_r/Games"],[AR: "Music", tP: "E:/", CRG: "$_r/Music"],[AR: "Videos", tP: "H:/", CRG: "$_r/Videos"]];def yv = (mAo.collect { it[HgL ? "tP" : "CRG"] as File }.sort { OYi, WNN ->  OYi.exists() <=> WNN.exists() ?: OYi.diskSpace <=> WNN.diskSpace }).last();def oaz = da ?: yv;"$oaz/"}{"Videos/"}{def OP = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def oD = "TheMovieDB::TV";def BJ = [[271026, oD],[220118, oD],[ 74180, oD]];def mwq = [[236530, oD]];def THJ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def HA = THJ == "IMDb" ? "tt${id}" : id;def qK = any { info.adult } { false };def RFb = BJ.find { it[0] == HA && it[1] == THJ } != null;def aH = mwq.find { it[0] == HA && it[1] == THJ } != null;def zLw = info.Keywords.findAll { it in OP } || RFb || qK;zLw = aH ? false : zLw;zLw ? "R18+ " : ""}{def kFR = ["CN", "JP", "KR", "KP", "TW", "HK"];def l_k = ["aeni", "donghua", "anime"];def ewf = any {anime} || info.Keywords.findAll { it in l_k } || (kFR.contains(country) && genres =~ /Animation/);ewf ? "Anime Movies/" : "Movies/"}{def oD = "TheMovieDB::TV";def CbZ = [[fe: 68854, uT: "From Me to You", Xt: oD],[fe: 94904, uT: "My Next Life as a Villainess", Xt: oD],[fe: 229743, uT: "VTuber Legend", Xt: oD],[fe: 234538, uT: "Demon Lord 2099", Xt: oD],[fe: 237045, uT: "Cherry Magic!", Xt: oD],[fe: 240633, uT: "A Journey Through Another World", Xt: oD],[fe: 245285, uT: "Failure Frame", Xt: oD],[fe: 271026, uT: "Taisho Era Contract Marriage", Xt: oD]];def THJ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def HA = THJ == "IMDb" ? "tt${id}" : id;def tJ = n;CbZ.each {if (it.fe == HA && it.Xt == THJ) {tJ = it.uT}};def m_ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def psn = tJ.replaceAll(m_.collect { "\\" + it }.join('|'), '');psn = psn.replaceAll(/(\s|\.)*$/, '');psn}{" ("}{y}{")"}{def THJ = id == tmdbid ? "TheMovieDB" : "IMDb";def ys = ["TheMovieDB": "tmdbid","IMDb": "imdbid"];def mH = ys[THJ];def HA = THJ == "IMDb" ? "tt${id}" : id;" [${mH}-${HA}]/"}{def kVZ = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def HcL = kVZ.find { Nsy ->  fn.contains(Nsy) } ?: "";def va = any {(fn =~ /^\[(.*?)\]/)[0][1]} {HcL} {group} {""};va ? "[$va] " : ""}{def oD = "TheMovieDB::TV";def CbZ = [[fe: 68854, uT: "From Me to You", Xt: oD],[fe: 94904, uT: "My Next Life as a Villainess", Xt: oD],[fe: 229743, uT: "VTuber Legend", Xt: oD],[fe: 234538, uT: "Demon Lord 2099", Xt: oD],[fe: 237045, uT: "Cherry Magic!", Xt: oD],[fe: 240633, uT: "A Journey Through Another World", Xt: oD],[fe: 245285, uT: "Failure Frame", Xt: oD],[fe: 271026, uT: "Taisho Era Contract Marriage", Xt: oD]];def THJ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def HA = THJ == "IMDb" ? "tt${id}" : id;def tJ = n;CbZ.each {if (it.fe == HA && it.Xt == THJ) {tJ = it.uT}};def m_ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def psn = tJ.replaceAll(m_.collect { "\\" + it }.join('|'), '');psn = psn.replaceAll(/(\s|\.)*$/, '');psn}{" ("}{y}{")"}{" ["}{def ien = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["LAFTEL", "LFTL"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def nh = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def ec = ["Erai-raws", "SubsPlease"];def sar = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def ka = any {def ADG = ien.find { Fqf ->  Fqf.find { uY ->  fn.lower().contains(uY.lower()) } }[0];ADG = ADG.replace(".WEB-DL", "");ADG ? "${ADG}.WEB-DL" : ""} {} {source} {nh.find { UbM ->  group == UbM || sar == UbM } ? "WEBRip" : ""} {def cp = ec.find { hue ->  group == hue || sar == hue} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : cp} {vs} {""};ka ? "$ka " : ""}{def JSa = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $JSa, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def mI = " Dub";def vZC = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : mI;vZC = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : vZC;vZC}{def kuh = any { audioLanguages.size() } { 0 };def vZC = kuh > 2 ? " MAud" : kuh > 1 ? " DAud" : null;def bG = kuh > 5 ? audioLanguages.take(5) : audioLanguages;vZC ? vZC + bG.joining(" ", " (", "").upper() + (kuh > 5 ? " ...)" : ")") : ""}{def lp = any { textLanguages.size() } { 0 };def vZC = lp > 2 ? ", MSub" : lp > 1 ? ", DSub" : null;def bG = lp > 5 ? textLanguages.take(5) : textLanguages;vZC ? vZC + bG.joining(" ", " (", "").upper() + (lp > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def hg = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def hPg = subt;hg.values().each { ZQ -> if (hPg.contains(ZQ)) {hPg = hPg.replace(ZQ, "")}};hg.iso3b + hPg}}{f.image ? "-thumb" : ""}