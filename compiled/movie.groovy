{def SI = { System.getProperty(it) };def YXZ = SI("os.name").toLowerCase().contains("windows");def ro = SI("user.name");def jcq = "/run/media/${ro}";def ij = YXZ ? "H:/" : "$jcq/Videos";def BXv = [[Ce: "Books", Pi: "F:/", tnE: "$jcq/Books"],[Ce: "Data", Pi: "D:/", tnE: "$jcq/Data"],[Ce: "Games", Pi: "G:/", tnE: "$jcq/Games"],[Ce: "Music", Pi: "E:/", tnE: "$jcq/Music"],[Ce: "Videos", Pi: "H:/", tnE: "$jcq/Videos"]];def XD = (BXv.collect { it[YXZ ? "Pi" : "tnE"] as File }.sort { qz, Yl ->  qz.exists() <=> Yl.exists() ?: qz.diskSpace <=> Yl.diskSpace }).last();def wU = ij ?: XD;"$wU/"}{"Videos/"}{def Gpr = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def oUa = "TheMovieDB::TV";def nW = [[ 74180, oUa],[ 93821, oUa],[ 95897, oUa],[220118, oUa],[271026, oUa]];def eS = [[236530, oUa]];def z_Q = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Wo = z_Q == "IMDb" ? "tt${id}" : id;def O_D = any { info.adult } { false };def wO = nW.find { it[0] == Wo && it[1] == z_Q } != null;def EAq = eS.find { it[0] == Wo && it[1] == z_Q } != null;def QL = info.Keywords.findAll { it in Gpr } || wO || O_D;QL = EAq ? false : QL;QL ? "R18+ " : ""}{def zjZ = ["CN", "JP", "KR", "KP", "TW", "HK"];def Kku = ["aeni", "donghua", "anime"];def ET = any {anime} || info.Keywords.findAll { it in Kku } || (zjZ.contains(country) && genres =~ /Animation/);ET ? "Anime Movies/" : "Movies/"}{def oUa = "TheMovieDB::TV";def iXO = [[pHT: 68854, yw: "From Me to You", Ey: oUa],[pHT: 219816, yw: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", Ey: oUa],[pHT: 276204, yw: "Bogus Skill Fruitmaster", Ey: oUa]];def z_Q = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Wo = z_Q == "IMDb" ? "tt${id}" : id;def se = n;iXO.each {if (it.pHT == Wo && it.Ey == z_Q) {se = it.yw}};def Iu = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tp = se.replaceAll(Iu.collect { "\\" + it }.join('|'), '');tp = tp.replaceAll(/(\s|\.)*$/, '');tp}{" ("}{y}{")"}{def Dew = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws"];def LN = Dew.find { VzC ->  fn.contains(VzC) } ?: "";def hnD = any {(fn =~ /^\[(.*?)\]/)[0][1]} {LN} {group} {""};hnD ? "[$hnD] " : ""}{def oUa = "TheMovieDB::TV";def iXO = [[pHT: 68854, yw: "From Me to You", Ey: oUa],[pHT: 219816, yw: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", Ey: oUa],[pHT: 276204, yw: "Bogus Skill Fruitmaster", Ey: oUa]];def z_Q = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Wo = z_Q == "IMDb" ? "tt${id}" : id;def se = n;iXO.each {if (it.pHT == Wo && it.Ey == z_Q) {se = it.yw}};def Iu = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tp = se.replaceAll(Iu.collect { "\\" + it }.join('|'), '');tp = tp.replaceAll(/(\s|\.)*$/, '');tp}{" ("}{y}{")"}{" ["}{def kWD = [["ABEMA"],["ADN"],["BBC"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def Lt = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def pd = ["Erai-raws", "SubsPlease"];def BG = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def yYz = any {def npe = kWD.find { xgQ ->  xgQ.find { ZVl ->  fn.lower().contains(ZVl.lower()) } }[0];npe = npe.replace(".WEB-DL", "");def hG = source.contains("WEB-DL");def oE = source ? ".${source}" : "";hG ? "${npe}.WEB-DL" : npe ? "${npe}${oE}" : ""} {} {source} {Lt.find { iJ ->  group == iJ || BG == iJ } ? "WEBRip" : ""} {def BFt = pd.find { gYI ->  group == gYI || BG == gYI} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : BFt} {vs} {""};yYz ? "$yYz " : ""}{def Xkz = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $Xkz, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def ZC = " Dub";def OXI = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : ZC;OXI = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : OXI;OXI}{def ooH = any { audioLanguages.size() } { 0 };def OXI = ooH > 2 ? " MAud" : ooH > 1 ? " DAud" : null;def irw = ooH > 5 ? audioLanguages.take(5) : audioLanguages;OXI ? OXI + irw.joining(" ", " (", "").upper() + (ooH > 5 ? " ...)" : ")") : ""}{def LFp = any { textLanguages.size() } { 0 };def OXI = LFp > 2 ? ", MSub" : LFp > 1 ? ", DSub" : null;def irw = LFp > 5 ? textLanguages.take(5) : textLanguages;OXI ? OXI + irw.joining(" ", " (", "").upper() + (LFp > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def yKF = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def pg = subt;yKF.values().each { zX -> if (pg.contains(zX)) {pg = pg.replace(zX, "")}};yKF.iso3b + pg}}{f.image ? "-thumb" : ""}