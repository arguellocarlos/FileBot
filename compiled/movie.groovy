{def wEK = { System.getProperty(it) };def pW = wEK("os.name").toLowerCase().contains("windows");def Nyz = wEK("user.name");def EA = "/run/media/${Nyz}";def yp = pW ? "H:/" : "$EA/Videos";def fYd = [[nP_: "Books", SW: "F:/", bM: "$EA/Books"],[nP_: "Data", SW: "D:/", bM: "$EA/Data"],[nP_: "Games", SW: "G:/", bM: "$EA/Games"],[nP_: "Music", SW: "E:/", bM: "$EA/Music"],[nP_: "Videos", SW: "H:/", bM: "$EA/Videos"]];def gNx = (fYd.collect { it[pW ? "SW" : "bM"] as File }.sort { fB, GJT ->  fB.exists() <=> GJT.exists() ?: fB.diskSpace <=> GJT.diskSpace }).last();def jTL = yp ?: gNx;"$jTL/"}{"Videos/"}{def BR = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def PDC = "TheMovieDB::TV";def wc = [[271026, PDC],[220118, PDC],[ 74180, PDC]];def tK = [[236530, PDC]];def Tx = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Tme = Tx == "IMDb" ? "tt${id}" : id;def JkM = any { info.adult } { false };def GF = wc.find { it[0] == Tme && it[1] == Tx } != null;def DrE = tK.find { it[0] == Tme && it[1] == Tx } != null;def fuQ = info.Keywords.findAll { it in BR } || GF || JkM;fuQ = DrE ? false : fuQ;fuQ ? "R18+ " : ""}{def e_X = ["CN", "JP", "KR", "KP", "TW", "HK"];def nA = ["aeni", "donghua", "anime"];def hS = any {anime} || info.Keywords.findAll { it in nA } || (e_X.contains(country) && genres =~ /Animation/);hS ? "Anime Movies/" : "Movies/"}{def PDC = "TheMovieDB::TV";def rcS = [[hNz: 68854, ww: "From Me to You", Iq: PDC],[hNz: 234538, ww: "Demon Lord 2099", Iq: PDC]];def Tx = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Tme = Tx == "IMDb" ? "tt${id}" : id;def uxY = n;rcS.each {if (it.hNz == Tme && it.Iq == Tx) {uxY = it.ww}};def dJ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def jm = uxY.replaceAll(dJ.collect { "\\" + it }.join('|'), '');jm = jm.replaceAll(/(\s|\.)*$/, '');jm}{" ("}{y}{")"}{def Tx = id == tmdbid ? "TheMovieDB" : "IMDb";def kX_ = ["TheMovieDB": "tmdbid","IMDb": "imdbid"];def nmd = kX_[Tx];def Tme = Tx == "IMDb" ? "tt${id}" : id;" [${nmd}-${Tme}]/"}{def UpL = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws"];def J_ = UpL.find { rhw ->  fn.contains(rhw) } ?: "";def YFs = any {(fn =~ /^\[(.*?)\]/)[0][1]} {J_} {group} {""};YFs ? "[$YFs] " : ""}{def PDC = "TheMovieDB::TV";def rcS = [[hNz: 68854, ww: "From Me to You", Iq: PDC],[hNz: 234538, ww: "Demon Lord 2099", Iq: PDC]];def Tx = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Tme = Tx == "IMDb" ? "tt${id}" : id;def uxY = n;rcS.each {if (it.hNz == Tme && it.Iq == Tx) {uxY = it.ww}};def dJ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def jm = uxY.replaceAll(dJ.collect { "\\" + it }.join('|'), '');jm = jm.replaceAll(/(\s|\.)*$/, '');jm}{" ("}{y}{")"}{" ["}{def Of = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def iZY = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def qWd = ["Erai-raws", "SubsPlease"];def Ie = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def xX = any {def Io = Of.find { Ct ->  Ct.find { Po ->  fn.lower().contains(Po.lower()) } }[0];Io = Io.replace(".WEB-DL", "");def LC = source.contains("WEB-DL");def wx = source ? ".${source}" : "";LC ? "${Io}.WEB-DL" : Io ? "${Io}${wx}" : ""} {} {source} {iZY.find { nF_ ->  group == nF_ || Ie == nF_ } ? "WEBRip" : ""} {def RY = qWd.find { IB ->  group == IB || Ie == IB} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : RY} {vs} {""};xX ? "$xX " : ""}{def hmg = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $hmg, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def pS = " Dub";def FU = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : pS;FU = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : FU;FU}{def ZyY = any { audioLanguages.size() } { 0 };def FU = ZyY > 2 ? " MAud" : ZyY > 1 ? " DAud" : null;def MPm = ZyY > 5 ? audioLanguages.take(5) : audioLanguages;FU ? FU + MPm.joining(" ", " (", "").upper() + (ZyY > 5 ? " ...)" : ")") : ""}{def Ir = any { textLanguages.size() } { 0 };def FU = Ir > 2 ? ", MSub" : Ir > 1 ? ", DSub" : null;def MPm = Ir > 5 ? textLanguages.take(5) : textLanguages;FU ? FU + MPm.joining(" ", " (", "").upper() + (Ir > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def sn = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def qC = subt;sn.values().each { ahZ -> if (qC.contains(ahZ)) {qC = qC.replace(ahZ, "")}};sn.iso3b + qC}}{f.image ? "-thumb" : ""}