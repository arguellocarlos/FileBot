{def cs = { System.getProperty(it) };def zq = cs("os.name").toLowerCase().contains("windows");def WqO = cs("user.name");def gkn = "/run/media/${WqO}";def fh = zq ? "H:/" : "$gkn/Videos";def bop = [[SX: "Books", Xx: "F:/", ri: "$gkn/Books"],[SX: "Data", Xx: "D:/", ri: "$gkn/Data"],[SX: "Games", Xx: "G:/", ri: "$gkn/Games"],[SX: "Music", Xx: "E:/", ri: "$gkn/Music"],[SX: "Videos", Xx: "H:/", ri: "$gkn/Videos"]];def mbr = (bop.collect { it[zq ? "Xx" : "ri"] as File }.sort { WL, zjo ->  WL.exists() <=> zjo.exists() ?: WL.diskSpace <=> zjo.diskSpace }).last();def TH = fh ?: mbr;"$TH/"}{"Videos/"}{def ik = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def ffN = "TheMovieDB::TV";def lt = [[ 74180, ffN],[ 93821, ffN],[ 95897, ffN],[220118, ffN],[271026, ffN]];def Ep = [[236530, ffN]];def NC = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Mm = NC == "IMDb" ? "tt${id}" : id;def Kwk = any { info.adult } { false };def GuG = lt.find { it[0] == Mm && it[1] == NC } != null;def jz = Ep.find { it[0] == Mm && it[1] == NC } != null;def OgJ = info.Keywords.findAll { it in ik } || GuG || Kwk;OgJ = jz ? false : OgJ;OgJ ? "R18+ " : ""}{def Ua = ["CN", "JP", "KR", "KP", "TW", "HK"];def vB = ["aeni", "donghua", "anime"];def hQm = any {anime} || info.Keywords.findAll { it in vB } || (Ua.contains(country) && genres =~ /Animation/);hQm ? "Anime Movies/" : "Movies/"}{def ffN = "TheMovieDB::TV";def RKz = [[CM: 68854, xp: "From Me to You", xEb: ffN],[CM: 219816, xp: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", xEb: ffN],[CM: 245561, xp: "Okitsura", xEb: ffN],[CM: 248707, xp: "Neko Oji The Guy That Got Reincarnated As a Cat", xEb: ffN],[CM: 259559, xp: "Headhunted to Another World", xEb: ffN],[CM: 261301, xp: "Botsuraku Kizoku", xEb: ffN],[CM: 262141, xp: "Can You Keep a Secret", xEb: ffN],[CM: 270657, xp: "Tono to Inu", xEb: ffN],[CM: 276204, xp: "Bogus Skill Fruitmaster", xEb: ffN]];def NC = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Mm = NC == "IMDb" ? "tt${id}" : id;def ypT = n;RKz.each {if (it.CM == Mm && it.xEb == NC) {ypT = it.xp}};def qtj = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def xxq = ypT.replaceAll(qtj.collect { "\\" + it }.join('|'), '');xxq = xxq.replaceAll(/(\s|\.)*$/, '');xxq}{" ("}{y}{")"}{"/"}{def nn = ["Alqanime","BlackLuster","darkflux","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def bSF = nn.find { vHs ->  fn.lower().contains(vHs.lower()) } ?: "";def gz = any {(fn =~ /^\[(.*?)\]/)[0][1]} {bSF} {group} {""};gz ? "[$gz] " : ""}{def ffN = "TheMovieDB::TV";def RKz = [[CM: 68854, xp: "From Me to You", xEb: ffN],[CM: 219816, xp: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", xEb: ffN],[CM: 245561, xp: "Okitsura", xEb: ffN],[CM: 248707, xp: "Neko Oji The Guy That Got Reincarnated As a Cat", xEb: ffN],[CM: 259559, xp: "Headhunted to Another World", xEb: ffN],[CM: 261301, xp: "Botsuraku Kizoku", xEb: ffN],[CM: 262141, xp: "Can You Keep a Secret", xEb: ffN],[CM: 270657, xp: "Tono to Inu", xEb: ffN],[CM: 276204, xp: "Bogus Skill Fruitmaster", xEb: ffN]];def NC = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Mm = NC == "IMDb" ? "tt${id}" : id;def ypT = n;RKz.each {if (it.CM == Mm && it.xEb == NC) {ypT = it.xp}};def qtj = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def xxq = ypT.replaceAll(qtj.collect { "\\" + it }.join('|'), '');xxq = xxq.replaceAll(/(\s|\.)*$/, '');xxq}{" ("}{y}{") ["}{def AGu = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"]];def YOX = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def BI = ["Erai-raws", "SubsPlease"];def BM = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def xbR = any {def SXt = AGu.find { Fh ->  Fh.find { _L ->  fn.lower().contains(_L.lower()) } }[0];SXt = SXt.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {SXt = SXt.replace(".WEBRip", "");SXt = SXt + ".WEBRip"} else {SXt = SXt + ".WEB-DL"};SXt} {source} {YOX.find { Qc ->  group == Qc || BM == Qc } ? "WEBRip" : ""} {def xXN = BI.find { EIN ->  group == EIN || BM == EIN} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : xXN} {vs} {""};xbR ? "$xbR " : ""}{def mp = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $mp, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def _m = " Dub";def KNe = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : _m;KNe = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : KNe;KNe}{def eG = any { audioLanguages.size() } { 0 };def KNe = eG > 2 ? " MAud" : eG > 1 ? " DAud" : null;def _J = eG > 5 ? audioLanguages.take(5) : audioLanguages;KNe ? KNe + _J.joining(" ", " (", "").upper() + (eG > 5 ? " ...)" : ")") : ""}{def sSR = any { textLanguages.size() } { 0 };def KNe = sSR > 2 ? ", MSub" : sSR > 1 ? ", DSub" : null;def _J = sSR > 5 ? textLanguages.take(5) : textLanguages;KNe ? KNe + _J.joining(" ", " (", "").upper() + (sSR > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def ZZw = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Xz = subt;ZZw.values().each { qt -> if (Xz.contains(qt)) {Xz = Xz.replace(qt, "")}};ZZw.iso3b + Xz}}{f.image ? "-thumb" : ""}