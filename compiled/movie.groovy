{def ge = { System.getProperty(it) };def oe = ge("os.name").toLowerCase().contains("windows");def hbd = ge("user.name");def UJF = "/run/media/${hbd}";def cqz = oe ? "H:/" : "$UJF/Videos";def cm = [[bZ: "Books", DOj: "F:/", MZq: "$UJF/Books"],[bZ: "Data", DOj: "D:/", MZq: "$UJF/Data"],[bZ: "Games", DOj: "G:/", MZq: "$UJF/Games"],[bZ: "Music", DOj: "E:/", MZq: "$UJF/Music"],[bZ: "Videos", DOj: "H:/", MZq: "$UJF/Videos"]];def wr = (cm.collect { it[oe ? "DOj" : "MZq"] as File }.sort { KS, WTM ->  KS.exists() <=> WTM.exists() ?: KS.diskSpace <=> WTM.diskSpace }).last();def DN = cqz ?: wr;"$DN/"}{"Videos/"}{def wiM = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def Ysd = "TheMovieDB::TV";def yJ = [[ 74180, Ysd],[ 93821, Ysd],[ 95897, Ysd],[220118, Ysd],[249891, Ysd],[271026, Ysd]];def Xf = [[236530, Ysd]];def Ji = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def dwl = Ji == "IMDb" ? "tt${id}" : id;def oW = any { info.adult } { false };def va = yJ.find { it[0] == dwl && it[1] == Ji } != null;def jpY = Xf.find { it[0] == dwl && it[1] == Ji } != null;def jaY = info.Keywords.findAll { it in wiM } || va || oW;jaY = jpY ? false : jaY;jaY ? "R18+ " : ""}{def Ep = ["CN", "JP", "KR", "KP", "TW", "HK"];def Kl = ["aeni", "donghua", "anime"];def Qm = any {anime} || info.Keywords.findAll { it in Kl } || (Ep.contains(country) && genres =~ /Animation/);Qm ? "Anime Movies/" : "Movies/"}{def Ysd = "TheMovieDB::TV";def dn = [[BuI: 199928, YKs: "Nights With a Cat", vu: Ysd],[BuI: 232230, YKs: "Lord of the Mysteries", vu: Ysd],[BuI: 248707, YKs: "Neko Oji The Guy That Got Reincarnated As a Cat", vu: Ysd],[BuI: 270660, YKs: "Pochars", vu: Ysd],[BuI: 277581, YKs: "Dekin no Mogura", vu: Ysd],[BuI: 280038, YKs: "Apocalypse Bringer Mynoghra", vu: Ysd],[BuI: 280078, YKs: "The All-devouring Whale Homecoming", vu: Ysd],[BuI: 283704, YKs: "Fermat Kitchen", vu: Ysd],[BuI: 283884, YKs: "Chuhai Lips", vu: Ysd],[BuI: 288419, YKs: "Chikuwa Senki", vu: Ysd]];def Ji = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def dwl = Ji == "IMDb" ? "tt${id}" : id;def wQ = n;dn.each {if (it.BuI == dwl && it.vu == Ji) {wQ = it.YKs}};def BS = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eh = wQ.replaceAll(BS.collect { "\\" + it }.join('|'), '');eh = eh.replaceAll(/(\s|\.)*$/, '');eh}{" ("}{y}{")"}{"/"}{def sGW = ["Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def BD = sGW.find { Jho ->  fn.lower().contains(Jho.lower()) } ?: "";def Zu = any {BD} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};Zu ? "[$Zu] " : ""}{def Ysd = "TheMovieDB::TV";def dn = [[BuI: 199928, YKs: "Nights With a Cat", vu: Ysd],[BuI: 232230, YKs: "Lord of the Mysteries", vu: Ysd],[BuI: 248707, YKs: "Neko Oji The Guy That Got Reincarnated As a Cat", vu: Ysd],[BuI: 270660, YKs: "Pochars", vu: Ysd],[BuI: 277581, YKs: "Dekin no Mogura", vu: Ysd],[BuI: 280038, YKs: "Apocalypse Bringer Mynoghra", vu: Ysd],[BuI: 280078, YKs: "The All-devouring Whale Homecoming", vu: Ysd],[BuI: 283704, YKs: "Fermat Kitchen", vu: Ysd],[BuI: 283884, YKs: "Chuhai Lips", vu: Ysd],[BuI: 288419, YKs: "Chikuwa Senki", vu: Ysd]];def Ji = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def dwl = Ji == "IMDb" ? "tt${id}" : id;def wQ = n;dn.each {if (it.BuI == dwl && it.vu == Ji) {wQ = it.YKs}};def BS = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def eh = wQ.replaceAll(BS.collect { "\\" + it }.join('|'), '');eh = eh.replaceAll(/(\s|\.)*$/, '');eh}{" ("}{y}{") ["}{def Kt = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["CMIC", "COOLMIC"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"]];def Jj = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def fwl = ["DB"];def mRX = ["Ruri-Saizen"];def rz = ["Erai-raws", "SubsPlease"];def Fu = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def rZz = any {def fGL = Kt.find { fk ->  fk.find { CIb ->  fn.lower().contains(CIb.lower()) } }[0];fGL = fGL.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {fGL = fGL.replace(".WEBRip", "");fGL = fGL + ".WEBRip"} else {fGL = fGL + ".WEB-DL"};fGL} {source} {Jj.find { dI ->  group == dI || Fu == dI } ? "WEBRip" : ""} {fwl.find { dI ->  group == dI || Fu == dI } ? "BDRip" : ""} {mRX.find { dI ->  group == g__ || Fu == g__} ? "HDTVRip" : ""} {def fU = rz.find { lLt ->  group == lLt || Fu == lLt} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : fU} {vs} {""};rZz ? "$rZz " : ""}{def Lk = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $Lk, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def aw = any { audioLanguages.size() } { 0 };def dqv = aw > 2 ? " MULTi-AUD" : aw > 1 ? " DUAL-AUD" : "";def Lt = aw > 5 ? audioLanguages.take(5) : audioLanguages;def mP = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";dqv = aw == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$dqv$mP";dqv ? dqv + Lt.ISO2.joining(" ", " (", "").upper() + (aw > 5 ? " ...)" : ")") : ""}{def UQ = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def VqI = any { UQ.size() } { 0 };def dqv = VqI > 2 ? ", MULTi" : VqI > 1 ? ", DUAL" : VqI == 1 ? ", SUB" : null;def Lt = VqI > 5 ? UQ.take(5) : UQ;dqv ? dqv + Lt.joining(" ", " (", "").upper() + (VqI > 6 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def kc = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def xXp = subt;kc.values().each { VC -> if (xXp.contains(VC)) {xXp = xXp.replace(VC, "")}};kc.iso3b + xXp}}{f.image ? "-thumb" : ""}