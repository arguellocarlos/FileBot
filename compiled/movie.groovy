{def Yh = { System.getProperty(it) };def oV = Yh("os.name").toLowerCase().contains("windows");def Bd = Yh("user.name");def Drl = "/run/media/${Bd}";def jkl = oV ? "H:/" : "$Drl/Videos";def WP = [[lzp: "Books", VQD: "F:/", cx: "$Drl/Books"],[lzp: "Data", VQD: "D:/", cx: "$Drl/Data"],[lzp: "Games", VQD: "G:/", cx: "$Drl/Games"],[lzp: "Music", VQD: "E:/", cx: "$Drl/Music"],[lzp: "Videos", VQD: "H:/", cx: "$Drl/Videos"]];def sfI = (WP.collect { it[oV ? "VQD" : "cx"] as File }.sort { pn, vMy ->  pn.exists() <=> vMy.exists() ?: pn.diskSpace <=> vMy.diskSpace }).last();def jD = jkl ?: sfI;"$jD/"}{"Videos/"}{def Bm = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def Pku = "TheMovieDB::TV";def Kv = [[ 74180, Pku],[ 93821, Pku],[ 95897, Pku],[220118, Pku],[271026, Pku]];def MQ = [[236530, Pku]];def AX = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def olo = AX == "IMDb" ? "tt${id}" : id;def IJW = any { info.adult } { false };def pp = Kv.find { it[0] == olo && it[1] == AX } != null;def XH = MQ.find { it[0] == olo && it[1] == AX } != null;def pC = info.Keywords.findAll { it in Bm } || pp || IJW;pC = XH ? false : pC;pC ? "R18+ " : ""}{def xeR = ["CN", "JP", "KR", "KP", "TW", "HK"];def mwM = ["aeni", "donghua", "anime"];def xzY = any {anime} || info.Keywords.findAll { it in mwM } || (xeR.contains(country) && genres =~ /Animation/);xzY ? "Anime Movies/" : "Movies/"}{def Pku = "TheMovieDB::TV";def ZmQ = [[sd: 68854, bO: "From Me to You", qwo: Pku],[sd: 219816, bO: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", qwo: Pku],[sd: 245561, bO: "Okitsura", qwo: Pku],[sd: 248707, bO: "Neko Oji The Guy That Got Reincarnated As a Cat", qwo: Pku],[sd: 259559, bO: "Headhunted to Another World", qwo: Pku],[sd: 261301, bO: "Botsuraku Kizoku", qwo: Pku],[sd: 262141, bO: "Can You Keep a Secret", qwo: Pku],[sd: 270657, bO: "Tono to Inu", qwo: Pku],[sd: 276204, bO: "Bogus Skill Fruitmaster", qwo: Pku]];def AX = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def olo = AX == "IMDb" ? "tt${id}" : id;def dGq = n;ZmQ.each {if (it.sd == olo && it.qwo == AX) {dGq = it.bO}};def SP = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def pcU = dGq.replaceAll(SP.collect { "\\" + it }.join('|'), '');pcU = pcU.replaceAll(/(\s|\.)*$/, '');pcU}{" ("}{y}{")"}{"/"}{def PF = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def uR = PF.find { gm ->  fn.lower().contains(gm.lower()) } ?: "";def kFI = any {(fn =~ /^\[(.*?)\]/)[0][1]} {uR} {group} {""};kFI ? "[$kFI] " : ""}{def Pku = "TheMovieDB::TV";def ZmQ = [[sd: 68854, bO: "From Me to You", qwo: Pku],[sd: 219816, bO: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", qwo: Pku],[sd: 245561, bO: "Okitsura", qwo: Pku],[sd: 248707, bO: "Neko Oji The Guy That Got Reincarnated As a Cat", qwo: Pku],[sd: 259559, bO: "Headhunted to Another World", qwo: Pku],[sd: 261301, bO: "Botsuraku Kizoku", qwo: Pku],[sd: 262141, bO: "Can You Keep a Secret", qwo: Pku],[sd: 270657, bO: "Tono to Inu", qwo: Pku],[sd: 276204, bO: "Bogus Skill Fruitmaster", qwo: Pku]];def AX = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def olo = AX == "IMDb" ? "tt${id}" : id;def dGq = n;ZmQ.each {if (it.sd == olo && it.qwo == AX) {dGq = it.bO}};def SP = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def pcU = dGq.replaceAll(SP.collect { "\\" + it }.join('|'), '');pcU = pcU.replaceAll(/(\s|\.)*$/, '');pcU}{" ("}{y}{")"}{" ["}{def GqU = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YTB", "YT.WEB-DL", "YOUTUBE"]];def WC = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def zf = ["Erai-raws", "SubsPlease"];def dD = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def S_ = any {def qz = GqU.find { mQ ->  mQ.find { Ah ->  fn.lower().contains(Ah.lower()) } }[0];qz = qz.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {qz = qz.replace(".WEBRip", "");qz = qz + ".WEBRip"} else {qz = qz + ".WEB-DL"};qz} {source} {WC.find { fG ->  group == fG || dD == fG } ? "WEBRip" : ""} {def EZ = zf.find { SbY ->  group == SbY || dD == SbY} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : EZ} {vs} {""};S_ ? "$S_ " : ""}{def LvP = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $LvP, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def Ab = " Dub";def Eqv = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Ab;Eqv = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Eqv;Eqv}{def apN = any { audioLanguages.size() } { 0 };def Eqv = apN > 2 ? " MAud" : apN > 1 ? " DAud" : null;def bA = apN > 5 ? audioLanguages.take(5) : audioLanguages;Eqv ? Eqv + bA.joining(" ", " (", "").upper() + (apN > 5 ? " ...)" : ")") : ""}{def Mwk = any { textLanguages.size() } { 0 };def Eqv = Mwk > 2 ? ", MSub" : Mwk > 1 ? ", DSub" : null;def bA = Mwk > 5 ? textLanguages.take(5) : textLanguages;Eqv ? Eqv + bA.joining(" ", " (", "").upper() + (Mwk > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def wm_ = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def BF = subt;wm_.values().each { LZ -> if (BF.contains(LZ)) {BF = BF.replace(LZ, "")}};wm_.iso3b + BF}}{f.image ? "-thumb" : ""}