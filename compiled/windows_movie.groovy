{def gl = "H:/";def ncU = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { IEc, VS ->  IEc.exists() <=> VS.exists() ?: IEc.diskSpace <=> VS.diskSpace }.last();def Kw = gl ? gl : ncU;"$Kw/"}{"Videos/"}{def BTK = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def kq = "TheMovieDB::TV";def cX = [[271026, kq],[220118, kq],[ 74180, kq]];def Xk = [[236530, kq]];def iz = any { info.database } { "IMDb" };def oC = iz == "IMDb" ? "tt${id}" : id;def am = any { info.adult } { false };def iQx = cX.find { it[0] == oC && it[1] == iz } != null;def RsB = Xk.find { it[0] == oC && it[1] == iz } != null;def aU = info.Keywords.findAll { it in BTK } || iQx || am;aU = RsB ? false : aU;aU ? "R18+ " : ""}{def HxD = ["CN", "JP", "KR", "KP", "TW", "HK"];def MME = ["aeni", "donghua", "anime"];def IA = any {anime} || info.Keywords.findAll { it in MME } || (HxD.contains(country) && genres =~ /Animation/);IA ? "Anime Movies/" : "Movies/"}{def kq = "TheMovieDB::TV";def yu = [[WQU: 68854, vUO: "From Me to You", Zj: kq],[WQU: 229743, vUO: "VTuber Legend", Zj: kq],[WQU: 234538, vUO: "Demon Lord 2099", Zj: kq],[WQU: 237045, vUO: "Cherry Magic!", Zj: kq],[WQU: 240633, vUO: "A Journey Through Another World", Zj: kq],[WQU: 245285, vUO: "Failure Frame", Zj: kq],[WQU: 271026, vUO: "Taisho Era Contract Marriage", Zj: kq]];def iz = any { info.database } { "IMDb" };def oC = iz == "IMDb" ? "tt${id}" : id;def uo = n;yu.each {if (it.WQU == oC && it.Zj == iz) {uo = it.vUO}};def TJ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tqk = uo.replaceAll(TJ.collect { "\\" + it }.join('|'), '');tqk = tqk.replaceAll(/(\s|\.)*$/, '');tqk}{" ("}{y}{")"}{def iz = any { info.database } { "IMDb" };def xQR = ["TheMovieDB": "tmdbid","TheTVDB::Movie": "tvdbid","IMDb": "imdbid"];def hK = xQR[iz];def oC = iz == "IMDb" ? "tt${id}" : id;" [${hK}-${oC}]/"}{def dds = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def nK = dds.find { qeJ ->  fn.contains(qeJ) } ?: "";def fT = any {(fn =~ /^\[(.*?)\]/)[0][1]} {nK} {group} {""};fT ? "[$fT] " : ""}{def kq = "TheMovieDB::TV";def yu = [[WQU: 68854, vUO: "From Me to You", Zj: kq],[WQU: 229743, vUO: "VTuber Legend", Zj: kq],[WQU: 234538, vUO: "Demon Lord 2099", Zj: kq],[WQU: 237045, vUO: "Cherry Magic!", Zj: kq],[WQU: 240633, vUO: "A Journey Through Another World", Zj: kq],[WQU: 245285, vUO: "Failure Frame", Zj: kq],[WQU: 271026, vUO: "Taisho Era Contract Marriage", Zj: kq]];def iz = any { info.database } { "IMDb" };def oC = iz == "IMDb" ? "tt${id}" : id;def uo = n;yu.each {if (it.WQU == oC && it.Zj == iz) {uo = it.vUO}};def TJ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tqk = uo.replaceAll(TJ.collect { "\\" + it }.join('|'), '');tqk = tqk.replaceAll(/(\s|\.)*$/, '');tqk}{" ("}{y}{")"}{" ["}{def zjG = [[gu: "ABEMA", GF: ["ABEMA"]],[gu: "Bilibili.tv", GF: ["B-Global", "BiliIntl", "BILI"]],[gu: "Hulu", GF: ["HULU"]],[gu: "MeWatch", GF: ["MW.WEB-DL"]],[gu: "Netflix", GF: ["NF.WEB-DL", "NF WEB"]],[gu: "Prime Video", GF: ["AMZN"]],[gu: "TVer", GF: ["TVER"]],[gu: "Shahid", GF: ["SHAHID"]],[gu: "U-NEXT", GF: ["UNEXT"]],[gu: "YouTube", GF: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def Im = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def sBG = ["Erai-raws", "SubsPlease"];def BY = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def Nq = any {def WwU = zjG.find { xGh ->  xGh.GF.find { s_D ->  fn.contains(s_D) } }?.GF.first() ?: "";WwU = WwU.replace(".WEB-DL", "");WwU ? "${WwU}.WEB-DL" : ""} {source} {Im.find { ZV ->  group == ZV || BY == ZV } ? "WEBRip" : ""} {def dIx = sBG.find { PpY ->  group == PpY || BY == PpY} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : dIx} {vs} {""};Nq ? "$Nq " : ""}{def HF = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $HF, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def Ihk = " Dub";def pN = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Ihk;pN = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : pN;pN}{def K_ = any { audioLanguages.size() } { 0 };def pN = K_ > 2 ? " MAud" : K_ > 1 ? " DAud" : null;def pK = K_ > 5 ? audioLanguages.take(5) : audioLanguages;pN ? pN + pK.joining(" ", " (", "").upper() + (K_ > 5 ? " ...)" : ")") : ""}{def huN = any { textLanguages.size() } { 0 };def pN = huN > 2 ? ", MSub" : huN > 1 ? ", DSub" : null;def pK = huN > 5 ? textLanguages.take(5) : textLanguages;pN ? pN + pK.joining(" ", " (", "").upper() + (huN > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def wo = ["ass", "srt", "ssa", "vtt", "ttml"];def QsL = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def uxM = subt;QsL.values().each { Vi -> if (uxM.contains(Vi)) {uxM = uxM.replace(Vi, "")}};wo.contains(ext) ? QsL.iso3b + uxM : ""}{def wo = ["jpg", "jpeg", "png", "bmp"];wo.contains(ext) ? "-thumb" : ""}