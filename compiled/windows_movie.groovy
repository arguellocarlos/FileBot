{def ZO = "H:/";def iNp = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { QI, UQq ->  QI.exists() <=> UQq.exists() ?: QI.diskSpace <=> UQq.diskSpace }.last();def Gpu = ZO ? ZO : iNp;"$Gpu/"}{def hl = /(CN|JP|KR|KP|TW|HK)/;def Ir = /(aeni|donghua|anime)/;def FLa = anime || info.Keywords =~ Ir || any {(genres =~ /Animation/ && country =~ hl)}{false} ? true : false;def wDl = FLa ? "Videos/Anime " : "Videos/";"$wDl" + "Movies/"}{def sft = [[eHB: 229743, za: "VTuber Legend"],[eHB: 240633, za: "A Journey Through Another World"],[eHB: 245285, za: "Failure Frame"],[eHB: 237045, za: "Cherry Magic!"],[eHB: 68854, za: "From Me to You"],[eHB: 271026, za: "Taisho Era Contract Marriage"],[eHB: 234538, za: "Demon Lord 2099"]];def aU = n;sft.each {if (it.eHB == tmdbid && type.toString() != "Movie") {aU = it.za}};def Tn = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Sn = aU.replaceAll(Tn.collect { "\\" + it }.join('|'), '');Sn = Sn.replaceAll(/(\s|\.)*$/, '');Sn}{" ("}{y}{") [tmdbid-"}{tmdbid}{"]/"}{def qA = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def _Y = qA.find { La ->  fn.contains(La) } ?: "";def uz = any {(fn =~ /^\[(.*?)\]/)[0][1]} {_Y} {group} {""};uz ? "[$uz] " : ""}{def sft = [[eHB: 229743, za: "VTuber Legend"],[eHB: 240633, za: "A Journey Through Another World"],[eHB: 245285, za: "Failure Frame"],[eHB: 237045, za: "Cherry Magic!"],[eHB: 68854, za: "From Me to You"],[eHB: 271026, za: "Taisho Era Contract Marriage"],[eHB: 234538, za: "Demon Lord 2099"]];def aU = n;sft.each {if (it.eHB == tmdbid && type.toString() != "Movie") {aU = it.za}};def Tn = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Sn = aU.replaceAll(Tn.collect { "\\" + it }.join('|'), '');Sn = Sn.replaceAll(/(\s|\.)*$/, '');Sn}{" ("}{y}{")"} [{def TQ = [[Tz: "ABEMA", kG: ["ABEMA"]],[Tz: "Bilibili.tv", kG: ["B-Global", "BiliIntl", "BILI"]],[Tz: "Hulu", kG: ["HULU"]],[Tz: "MeWatch", kG: ["MW.WEB-DL"]],[Tz: "Netflix", kG: ["NF.WEB-DL", "NF WEB"]],[Tz: "Prime Video", kG: ["AMZN"]],[Tz: "TVer", kG: ["TVER"]],[Tz: "Shahid", kG: ["SHAHID"]],[Tz: "U-NEXT", kG: ["UNEXT"]],[Tz: "YouTube", kG: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def FOY = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def fz = ["Erai-raws", "SubsPlease"];def QrI = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def xP = any {def J_W = TQ.find { lb ->  lb.kG.find { nuY ->  fn.contains(nuY) } }?.kG.first() ?: "";J_W = J_W.replace(".WEB-DL", "");J_W ? "${J_W}.WEB-DL" : ""} {source} {FOY.find { sC ->  group == sC || QrI == sC } ? "WEBRip" : ""} {def XZ = fz.find { Giy ->  group == Giy || QrI == Giy} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : XZ} {vs} {""};xP ? "$xP " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def wPe = " Dub";def Z_V = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : wPe;Z_V = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Z_V;Z_V}{def gV = any { audioLanguages.size() } { 0 };def Z_V = gV > 2 ? " MAud" : gV > 1 ? " DAud" : null;def tO = gV > 5 ? audioLanguages.take(5) : audioLanguages;Z_V ? Z_V + tO.joining(" ", " (", "").upper() + (gV > 5 ? " ...)" : ")") : ""}{def jKz = any { textLanguages.size() } { 0 };def Z_V = jKz > 2 ? ", MSub" : jKz > 1 ? ", DSub" : null;def tO = jKz > 5 ? textLanguages.take(5) : textLanguages;Z_V ? Z_V + tO.joining(" ", " (", "").upper() + (jKz > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}