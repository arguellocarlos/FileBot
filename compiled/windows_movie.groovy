{def PnN = "H:/";def auL = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { RBg, Yf ->  RBg.exists() <=> Yf.exists() ?: RBg.diskSpace <=> Yf.diskSpace }.last();def CoG = PnN ? PnN : auL;"$CoG/"}{def EU = /(CN|JP|KR|KP|TW|HK)/;def Wk = /(aeni|donghua|anime)/;def JWx = anime || info.Keywords =~ Wk || any {(genres =~ /Animation/ && country =~ EU)}{false} ? true : false;def zA = JWx ? "Videos/Anime " : "Videos/";"$zA" + "Movies/"}{def wtj = [[tkx: 229743, JZp: "VTuber Legend"],[tkx: 240633, JZp: "A Journey Through Another World"],[tkx: 245285, JZp: "Failure Frame"],[tkx: 237045, JZp: "Cherry Magic!"],[tkx: 68854, JZp: "From Me to You"],[tkx: 271026, JZp: "Taisho Era Contract Marriage"],[tkx: 234538, JZp: "Demon Lord 2099"]];def ifn = n;wtj.each {if (it.tkx == tmdbid && type.toString() != "Movie") {ifn = it.JZp}};def VF = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def EP = ifn.replaceAll(VF.collect { "\\" + it }.join('|'), '');EP = EP.replaceAll(/(\s|\.)*$/, '');EP}{" ("}{y}{") [tmdbid-"}{tmdbid}{"]/"}{def sXD = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def aC = sXD.find { pI ->  fn.contains(pI) } ?: "";def Ko = any {(fn =~ /^\[(.*?)\]/)[0][1]} {aC} {group} {""};Ko ? "[$Ko] " : ""}{def wtj = [[tkx: 229743, JZp: "VTuber Legend"],[tkx: 240633, JZp: "A Journey Through Another World"],[tkx: 245285, JZp: "Failure Frame"],[tkx: 237045, JZp: "Cherry Magic!"],[tkx: 68854, JZp: "From Me to You"],[tkx: 271026, JZp: "Taisho Era Contract Marriage"],[tkx: 234538, JZp: "Demon Lord 2099"]];def ifn = n;wtj.each {if (it.tkx == tmdbid && type.toString() != "Movie") {ifn = it.JZp}};def VF = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def EP = ifn.replaceAll(VF.collect { "\\" + it }.join('|'), '');EP = EP.replaceAll(/(\s|\.)*$/, '');EP}{" ("}{y}{")"} [{def RJn = [[XM: "Bilibili.tv", HiO: ["B-Global", "BiliIntl", "BILI"]],[XM: "Prime Video", HiO: ["AMZN"]],[XM: "U-NEXT", HiO: ["UNEXT"]],[XM: "ABEMA", HiO: ["ABEMA"]],[XM: "Hulu", HiO: ["HULU"]],[XM: "Shahid", HiO: ["SHAHID"]],[XM: "YouTube", HiO: ["YT.WEB-DL", "YOUTUBE", "YTB"]],[XM: "Netflix", HiO: ["NF.WEB-DL", "NF WEB"]]];def LU = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def jw = ["Erai-raws", "SubsPlease"];def sz = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def GWL = any {def MqS = RJn.find { Ouh ->  Ouh.HiO.find { Fw ->  fn.contains(Fw) } }?.HiO.first() ?: "";MqS = MqS.replace(".WEB-DL", "");MqS ? "${MqS}.WEB-DL" : ""} {source} {LU.find { eyL ->  group == eyL || sz == eyL } ? "WEBRip" : ""} {def flw = jw.find { HRA ->  group == HRA || sz == HRA} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : flw} {vs} {""};GWL ? "$GWL " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def owz = " Dub";def Hrs = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : owz;Hrs = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Hrs;Hrs}{def ho = any { audioLanguages.size() } { 0 };def Hrs = ho > 2 ? " MAud" : ho > 1 ? " DAud" : null;def ntM = ho > 5 ? audioLanguages.take(5) : audioLanguages;Hrs ? Hrs + ntM.joining(" ", " (", "").upper() + (ho > 5 ? " ...)" : ")") : ""}{def qv = any { textLanguages.size() } { 0 };def Hrs = qv > 2 ? ", MSub" : qv > 1 ? ", DSub" : null;def ntM = qv > 5 ? textLanguages.take(5) : textLanguages;Hrs ? Hrs + ntM.joining(" ", " (", "").upper() + (qv > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}