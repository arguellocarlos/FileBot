{def KFO = "H:/";def nTp = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { Wxt, inh ->  Wxt.exists() <=> inh.exists() ?: Wxt.diskSpace <=> inh.diskSpace }.last();def _dH = KFO ? KFO : nTp;"$_dH/"}{def fWA = /(CN|JP|KR|KP|TW|HK)/;def oC = /(aeni|donghua|anime)/;def In = anime || info.Keywords =~ oC || any {(genres =~ /Animation/ && country =~ fWA)}{false} ? true : false;def DYb = In ? "Videos/Anime " : "Videos/";"$DYb" + "Movies/"}{def YQ = [[Nqx: 229743, Py: "VTuber Legend"],[Nqx: 240633, Py: "A Journey Through Another World"],[Nqx: 245285, Py: "Failure Frame"],[Nqx: 237045, Py: "Cherry Magic!"],[Nqx: 68854, Py: "From Me to You"],[Nqx: 271026, Py: "Taisho Era Contract Marriage"],[Nqx: 234538, Py: "Demon Lord 2099"]];def km = n;YQ.each {if (it.Nqx == tmdbid && type.toString() != "Movie") {km = it.Py}};def Jtl = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Wy = km.replaceAll(Jtl.collect { "\\" + it }.join('|'), '');Wy = Wy.replaceAll(/(\s|\.)*$/, '');Wy}{" ("}{y}{") [tmdbid-"}{tmdbid}{"]/"}{def Ks = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def ZXT = Ks.find { zZj ->  fn.contains(zZj) } ?: "";def HPf = any {(fn =~ /^\[(.*?)\]/)[0][1]} {ZXT} {group} {""};HPf ? "[$HPf] " : ""}{def YQ = [[Nqx: 229743, Py: "VTuber Legend"],[Nqx: 240633, Py: "A Journey Through Another World"],[Nqx: 245285, Py: "Failure Frame"],[Nqx: 237045, Py: "Cherry Magic!"],[Nqx: 68854, Py: "From Me to You"],[Nqx: 271026, Py: "Taisho Era Contract Marriage"],[Nqx: 234538, Py: "Demon Lord 2099"]];def km = n;YQ.each {if (it.Nqx == tmdbid && type.toString() != "Movie") {km = it.Py}};def Jtl = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Wy = km.replaceAll(Jtl.collect { "\\" + it }.join('|'), '');Wy = Wy.replaceAll(/(\s|\.)*$/, '');Wy}{" ("}{y}{")"} [{def dX = [[iw: "Bilibili.tv", ZfB: ["B-Global", "BiliIntl", "BILI"]],[iw: "Prime Video", ZfB: ["AMZN"]],[iw: "U-NEXT", ZfB: ["UNEXT"]],[iw: "ABEMA", ZfB: ["ABEMA"]],[iw: "Hulu", ZfB: ["HULU"]],[iw: "Shahid", ZfB: ["SHAHID"]],[iw: "YouTube", ZfB: ["YT.WEB-DL", "YOUTUBE", "YTB"]],[iw: "Netflix", ZfB: ["NF.WEB-DL", "NF WEB"]]];def HH = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def kx = ["Erai-raws", "SubsPlease"];def Pq = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def BfX = any {def ujd = dX.find { TQ ->  TQ.ZfB.find { mmC ->  fn.contains(mmC) } }?.ZfB.first() ?: "";ujd = ujd.replace(".WEB-DL", "");ujd ? "${ujd}.WEB-DL" : ""} {source} {HH.find { Ln ->  group == Ln || Pq == Ln } ? "WEBRip" : ""} {def ki = kx.find { SW ->  group == SW || Pq == SW} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : ki} {vs} {""};BfX ? "$BfX " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def SBN = " Dub";def Fi = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : SBN;Fi = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Fi;Fi}{def MFN = any { audioLanguages.size() } { 0 };def Fi = MFN > 2 ? " MAud" : MFN > 1 ? " DAud" : null;def CK = MFN > 5 ? audioLanguages.take(5) : audioLanguages;Fi ? Fi + CK.joining(" ", " (", "").upper() + (MFN > 5 ? " ...)" : ")") : ""}{def PeU = any { textLanguages.size() } { 0 };def Fi = PeU > 2 ? ", MSub" : PeU > 1 ? ", DSub" : null;def CK = PeU > 5 ? textLanguages.take(5) : textLanguages;Fi ? Fi + CK.joining(" ", " (", "").upper() + (PeU > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}