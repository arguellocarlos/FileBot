{def Cjt = { System.getProperty(it) };def tqU = Cjt("os.name").toLowerCase().contains("windows");def Pcp = Cjt("user.name");def GOT = "/run/media/${Pcp}";def NOK = tqU ? "H:/" : "$GOT/Videos";def oTH = [[nHW: "Books", fU: "F:/", CB: "$GOT/Books"],[nHW: "Data", fU: "D:/", CB: "$GOT/Data"],[nHW: "Games", fU: "G:/", CB: "$GOT/Games"],[nHW: "Music", fU: "E:/", CB: "$GOT/Music"],[nHW: "Videos", fU: "H:/", CB: "$GOT/Videos"]];def td = (oTH.collect { it[tqU ? "fU" : "CB"] as File }.sort { SO, VX ->  SO.exists() <=> VX.exists() ?: SO.diskSpace <=> VX.diskSpace }).last();def lOT = NOK ?: td;"$lOT/"}{"Videos/"}{def nvV = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def fQ = "TheMovieDB::TV";def cT = [[ 74180, fQ],[ 93821, fQ],[ 95897, fQ],[220118, fQ],[271026, fQ]];def Hd = [[236530, fQ]];def QIu = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Md = QIu == "IMDb" ? "tt${id}" : id;def lwq = any { info.adult } { false };def Rap = cT.find { it[0] == Md && it[1] == QIu } != null;def lPS = Hd.find { it[0] == Md && it[1] == QIu } != null;def mKx = info.Keywords.findAll { it in nvV } || Rap || lwq;mKx = lPS ? false : mKx;mKx ? "R18+ " : ""}{def cmc = ["CN", "JP", "KR", "KP", "TW", "HK"];def NN = ["aeni", "donghua", "anime"];def Ycf = any {anime} || info.Keywords.findAll { it in NN } || (cmc.contains(country) && genres =~ /Animation/);Ycf ? "Anime/" : "TV Series/"}{def fQ = "TheMovieDB::TV";def uG = [[zwX: 68854, Wh: "From Me to You", tgB: fQ],[zwX: 219816, Wh: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", tgB: fQ],[zwX: 245561, Wh: "Okitsura", tgB: fQ],[zwX: 248707, Wh: "Neko Oji The Guy That Got Reincarnated As a Cat", tgB: fQ],[zwX: 259559, Wh: "Headhunted to Another World", tgB: fQ],[zwX: 261301, Wh: "Botsuraku Kizoku", tgB: fQ],[zwX: 262141, Wh: "Can You Keep a Secret", tgB: fQ],[zwX: 270657, Wh: "Tono to Inu", tgB: fQ],[zwX: 276204, Wh: "Bogus Skill Fruitmaster", tgB: fQ]];def QIu = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Md = QIu == "IMDb" ? "tt${id}" : id;def MN = n;uG.each {if (it.zwX == Md && it.tgB == QIu) {MN = it.Wh}};def mAC = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def jC = MN.replaceAll(mAC.collect { "\\" + it }.join('|'), '');jC = jC.replaceAll(/(\s|\.)*$/, '');jC}{def fQ = "TheMovieDB::TV";def _F = [[ 95897, fQ],[123542, fQ],[235973, fQ],[239779, fQ],[257162, fQ],[259140, fQ],[276204, fQ]];def nRn = _F.find { it[0] == id && it[1] == info.database } != null;def pHU = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def gwP = pHU[info.database];nRn ? " ($y) [${gwP}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def mAC = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def jC = sn.replaceAll(mAC.collect { "\\" + it }.join('|'), '_');def pAo = n.replaceAll(mAC.collect { "\\" + it }.join('|'), '_');def UR = jC.contains(pAo) ? "" : jC;UR == 'Season '+ s ? "" : UR ? " - " + UR : ""}{"/"}{def YOT = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def ca = YOT.find { xg ->  fn.lower().contains(xg.lower()) } ?: "";def c_ = any {(fn =~ /^\[(.*?)\]/)[0][1]} {ca} {group} {""};c_ ? "[$c_] " : ""}{def fQ = "TheMovieDB::TV";def uG = [[zwX: 68854, Wh: "From Me to You", tgB: fQ],[zwX: 219816, Wh: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", tgB: fQ],[zwX: 245561, Wh: "Okitsura", tgB: fQ],[zwX: 248707, Wh: "Neko Oji The Guy That Got Reincarnated As a Cat", tgB: fQ],[zwX: 259559, Wh: "Headhunted to Another World", tgB: fQ],[zwX: 261301, Wh: "Botsuraku Kizoku", tgB: fQ],[zwX: 262141, Wh: "Can You Keep a Secret", tgB: fQ],[zwX: 270657, Wh: "Tono to Inu", tgB: fQ],[zwX: 276204, Wh: "Bogus Skill Fruitmaster", tgB: fQ]];def QIu = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def Md = QIu == "IMDb" ? "tt${id}" : id;def MN = n;uG.each {if (it.zwX == Md && it.tgB == QIu) {MN = it.Wh}};def mAC = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def jC = MN.replaceAll(mAC.collect { "\\" + it }.join('|'), '');jC = jC.replaceAll(/(\s|\.)*$/, '');jC}{" - "}{s00e00}{def mAC = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def jC = t.replaceAll(mAC.collect { "\\" + it }.join('|'), '_');jC = jC.length() > 100 ? " " : " - $jC ";def TO = any { e } { special };def bk = "Episode $TO";def hDb = jC.contains(bk) ? '' : jC;hDb != '' ? hDb : ''}{" ["}{def LYY = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YTB", "YT.WEB-DL", "YOUTUBE"]];def rW = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def mJ = ["Erai-raws", "SubsPlease"];def qp = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def QJQ = any {def pju = LYY.find { Xd ->  Xd.find { PSe ->  fn.lower().contains(PSe.lower()) } }[0];pju = pju.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {pju = pju.replace(".WEBRip", "");pju = pju + ".WEBRip"} else {pju = pju + ".WEB-DL"};pju} {source} {rW.find { ot ->  group == ot || qp == ot } ? "WEBRip" : ""} {def se = mJ.find { sl ->  group == sl || qp == sl} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : se} {vs} {""};QJQ ? "$QJQ " : ""}{def bKg = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $bKg, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def GT = " Dub";def avD = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : GT;avD = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : avD;avD}{def Cx = any { audioLanguages.size() } { 0 };def avD = Cx > 2 ? " MAud" : Cx > 1 ? " DAud" : null;def DUE = Cx > 5 ? audioLanguages.take(5) : audioLanguages;avD ? avD + DUE.joining(" ", " (", "").upper() + (Cx > 5 ? " ...)" : ")") : ""}{def OWu = any { textLanguages.size() } { 0 };def avD = OWu > 2 ? ", MSub" : OWu > 1 ? ", DSub" : null;def DUE = OWu > 5 ? textLanguages.take(5) : textLanguages;avD ? avD + DUE.joining(" ", " (", "").upper() + (OWu > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def Qa = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def St = subt;Qa.values().each { QPR -> if (St.contains(QPR)) {St = St.replace(QPR, "")}};Qa.iso3b + St}}{f.image ? "-thumb" : ""}