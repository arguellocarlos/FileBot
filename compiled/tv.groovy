{def wfg = {System.getProperty(it)};def EWN = wfg("os.name").toLowerCase().contains("windows");def mki = wfg("user.name");def Euz = "/run/media/${mki}";def yP = "";def Te = [[VXe: "Books", xbz: "F:/", _s: "$Euz/Books"],[VXe: "Data", xbz: "D:/", _s: "$Euz/Data"],[VXe: "Games", xbz: "G:/", _s: "$Euz/Games"],[VXe: "Music", xbz: "E:/", _s: "$Euz/Music"],[VXe: "Videos", xbz: "H:/", _s: "$Euz/Videos"]];def _NK = (Te.collect {it[EWN ? "xbz" : "_s"] as File}.sort {first, second -> first.exists() <=> second.exists() ?: first.diskSpace <=> second.diskSpace}).last().path;def uS = yP ?: _NK;"$uS/"}{"Videos/"}{def uVd = ["boys' love (bl)","gay theme","yaoi","yuri","lesbian","hentai", "sex","lgbt","explicit","adult animation","adult content"];def oT = "TheMovieDB::TV";def GGY = [[271026, oT],[220118, oT],[74180, oT]];def C_D = [[236530, oT]];def Jj = any {info.database} {id == tmdbid ? "TheMovieDB" : "IMDb"};def pPy = Jj == "IMDb" ? "tt${id}" : id;def uLV = any {info.adult} {false};def hF = GGY.find {it[0] == pPy && it[1] == Jj} != null;def TVE = C_D.find {it[0] == pPy && it[1] == Jj} != null;def NEm = info.Keywords.findAll {it in uVd} || hF || uLV;NEm = TVE ? false : NEm;NEm ? "R18+ " : ""}{def FEK = ["CN","JP","KR","KP","TW","HK"];def rN = ["aeni","donghua","anime"];def Vn = (any {anime} ||info.Keywords.findAll {it in rN} ||(FEK.contains(country) && genres.contains("Animation")));Vn ? "Anime/" : "TV Series/"}{def oT = "TheMovieDB::TV";def qt = [[MgD: 68854, Rs: "From Me to You", Hea: oT],[MgD: 94904, Rs: "My Next Life as a Villainess", Hea: oT],[MgD: 229743, Rs: "VTuber Legend", Hea: oT],[MgD: 234538, Rs: "Demon Lord 2099", Hea: oT],[MgD: 237045, Rs: "Cherry Magic!", Hea: oT],[MgD: 240633, Rs: "A Journey Through Another World", Hea: oT],[MgD: 245285, Rs: "Failure Frame", Hea: oT],[MgD: 271026, Rs: "Taisho Era Contract Marriage", Hea: oT]];def Jj = any {info.database} {id == tmdbid ? "TheMovieDB" : "IMDb"};def pPy = Jj == "IMDb" ? "tt${id}" : id;def owg = n;qt.each {if (it.MgD == pPy && it.Hea == Jj) {owg = it.Rs}};def fQ = ['\\','/',':','*','?','"','<','>','|'];def oa = owg.replaceAll(fQ.collect {"\\" + it}.join('|'), '');oa = oa.replaceAll(/(\s|\.)*$/, '');oa}{def oT = "TheMovieDB::TV";def cEs = [[68854,oT],[123542,oT],[204098,oT],[235973,oT],[239779,oT],[240125,oT],[257162,oT],[259140,oT],[262295,oT],[271026,oT],[273190,oT],[275695,oT]];def ESs = cEs.find{it[0] == id && it[1] == info.database} != null;def Sx = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def Ak = Sx[info.database];ESs ? " ($y) [${Ak}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def fQ = ['\\','/',':','*','?','"','<','>','|'];def oa = sn.replaceAll(fQ.collect {"\\" + it}.join('|'), '_');def PD = n.replaceAll(fQ.collect {"\\" + it}.join('|'), '_');def xco = oa.contains(PD) ? "" : oa;xco == 'Season '+ s ? "" : xco ? " - " + xco : ""}{"/"}{def Nm = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws"];def yNU = Nm.find {groupName ->  fn.contains(groupName)} ?: "";def NhJ = any {(fn =~ /^\[(.*?)\]/)[0][1]} {yNU} {group} {""};NhJ ? "[$NhJ] " : ""}{def oT = "TheMovieDB::TV";def qt = [[MgD: 68854, Rs: "From Me to You", Hea: oT],[MgD: 94904, Rs: "My Next Life as a Villainess", Hea: oT],[MgD: 229743, Rs: "VTuber Legend", Hea: oT],[MgD: 234538, Rs: "Demon Lord 2099", Hea: oT],[MgD: 237045, Rs: "Cherry Magic!", Hea: oT],[MgD: 240633, Rs: "A Journey Through Another World", Hea: oT],[MgD: 245285, Rs: "Failure Frame", Hea: oT],[MgD: 271026, Rs: "Taisho Era Contract Marriage", Hea: oT]];def Jj = any {info.database} {id == tmdbid ? "TheMovieDB" : "IMDb"};def pPy = Jj == "IMDb" ? "tt${id}" : id;def owg = n;qt.each {if (it.MgD == pPy && it.Hea == Jj) {owg = it.Rs}};def fQ = ['\\','/',':','*','?','"','<','>','|'];def oa = owg.replaceAll(fQ.collect {"\\" + it}.join('|'), '');oa = oa.replaceAll(/(\s|\.)*$/, '');oa}{" - "}{s00e00}{def fQ = ['\\','/',':','*','?','"','<','>','|'];def oa = t.replaceAll(fQ.collect {"\\" + it}.join('|'),'_';);def OUG = any {e} {special};oa = oa.length() > 100 ? " " : " - $oa ";oa == " - Episode $OUG " ? " " : oa}{" ["}{def cmt = [["ABEMA"],["ADN"],["BILI","B-Global","BiliIntl","B-Site","BiliCN"],["HIDIVE","HIDI.WEB-DL"],["IQIYI","IQ.WEB-DL"],["LAFTEL","LFTL"],["MW.WEB-DL"],["NF.WEB-DL","NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL","YOUTUBE","YTB"]];def qgL = ["ASW","Judas","JRx7","EMBER","KawaSubs","GuodongSubs"];def TQ = ["Erai-raws","SubsPlease"];def puP = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def kA = any {def Bt = cmt.find {idx -> idx.find {known -> fn.lower().contains(known.lower())}}[0];Bt = Bt.replace(".WEB-DL", "");Bt ? "${Bt}.WEB-DL" : ""} {source} {qgL.find {g_ ->  group == g_ || puP == g_} ? "WEBRip" : ""} {def YSb = TQ.find {r_ ->  group == r_ || puP == r_} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : YSb} {vs} {""};kA ? "$kA " : ""}{def EZm = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $EZm, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def va = " Dub";def ok = audioLanguages.any{it.ISO3B == language.ISO3B} ? "" : va;ok = audioLanguages.size() == 1 && audioLanguages.any{it.ISO3B == "und"} ? "" : ok;ok}{def Bl = any {audioLanguages.size()} {0};def ok = Bl > 2 ? " MAud" : Bl > 1 ? " DAud" : null;def wGy = Bl > 5 ? audioLanguages.take(5) : audioLanguages;ok ? ok + wGy.joining(" ", " (", "").upper() + (Bl > 5 ? " ...)" : ")") : ""}{def eq = any {textLanguages.size()} {0};def ok = eq > 2 ? ", MSub" : eq > 1 ? ", DSub" : null;def wGy = eq > 5 ? textLanguages.take(5) : textLanguages;ok ? ok + wGy.joining(" ", " (", "").upper() + (eq > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def Isn = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Ve = subt;Isn.values().each {code -> if (Ve.contains(code)) {Ve = Ve.replace(code, "")}};Isn.iso3b + Ve}}{f.image ? "-thumb" : ""}