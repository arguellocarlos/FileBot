{def JBu = { System.getProperty(it) };def ICB = JBu("os.name").toLowerCase().contains("windows");def Jd = JBu("user.name");def Xb = "/run/media/${Jd}";def yn = ICB ? "H:/" : "$Xb/Videos";def aoo = [[unh: "Books", jxs: "F:/", dU: "$Xb/Books"],[unh: "Data", jxs: "D:/", dU: "$Xb/Data"],[unh: "Games", jxs: "G:/", dU: "$Xb/Games"],[unh: "Music", jxs: "E:/", dU: "$Xb/Music"],[unh: "Videos", jxs: "H:/", dU: "$Xb/Videos"]];def v_l = (aoo.collect { it[ICB ? "jxs" : "dU"] as File }.sort { wOW, eP ->  wOW.exists() <=> eP.exists() ?: wOW.diskSpace <=> eP.diskSpace }).last();def nx = yn ?: v_l;"$nx/"}{"Videos/"}{def GaJ = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def eeg = "TheMovieDB::TV";def ag = [[ 74180, eeg],[ 93821, eeg],[ 95897, eeg],[220118, eeg],[271026, eeg]];def Zzl = [[236530, eeg]];def Vn = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def bi = Vn == "IMDb" ? "tt${id}" : id;def YZ = any { info.adult } { false };def Enr = ag.find { it[0] == bi && it[1] == Vn } != null;def Xbw = Zzl.find { it[0] == bi && it[1] == Vn } != null;def jH = info.Keywords.findAll { it in GaJ } || Enr || YZ;jH = Xbw ? false : jH;jH ? "R18+ " : ""}{def BrG = ["CN", "JP", "KR", "KP", "TW", "HK"];def cz = ["aeni", "donghua", "anime"];def ft = any {anime} || info.Keywords.findAll { it in cz } || (BrG.contains(country) && genres =~ /Animation/);ft ? "Anime/" : "TV Series/"}{def eeg = "TheMovieDB::TV";def pS = [[Po: 68854, RQQ: "From Me to You", hu: eeg],[Po: 219816, RQQ: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", hu: eeg],[Po: 245561, RQQ: "Okitsura", hu: eeg],[Po: 248707, RQQ: "Neko Oji The Guy That Got Reincarnated As a Cat", hu: eeg],[Po: 259559, RQQ: "Headhunted to Another World", hu: eeg],[Po: 276204, RQQ: "Bogus Skill Fruitmaster", hu: eeg]];def Vn = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def bi = Vn == "IMDb" ? "tt${id}" : id;def oF = n;pS.each {if (it.Po == bi && it.hu == Vn) {oF = it.RQQ}};def IN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def SKt = oF.replaceAll(IN.collect { "\\" + it }.join('|'), '');SKt = SKt.replaceAll(/(\s|\.)*$/, '');SKt}{def eeg = "TheMovieDB::TV";def vKq = [[ 95897, eeg],[123542, eeg],[235973, eeg],[239779, eeg],[257162, eeg],[259140, eeg],[276204, eeg]];def IHW = vKq.find { it[0] == id && it[1] == info.database } != null;def cbO = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def KRn = cbO[info.database];IHW ? " ($y) [${KRn}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def IN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def SKt = sn.replaceAll(IN.collect { "\\" + it }.join('|'), '_');def qv = n.replaceAll(IN.collect { "\\" + it }.join('|'), '_');def kB = SKt.contains(qv) ? "" : SKt;kB == 'Season '+ s ? "" : kB ? " - " + kB : ""}{"/"}{def lM = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","Samehadaku"];def xev = lM.find { fm ->  fn.lower().contains(fm.lower()) } ?: "";def uU = any {(fn =~ /^\[(.*?)\]/)[0][1]} {xev} {group} {""};uU ? "[$uU] " : ""}{def eeg = "TheMovieDB::TV";def pS = [[Po: 68854, RQQ: "From Me to You", hu: eeg],[Po: 219816, RQQ: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", hu: eeg],[Po: 245561, RQQ: "Okitsura", hu: eeg],[Po: 248707, RQQ: "Neko Oji The Guy That Got Reincarnated As a Cat", hu: eeg],[Po: 259559, RQQ: "Headhunted to Another World", hu: eeg],[Po: 276204, RQQ: "Bogus Skill Fruitmaster", hu: eeg]];def Vn = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def bi = Vn == "IMDb" ? "tt${id}" : id;def oF = n;pS.each {if (it.Po == bi && it.hu == Vn) {oF = it.RQQ}};def IN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def SKt = oF.replaceAll(IN.collect { "\\" + it }.join('|'), '');SKt = SKt.replaceAll(/(\s|\.)*$/, '');SKt}{" - "}{s00e00}{def IN = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def SKt = t.replaceAll(IN.collect { "\\" + it }.join('|'), '_');def LKC = any { e } { special };SKt = SKt.length() > 100 ? " " : " - $SKt ";SKt == " - Episode $LKC " ? " " : SKt}{" ["}{def et = [["ABEMA"],["ADN"],["BBC"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YTB", "YT.WEB-DL", "YOUTUBE"]];def tc = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs", "SAMEHADAKU"];def vH = ["Erai-raws", "SubsPlease"];def oU = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def WSW = any {def Kck = et.find { gL ->  gL.find { tw ->  fn.lower().contains(tw.lower()) } }[0];Kck = Kck.replace(".WEB-DL", "");Kck ? "${Kck}.WEB-DL" : ""} {source} {tc.find { vB ->  group == vB || oU == vB } ? "WEBRip" : ""} {def vXC = vH.find { VU ->  group == VU || oU == VU} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : vXC} {vs} {""};WSW ? "$WSW " : ""}{def JXu = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $JXu, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def QE = " Dub";def Og = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : QE;Og = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : Og;Og}{def mtq = any { audioLanguages.size() } { 0 };def Og = mtq > 2 ? " MAud" : mtq > 1 ? " DAud" : null;def ju = mtq > 5 ? audioLanguages.take(5) : audioLanguages;Og ? Og + ju.joining(" ", " (", "").upper() + (mtq > 5 ? " ...)" : ")") : ""}{def As = any { textLanguages.size() } { 0 };def Og = As > 2 ? ", MSub" : As > 1 ? ", DSub" : null;def ju = As > 5 ? textLanguages.take(5) : textLanguages;Og ? Og + ju.joining(" ", " (", "").upper() + (As > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def Xi = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def JV = subt;Xi.values().each { CM -> if (JV.contains(CM)) {JV = JV.replace(CM, "")}};Xi.iso3b + JV}}{f.image ? "-thumb" : ""}