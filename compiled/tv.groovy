{def YMe = { System.getProperty(it) };def mz = YMe("os.name").toLowerCase().contains("windows");def by = YMe("user.name");def oB = "/run/media/${by}";def kJA = mz ? "H:/" : "$oB/Videos";def RBJ = [[Qu: "Books", AL: "F:/", UA: "$oB/Books"],[Qu: "Data", AL: "D:/", UA: "$oB/Data"],[Qu: "Games", AL: "G:/", UA: "$oB/Games"],[Qu: "Music", AL: "E:/", UA: "$oB/Music"],[Qu: "Videos", AL: "H:/", UA: "$oB/Videos"]];def Hht = (RBJ.collect { it[mz ? "AL" : "UA"] as File }.sort { aqj, Fx ->  aqj.exists() <=> Fx.exists() ?: aqj.diskSpace <=> Fx.diskSpace }).last();def km = kJA ?: Hht;"$km/"}{"Videos/"}{def ZmJ = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def lgc = "TheMovieDB::TV";def Wol = [[ 74180, lgc],[ 93821, lgc],[ 95897, lgc],[220118, lgc],[249891, lgc],[271026, lgc]];def ra = [[236530, lgc]];def XYK = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def _oA = XYK == "IMDb" ? "tt${id}" : id;def ig = any { info.adult } { false };def aXu = Wol.find { it[0] == _oA && it[1] == XYK } != null;def nL = ra.find { it[0] == _oA && it[1] == XYK } != null;def wLH = info.Keywords.findAll { it in ZmJ } || aXu || ig;wLH = nL ? false : wLH;wLH ? "R18+ " : ""}{def myz = ["CN", "JP", "KR", "KP", "TW", "HK"];def GQS = ["aeni", "donghua", "anime"];def mXr = any {anime} || info.Keywords.findAll { it in GQS } || (myz.contains(country) && genres =~ /Animation/);mXr ? "Anime/" : "TV Series/"}{def lgc = "TheMovieDB::TV";def WD = [[CfA: 68854, TZ: "From Me to You", fx: lgc],[CfA: 199928, TZ: "Nights With a Cat", fx: lgc],[CfA: 219816, TZ: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", fx: lgc],[CfA: 245561, TZ: "Okitsura", fx: lgc],[CfA: 248707, TZ: "Neko Oji The Guy That Got Reincarnated As a Cat", fx: lgc],[CfA: 259559, TZ: "Headhunted to Another World", fx: lgc],[CfA: 261301, TZ: "Botsuraku Kizoku", fx: lgc],[CfA: 262141, TZ: "Can You Keep a Secret", fx: lgc],[CfA: 270657, TZ: "Tono to Inu", fx: lgc],[CfA: 276204, TZ: "Bogus Skill Fruitmaster", fx: lgc]];def XYK = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def _oA = XYK == "IMDb" ? "tt${id}" : id;def hj = n;WD.each {if (it.CfA == _oA && it.fx == XYK) {hj = it.TZ}};def hCM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def oLB = hj.replaceAll(hCM.collect { "\\" + it }.join('|'), '');oLB = oLB.replaceAll(/(\s|\.)*$/, '');oLB}{def lgc = "TheMovieDB::TV";def LJ = [[ 95897, lgc],[123542, lgc],[235973, lgc],[239779, lgc],[257162, lgc],[259140, lgc],[276204, lgc]];def xl = LJ.find { it[0] == id && it[1] == info.database } != null;def ZVg = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def ql = ZVg[info.database];xl ? " ($y) [${ql}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def hCM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def oLB = sn.replaceAll(hCM.collect { "\\" + it }.join('|'), '_');def li = n.replaceAll(hCM.collect { "\\" + it }.join('|'), '_');def Ae = oLB.contains(li) ? "" : oLB;Ae == 'Season '+ s || Ae == 'Series '+ s ? "" : Ae ? " - " + Ae : ""}{"/"}{def jGe = ["Alqanime","BlackLuster","darkflux","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def vY = jGe.find { GMA ->  fn.lower().contains(GMA.lower()) } ?: "";def Ok = any {(fn =~ /^\[(.*?)\]/)[0][1]} {vY} {group} {""};Ok ? "[$Ok] " : ""}{def lgc = "TheMovieDB::TV";def WD = [[CfA: 68854, TZ: "From Me to You", fx: lgc],[CfA: 199928, TZ: "Nights With a Cat", fx: lgc],[CfA: 219816, TZ: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", fx: lgc],[CfA: 245561, TZ: "Okitsura", fx: lgc],[CfA: 248707, TZ: "Neko Oji The Guy That Got Reincarnated As a Cat", fx: lgc],[CfA: 259559, TZ: "Headhunted to Another World", fx: lgc],[CfA: 261301, TZ: "Botsuraku Kizoku", fx: lgc],[CfA: 262141, TZ: "Can You Keep a Secret", fx: lgc],[CfA: 270657, TZ: "Tono to Inu", fx: lgc],[CfA: 276204, TZ: "Bogus Skill Fruitmaster", fx: lgc]];def XYK = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def _oA = XYK == "IMDb" ? "tt${id}" : id;def hj = n;WD.each {if (it.CfA == _oA && it.fx == XYK) {hj = it.TZ}};def hCM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def oLB = hj.replaceAll(hCM.collect { "\\" + it }.join('|'), '');oLB = oLB.replaceAll(/(\s|\.)*$/, '');oLB}{" - "}{s00e00}{def hCM = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def oLB = t.replaceAll(hCM.collect { "\\" + it }.join('|'), '_');oLB = oLB.length() > 100 ? " " : " - $oLB ";def hr = any { e } { special };def tjd = "Episode $hr";def JhK = oLB.contains(tjd) ? '' : oLB;JhK != '' ? JhK : ''}{" ["}{def od = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"]];def kA = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def iUs = ["DB"];def NY = ["Ruri-Saizen"];def QZI = ["Erai-raws", "SubsPlease"];def Uau = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def SyO = any {def dgV = od.find { wV ->  wV.find { SUe ->  fn.lower().contains(SUe.lower()) } }[0];dgV = dgV.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {dgV = dgV.replace(".WEBRip", "");dgV = dgV + ".WEBRip"} else {dgV = dgV + ".WEB-DL"};dgV} {source} {kA.find { mA ->  group == mA || Uau == mA } ? "WEBRip" : ""} {iUs.find { mA ->  group == mA || Uau == mA } ? "BDRip" : ""} {NY.find { mA ->  group == g__ || Uau == g__} ? "HDTVRip" : ""} {def hb = QZI.find { gTd ->  group == gTd || Uau == gTd} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : hb} {vs} {""};SyO ? "$SyO " : ""}{def cL = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $cL, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def SO = any { textLanguages.size() } { 0 };def CV = SO > 2 ? " MULTi" : SO > 1 ? " DUAL" : SO = 1 ? " SUB" : null;def Yq = SO > 5 ? textLanguages.take(5) : textLanguages;CV ? CV + Yq.joining(" ", " (", "").upper() + (SO > 6 ? " ...)" : ")") : ""}{def pY = any { audioLanguages.size() } { 0 };def CV = pY > 2 ? ", MULTi-AUD" : pY > 1 ? ", DUAL-AUD" : null;def Yq = pY > 5 ? audioLanguages.take(5) : audioLanguages;CV ? CV + Yq.joining(" ", " (", "").upper() + (pY > 5 ? " ...)" : ")") : ""}{def hK = ", DUBBED";def CV = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : hK;CV = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : CV;CV}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def ne = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def fV = subt;ne.values().each { vsK -> if (fV.contains(vsK)) {fV = fV.replace(vsK, "")}};ne.iso3b + fV}}{f.image ? "-thumb" : ""}