{def hgM = { System.getProperty(it) };def Za = hgM("os.name").toLowerCase().contains("windows");def td = hgM("user.name");def xx = "/run/media/${td}";def SVa = Za ? "H:/" : "$xx/Videos";def iU = [[XLO: "Books", xf: "F:/", gH: "$xx/Books"],[XLO: "Data", xf: "D:/", gH: "$xx/Data"],[XLO: "Games", xf: "G:/", gH: "$xx/Games"],[XLO: "Music", xf: "E:/", gH: "$xx/Music"],[XLO: "Videos", xf: "H:/", gH: "$xx/Videos"]];def Al = (iU.collect { it[Za ? "xf" : "gH"] as File }.sort { iiZ, gR ->  iiZ.exists() <=> gR.exists() ?: iiZ.diskSpace <=> gR.diskSpace }).last();def k_H = SVa ?: Al;"$k_H/"}{"Videos/"}{def lhg = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def CgI = "TheMovieDB::TV";def fA = [[ 74180, CgI],[ 93821, CgI],[ 95897, CgI],[220118, CgI],[271026, CgI]];def eDX = [[236530, CgI]];def vkr = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def eRH = vkr == "IMDb" ? "tt${id}" : id;def eIl = any { info.adult } { false };def hC = fA.find { it[0] == eRH && it[1] == vkr } != null;def YY = eDX.find { it[0] == eRH && it[1] == vkr } != null;def vXj = info.Keywords.findAll { it in lhg } || hC || eIl;vXj = YY ? false : vXj;vXj ? "R18+ " : ""}{def uJ = ["CN", "JP", "KR", "KP", "TW", "HK"];def Oz = ["aeni", "donghua", "anime"];def iS = any {anime} || info.Keywords.findAll { it in Oz } || (uJ.contains(country) && genres =~ /Animation/);iS ? "Anime/" : "TV Series/"}{def CgI = "TheMovieDB::TV";def Fs = [[VVI: 68854, yaH: "From Me to You", gDF: CgI],[VVI: 219816, yaH: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", gDF: CgI],[VVI: 245561, yaH: "Okitsura", gDF: CgI],[VVI: 248707, yaH: "Neko Oji The Guy That Got Reincarnated As a Cat", gDF: CgI],[VVI: 259559, yaH: "Headhunted to Another World", gDF: CgI],[VVI: 261301, yaH: "Botsuraku Kizoku", gDF: CgI],[VVI: 262141, yaH: "Can You Keep a Secret", gDF: CgI],[VVI: 270657, yaH: "Tono to Inu", gDF: CgI],[VVI: 276204, yaH: "Bogus Skill Fruitmaster", gDF: CgI]];def vkr = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def eRH = vkr == "IMDb" ? "tt${id}" : id;def thb = n;Fs.each {if (it.VVI == eRH && it.gDF == vkr) {thb = it.yaH}};def zfQ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def YN = thb.replaceAll(zfQ.collect { "\\" + it }.join('|'), '');YN = YN.replaceAll(/(\s|\.)*$/, '');YN}{def CgI = "TheMovieDB::TV";def XmA = [[ 95897, CgI],[123542, CgI],[235973, CgI],[239779, CgI],[257162, CgI],[259140, CgI],[276204, CgI]];def Re = XmA.find { it[0] == id && it[1] == info.database } != null;def Av = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def qgn = Av[info.database];Re ? " ($y) [${qgn}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def zfQ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def YN = sn.replaceAll(zfQ.collect { "\\" + it }.join('|'), '_');def IsJ = n.replaceAll(zfQ.collect { "\\" + it }.join('|'), '_');def WQ = YN.contains(IsJ) ? "" : YN;WQ == 'Season '+ s ? "" : WQ ? " - " + WQ : ""}{"/"}{def cwq = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def Cuh = cwq.find { __ ->  fn.lower().contains(__.lower()) } ?: "";def zy = any {(fn =~ /^\[(.*?)\]/)[0][1]} {Cuh} {group} {""};zy ? "[$zy] " : ""}{def CgI = "TheMovieDB::TV";def Fs = [[VVI: 68854, yaH: "From Me to You", gDF: CgI],[VVI: 219816, yaH: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", gDF: CgI],[VVI: 245561, yaH: "Okitsura", gDF: CgI],[VVI: 248707, yaH: "Neko Oji The Guy That Got Reincarnated As a Cat", gDF: CgI],[VVI: 259559, yaH: "Headhunted to Another World", gDF: CgI],[VVI: 261301, yaH: "Botsuraku Kizoku", gDF: CgI],[VVI: 262141, yaH: "Can You Keep a Secret", gDF: CgI],[VVI: 270657, yaH: "Tono to Inu", gDF: CgI],[VVI: 276204, yaH: "Bogus Skill Fruitmaster", gDF: CgI]];def vkr = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def eRH = vkr == "IMDb" ? "tt${id}" : id;def thb = n;Fs.each {if (it.VVI == eRH && it.gDF == vkr) {thb = it.yaH}};def zfQ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def YN = thb.replaceAll(zfQ.collect { "\\" + it }.join('|'), '');YN = YN.replaceAll(/(\s|\.)*$/, '');YN}{" - "}{s00e00}{def zfQ = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def YN = t.replaceAll(zfQ.collect { "\\" + it }.join('|'), '_');YN = YN.length() > 100 ? " " : " - $YN ";def rKx = any { e } { special };def iSe = "Episode $rKx";def oPE = YN.contains(iSe) ? '' : YN;oPE != '' ? oPE : ''}{" ["}{def ps = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YTB", "YT.WEB-DL", "YOUTUBE"]];def bx = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def qJC = ["Erai-raws", "SubsPlease"];def UBn = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def Jpy = any {def WR = ps.find { mI ->  mI.find { fNy ->  fn.lower().contains(fNy.lower()) } }[0];WR = WR.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {WR = WR + ".WEBRip"} else if (fn.contains("WEB-DL") || fn.contains("WEBDL")) {WR = WR + ".WEB-DL"};WR} {source} {bx.find { hQP ->  group == hQP || UBn == hQP } ? "WEBRip" : ""} {def qD = qJC.find { aNt ->  group == aNt || UBn == aNt} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : qD} {vs} {""};Jpy ? "$Jpy " : ""}{def KD = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $KD, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def PXI = " Dub";def YE = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : PXI;YE = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : YE;YE}{def YoW = any { audioLanguages.size() } { 0 };def YE = YoW > 2 ? " MAud" : YoW > 1 ? " DAud" : null;def zos = YoW > 5 ? audioLanguages.take(5) : audioLanguages;YE ? YE + zos.joining(" ", " (", "").upper() + (YoW > 5 ? " ...)" : ")") : ""}{def zPE = any { textLanguages.size() } { 0 };def YE = zPE > 2 ? ", MSub" : zPE > 1 ? ", DSub" : null;def zos = zPE > 5 ? textLanguages.take(5) : textLanguages;YE ? YE + zos.joining(" ", " (", "").upper() + (zPE > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def ROb = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def tDw = subt;ROb.values().each { BI -> if (tDw.contains(BI)) {tDw = tDw.replace(BI, "")}};ROb.iso3b + tDw}}{f.image ? "-thumb" : ""}