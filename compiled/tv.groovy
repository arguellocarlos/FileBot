{def XtO = { System.getProperty(it) };def ICf = XtO("os.name").toLowerCase().contains("windows");def jjG = XtO("user.name");def XVn = "/run/media/${jjG}";def Jr = ICf ? "H:/" : "$XVn/Videos";def gID = [[WKe: "Books", C_g: "F:/", xo: "$XVn/Books"],[WKe: "Data", C_g: "D:/", xo: "$XVn/Data"],[WKe: "Games", C_g: "G:/", xo: "$XVn/Games"],[WKe: "Music", C_g: "E:/", xo: "$XVn/Music"],[WKe: "Videos", C_g: "H:/", xo: "$XVn/Videos"]];def bAK = (gID.collect { it[ICf ? "C_g" : "xo"] as File }.sort { H_O, WEg ->  H_O.exists() <=> WEg.exists() ?: H_O.diskSpace <=> WEg.diskSpace }).last();def NlQ = Jr ?: bAK;"$NlQ/"}{"Videos/"}{def cLO = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def DkQ = "TheMovieDB::TV";def kL = [[271026, DkQ],[220118, DkQ],[ 74180, DkQ]];def Kh = [[236530, DkQ]];def MS = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def MAo = MS == "IMDb" ? "tt${id}" : id;def D_ = any { info.adult } { false };def lxp = kL.find { it[0] == MAo && it[1] == MS } != null;def BK = Kh.find { it[0] == MAo && it[1] == MS } != null;def On = info.Keywords.findAll { it in cLO } || lxp || D_;On = BK ? false : On;On ? "R18+ " : ""}{def le = ["CN", "JP", "KR", "KP", "TW", "HK"];def JS = ["aeni", "donghua", "anime"];def mWq = any {anime} || info.Keywords.findAll { it in JS } || (le.contains(country) && genres =~ /Animation/);mWq ? "Anime/" : "TV Series/"}{def DkQ = "TheMovieDB::TV";def BJ = [[OHo: 68854, dJ: "From Me to You", jMd: DkQ],[OHo: 94904, dJ: "My Next Life as a Villainess", jMd: DkQ],[OHo: 229743, dJ: "VTuber Legend", jMd: DkQ],[OHo: 234538, dJ: "Demon Lord 2099", jMd: DkQ],[OHo: 237045, dJ: "Cherry Magic!", jMd: DkQ],[OHo: 240633, dJ: "A Journey Through Another World", jMd: DkQ],[OHo: 245285, dJ: "Failure Frame", jMd: DkQ],[OHo: 271026, dJ: "Taisho Era Contract Marriage", jMd: DkQ]];def MS = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def MAo = MS == "IMDb" ? "tt${id}" : id;def PrC = n;BJ.each {if (it.OHo == MAo && it.jMd == MS) {PrC = it.dJ}};def MRz = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def fVU = PrC.replaceAll(MRz.collect { "\\" + it }.join('|'), '');fVU = fVU.replaceAll(/(\s|\.)*$/, '');fVU}{def DkQ = "TheMovieDB::TV";def ho = [[ 68854, DkQ],[123542, DkQ],[204098, DkQ],[235973, DkQ],[239779, DkQ],[240125, DkQ],[257162, DkQ],[259140, DkQ],[262295, DkQ],[271026, DkQ],[273190, DkQ],[275695, DkQ]];def TTR = ho.find { it[0] == id && it[1] == info.database } != null;def Es = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def Ypk = Es[info.database];TTR ? " ($y) [${Ypk}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def MRz = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def fVU = sn.replaceAll(MRz.collect { "\\" + it }.join('|'), '_');def JAW = n.replaceAll(MRz.collect { "\\" + it }.join('|'), '_');def wpX = fVU.contains(JAW) ? "" : fVU;wpX == 'Season '+ s ? "" : wpX ? " - " + wpX : ""}{"/"}{def bW = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def Sk = bW.find { ZEs ->  fn.contains(ZEs) } ?: "";def La = any {(fn =~ /^\[(.*?)\]/)[0][1]} {Sk} {group} {""};La ? "[$La] " : ""}{def DkQ = "TheMovieDB::TV";def BJ = [[OHo: 68854, dJ: "From Me to You", jMd: DkQ],[OHo: 94904, dJ: "My Next Life as a Villainess", jMd: DkQ],[OHo: 229743, dJ: "VTuber Legend", jMd: DkQ],[OHo: 234538, dJ: "Demon Lord 2099", jMd: DkQ],[OHo: 237045, dJ: "Cherry Magic!", jMd: DkQ],[OHo: 240633, dJ: "A Journey Through Another World", jMd: DkQ],[OHo: 245285, dJ: "Failure Frame", jMd: DkQ],[OHo: 271026, dJ: "Taisho Era Contract Marriage", jMd: DkQ]];def MS = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def MAo = MS == "IMDb" ? "tt${id}" : id;def PrC = n;BJ.each {if (it.OHo == MAo && it.jMd == MS) {PrC = it.dJ}};def MRz = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def fVU = PrC.replaceAll(MRz.collect { "\\" + it }.join('|'), '');fVU = fVU.replaceAll(/(\s|\.)*$/, '');fVU}{" - "}{s00e00}{def MRz = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def fVU = t.replaceAll(MRz.collect { "\\" + it }.join('|'), '_');def NS = any { e } { special };fVU = fVU.length() > 100 ? " " : " - $fVU ";fVU == " - Episode $NS " ? " " : fVU}{" ["}{def Rf = [["ABEMA"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["HULU"],["IQIYI", "IQ.WEB-DL"],["LAFTEL", "LFTL"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["AMZN"],["SHAHID"],["TVER"],["UNEXT"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def FD = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def wc = ["Erai-raws", "SubsPlease"];def VS = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def lV = any {def SsC = Rf.find { Uz ->  Uz.find { kiC ->  fn.lower().contains(kiC.lower()) } }[0];SsC = SsC.replace(".WEB-DL", "");SsC ? "${SsC}.WEB-DL" : ""} {} {source} {FD.find { Tsq ->  group == Tsq || VS == Tsq } ? "WEBRip" : ""} {def Z_ = wc.find { ji ->  group == ji || VS == ji} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : Z_} {vs} {""};lV ? "$lV " : ""}{def GG = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $GG, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def JD = " Dub";def jhh = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : JD;jhh = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : jhh;jhh}{def ZG = any { audioLanguages.size() } { 0 };def jhh = ZG > 2 ? " MAud" : ZG > 1 ? " DAud" : null;def JiC = ZG > 5 ? audioLanguages.take(5) : audioLanguages;jhh ? jhh + JiC.joining(" ", " (", "").upper() + (ZG > 5 ? " ...)" : ")") : ""}{def WMp = any { textLanguages.size() } { 0 };def jhh = WMp > 2 ? ", MSub" : WMp > 1 ? ", DSub" : null;def JiC = WMp > 5 ? textLanguages.take(5) : textLanguages;jhh ? jhh + JiC.joining(" ", " (", "").upper() + (WMp > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def DVg = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def sM = subt;DVg.values().each { BS -> if (sM.contains(BS)) {sM = sM.replace(BS, "")}};DVg.iso3b + sM}}{f.image ? "-thumb" : ""}