{def oDv = { System.getProperty(it) };def uW = oDv("os.name").toLowerCase().contains("windows");def _tP = oDv("user.name");def yIb = "/run/media/${_tP}";def nia = uW ? "H:/" : "$yIb/Videos";def Lm = [[KF: "Books", NP: "F:/", Jyz: "$yIb/Books"],[KF: "Data", NP: "D:/", Jyz: "$yIb/Data"],[KF: "Games", NP: "G:/", Jyz: "$yIb/Games"],[KF: "Music", NP: "E:/", Jyz: "$yIb/Music"],[KF: "Videos", NP: "H:/", Jyz: "$yIb/Videos"]];def KUI = (Lm.collect { it[uW ? "NP" : "Jyz"] as File }.sort { fPo, rS ->  fPo.exists() <=> rS.exists() ?: fPo.diskSpace <=> rS.diskSpace }).last();def qYa = nia ?: KUI;"$qYa/"}{"Videos/"}{def bak = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def Lti = "TheMovieDB::TV";def wlc = [[ 74180, Lti],[ 93821, Lti],[ 95897, Lti],[220118, Lti],[249891, Lti],[271026, Lti]];def bq = [[236530, Lti]];def FmP = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def ybn = FmP == "IMDb" ? "tt${id}" : id;def EG = any { info.adult } { false };def UB = wlc.find { it[0] == ybn && it[1] == FmP } != null;def XmU = bq.find { it[0] == ybn && it[1] == FmP } != null;def VSs = info.Keywords.findAll { it in bak } || UB || EG;VSs = XmU ? false : VSs;VSs ? "R18+ " : ""}{def CgM = ["CN", "JP", "KR", "KP", "TW", "HK"];def CHV = ["aeni", "donghua", "anime"];def kj = any {anime} || info.Keywords.findAll { it in CHV } || (CgM.contains(country) && genres =~ /Animation/);kj ? "Anime/" : "TV Series/"}{def Lti = "TheMovieDB::TV";def pI = [[dhd: 199928, Bk: "Nights With a Cat", EX: Lti],[dhd: 213830, Bk: "I Was Reincarnated as the 7th Prince", EX: Lti],[dhd: 232230, Bk: "Lord of the Mysteries", EX: Lti],[dhd: 248707, Bk: "Neko Oji The Guy That Got Reincarnated As a Cat", EX: Lti],[dhd: 270660, Bk: "Pochars", EX: Lti],[dhd: 277581, Bk: "Dekin no Mogura", EX: Lti],[dhd: 280038, Bk: "Apocalypse Bringer Mynoghra", EX: Lti],[dhd: 280078, Bk: "The All-devouring Whale Homecoming", EX: Lti],[dhd: 283704, Bk: "Fermat Kitchen", EX: Lti],[dhd: 283884, Bk: "Chuhai Lips", EX: Lti],[dhd: 288404, Bk: "The New Chronicles of Extraordinary Beings Preface", EX: Lti],[dhd: 288419, Bk: "Chikuwa Senki", EX: Lti]];def FmP = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def ybn = FmP == "IMDb" ? "tt${id}" : id;def gfH = n;pI.each {if (it.dhd == ybn && it.EX == FmP) {gfH = it.Bk}};def PEU = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def VB = gfH.replaceAll(PEU.collect { "\\" + it }.join('|'), '');VB = VB.replaceAll(/(\s|\.)*$/, '');VB}{def Lti = "TheMovieDB::TV";def nu = [[ 95897, Lti],[123542, Lti],[239779, Lti],[257162, Lti],[259140, Lti],[276204, Lti]];def ADt = nu.find { it[0] == id && it[1] == info.database } != null;def soy = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def t_ = soy[info.database];ADt ? " ($y) [${t_}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def PEU = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def VB = sn.replaceAll(PEU.collect { "\\" + it }.join('|'), '_');def pj = n.replaceAll(PEU.collect { "\\" + it }.join('|'), '_');def Oe = VB.contains(pj) ? "" : VB;Oe == 'Season '+ s || Oe == 'Series '+ s ? "" : Oe ? " - " + Oe : ""}{"/"}{def YdI = ["Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def NS = YdI.find { sLl ->  fn.lower().contains(sLl.lower()) } ?: "";def Kr = any {NS} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};Kr ? "[$Kr] " : ""}{def Lti = "TheMovieDB::TV";def pI = [[dhd: 199928, Bk: "Nights With a Cat", EX: Lti],[dhd: 213830, Bk: "I Was Reincarnated as the 7th Prince", EX: Lti],[dhd: 232230, Bk: "Lord of the Mysteries", EX: Lti],[dhd: 248707, Bk: "Neko Oji The Guy That Got Reincarnated As a Cat", EX: Lti],[dhd: 270660, Bk: "Pochars", EX: Lti],[dhd: 277581, Bk: "Dekin no Mogura", EX: Lti],[dhd: 280038, Bk: "Apocalypse Bringer Mynoghra", EX: Lti],[dhd: 280078, Bk: "The All-devouring Whale Homecoming", EX: Lti],[dhd: 283704, Bk: "Fermat Kitchen", EX: Lti],[dhd: 283884, Bk: "Chuhai Lips", EX: Lti],[dhd: 288404, Bk: "The New Chronicles of Extraordinary Beings Preface", EX: Lti],[dhd: 288419, Bk: "Chikuwa Senki", EX: Lti]];def FmP = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def ybn = FmP == "IMDb" ? "tt${id}" : id;def gfH = n;pI.each {if (it.dhd == ybn && it.EX == FmP) {gfH = it.Bk}};def PEU = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def VB = gfH.replaceAll(PEU.collect { "\\" + it }.join('|'), '');VB = VB.replaceAll(/(\s|\.)*$/, '');VB}{" - "}{s00e00}{def PEU = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def VB = t.replaceAll(PEU.collect { "\\" + it }.join('|'), '_');VB = VB.length() > 100 ? " " : " - $VB ";def RQ = any { e } { special };def Vw = "Episode $RQ";def lLw = VB.contains(Vw) ? '' : VB;lLw != '' ? lLw : ''}{" ["}{def pKh = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["CMIC", "COOLMIC"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"]];def mns = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def L_ = ["DB"];def rl = ["Ruri-Saizen"];def ABR = ["Erai-raws", "SubsPlease"];def voO = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def AJ = any {def nKf = pKh.find { DDS ->  DDS.find { tJC ->  fn.lower().contains(tJC.lower()) } }[0];nKf = nKf.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {nKf = nKf.replace(".WEBRip", "");nKf = nKf + ".WEBRip"} else {nKf = nKf + ".WEB-DL"};nKf} {source} {mns.find { VC ->  group == VC || voO == VC } ? "WEBRip" : ""} {L_.find { VC ->  group == VC || voO == VC } ? "BDRip" : ""} {rl.find { VC ->  group == g__ || voO == g__} ? "HDTVRip" : ""} {def pcN = ABR.find { bEH ->  group == bEH || voO == bEH} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : pcN} {vs} {""};AJ ? "$AJ " : ""}{def DH = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $DH, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def onu = any { audioLanguages.size() } { 0 };def HGB = onu > 2 ? " MULTi-AUD" : onu > 1 ? " DUAL-AUD" : "";def lCL = onu > 5 ? audioLanguages.take(5) : audioLanguages;def RKQ = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";HGB = onu == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$HGB$RKQ";HGB ? HGB + lCL.ISO2.joining(" ", " (", "").upper() + (onu > 5 ? " ...)" : ")") : ""}{def DTF = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def BA_ = any { DTF.size() } { 0 };def HGB = BA_ > 2 ? ", MULTi" : BA_ > 1 ? ", DUAL" : BA_ == 1 ? ", SUB" : null;def lCL = BA_ > 5 ? DTF.take(5) : DTF;HGB ? HGB + lCL.joining(" ", " (", "").upper() + (BA_ > 6 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def Eqi = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def lq = subt;Eqi.values().each { rv -> if (lq.contains(rv)) {lq = lq.replace(rv, "")}};Eqi.iso3b + lq}}{f.image ? "-thumb" : ""}