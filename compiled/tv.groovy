{def Vp = { System.getProperty(it) };def bSV = Vp("os.name").toLowerCase().contains("windows");def zN = Vp("user.name");def dY = "/run/media/${zN}";def DMe = bSV ? "H:/" : "$dY/Videos";def Fg = [[mQ: "Books", jt: "F:/", aQ: "$dY/Books"],[mQ: "Data", jt: "D:/", aQ: "$dY/Data"],[mQ: "Games", jt: "G:/", aQ: "$dY/Games"],[mQ: "Music", jt: "E:/", aQ: "$dY/Music"],[mQ: "Videos", jt: "H:/", aQ: "$dY/Videos"]];def Pph = (Fg.collect { it[bSV ? "jt" : "aQ"] as File }.sort { yD, cz ->  yD.exists() <=> cz.exists() ?: yD.diskSpace <=> cz.diskSpace }).last();def GUK = DMe ?: Pph;"$GUK/"}{"Videos/"}{def CHQ = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity"];def qQE = "TheMovieDB::TV";def jW = [[ 74180, qQE],[ 93821, qQE],[ 95897, qQE],[220118, qQE],[271026, qQE]];def NB = [[236530, qQE]];def Nam = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def gaY = Nam == "IMDb" ? "tt${id}" : id;def CB = any { info.adult } { false };def Tu = jW.find { it[0] == gaY && it[1] == Nam } != null;def BAv = NB.find { it[0] == gaY && it[1] == Nam } != null;def JfB = info.Keywords.findAll { it in CHQ } || Tu || CB;JfB = BAv ? false : JfB;JfB ? "R18+ " : ""}{def wj = ["CN", "JP", "KR", "KP", "TW", "HK"];def Wf = ["aeni", "donghua", "anime"];def SgN = any {anime} || info.Keywords.findAll { it in Wf } || (wj.contains(country) && genres =~ /Animation/);SgN ? "Anime/" : "TV Series/"}{def qQE = "TheMovieDB::TV";def sa = [[oLA: 68854, dy: "From Me to You", _V: qQE],[oLA: 219816, dy: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", _V: qQE],[oLA: 245561, dy: "Okitsura", _V: qQE],[oLA: 248707, dy: "Neko Oji The Guy That Got Reincarnated As a Cat", _V: qQE],[oLA: 259559, dy: "Headhunted to Another World", _V: qQE],[oLA: 261301, dy: "Botsuraku Kizoku", _V: qQE],[oLA: 262141, dy: "Can You Keep a Secret", _V: qQE],[oLA: 270657, dy: "Tono to Inu", _V: qQE],[oLA: 276204, dy: "Bogus Skill Fruitmaster", _V: qQE]];def Nam = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def gaY = Nam == "IMDb" ? "tt${id}" : id;def Lm = n;sa.each {if (it.oLA == gaY && it._V == Nam) {Lm = it.dy}};def xx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def MX = Lm.replaceAll(xx.collect { "\\" + it }.join('|'), '');MX = MX.replaceAll(/(\s|\.)*$/, '');MX}{def qQE = "TheMovieDB::TV";def trN = [[ 95897, qQE],[123542, qQE],[235973, qQE],[239779, qQE],[257162, qQE],[259140, qQE],[276204, qQE]];def rTU = trN.find { it[0] == id && it[1] == info.database } != null;def XUC = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def ye = XUC[info.database];rTU ? " ($y) [${ye}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def xx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def MX = sn.replaceAll(xx.collect { "\\" + it }.join('|'), '_');def cJ = n.replaceAll(xx.collect { "\\" + it }.join('|'), '_');def yl = MX.contains(cJ) ? "" : MX;yl == 'Season '+ s ? "" : yl ? " - " + yl : ""}{"/"}{def elL = ["Alqanime","BlackLuster","darkflux","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def Zfh = elL.find { Zit ->  fn.lower().contains(Zit.lower()) } ?: "";def wPn = any {(fn =~ /^\[(.*?)\]/)[0][1]} {Zfh} {group} {""};wPn ? "[$wPn] " : ""}{def qQE = "TheMovieDB::TV";def sa = [[oLA: 68854, dy: "From Me to You", _V: qQE],[oLA: 219816, dy: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", _V: qQE],[oLA: 245561, dy: "Okitsura", _V: qQE],[oLA: 248707, dy: "Neko Oji The Guy That Got Reincarnated As a Cat", _V: qQE],[oLA: 259559, dy: "Headhunted to Another World", _V: qQE],[oLA: 261301, dy: "Botsuraku Kizoku", _V: qQE],[oLA: 262141, dy: "Can You Keep a Secret", _V: qQE],[oLA: 270657, dy: "Tono to Inu", _V: qQE],[oLA: 276204, dy: "Bogus Skill Fruitmaster", _V: qQE]];def Nam = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def gaY = Nam == "IMDb" ? "tt${id}" : id;def Lm = n;sa.each {if (it.oLA == gaY && it._V == Nam) {Lm = it.dy}};def xx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def MX = Lm.replaceAll(xx.collect { "\\" + it }.join('|'), '');MX = MX.replaceAll(/(\s|\.)*$/, '');MX}{" - "}{s00e00}{def xx = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def MX = t.replaceAll(xx.collect { "\\" + it }.join('|'), '_');MX = MX.length() > 100 ? " " : " - $MX ";def aK = any { e } { special };def Edg = "Episode $aK";def YL = MX.contains(Edg) ? '' : MX;YL != '' ? YL : ''}{" ["}{def BNW = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"]];def ol = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def uCf = ["Erai-raws", "SubsPlease"];def PPI = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def TR = any {def Fs = BNW.find { vlt ->  vlt.find { T_q ->  fn.lower().contains(T_q.lower()) } }[0];Fs = Fs.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {Fs = Fs.replace(".WEBRip", "");Fs = Fs + ".WEBRip"} else {Fs = Fs + ".WEB-DL"};Fs} {source} {ol.find { eQU ->  group == eQU || PPI == eQU } ? "WEBRip" : ""} {def sB = uCf.find { kp ->  group == kp || PPI == kp} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : sB} {vs} {""};TR ? "$TR " : ""}{def iY = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $iY, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def nkV = " Dub";def WvD = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : nkV;WvD = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : WvD;WvD}{def uv = any { audioLanguages.size() } { 0 };def WvD = uv > 2 ? " MAud" : uv > 1 ? " DAud" : null;def Xl = uv > 5 ? audioLanguages.take(5) : audioLanguages;WvD ? WvD + Xl.joining(" ", " (", "").upper() + (uv > 5 ? " ...)" : ")") : ""}{def AyU = any { textLanguages.size() } { 0 };def WvD = AyU > 2 ? ", MSub" : AyU > 1 ? ", DSub" : null;def Xl = AyU > 5 ? textLanguages.take(5) : textLanguages;WvD ? WvD + Xl.joining(" ", " (", "").upper() + (AyU > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def tk = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Nf = subt;tk.values().each { CWU -> if (Nf.contains(CWU)) {Nf = Nf.replace(CWU, "")}};tk.iso3b + Nf}}{f.image ? "-thumb" : ""}