{def Gv = { System.getProperty(it) };def BcB = Gv("os.name").toLowerCase().contains("windows");def Eer = Gv("user.name");def Cs = "/run/media/${Eer}";def Mc = BcB ? "H:/" : "$Cs/Videos";def WOI = [[Sa: "Books", ZW: "F:/", hUG: "$Cs/Books"],[Sa: "Data", ZW: "D:/", hUG: "$Cs/Data"],[Sa: "Games", ZW: "G:/", hUG: "$Cs/Games"],[Sa: "Music", ZW: "E:/", hUG: "$Cs/Music"],[Sa: "Videos", ZW: "H:/", hUG: "$Cs/Videos"]];def _fC = (WOI.collect { it[BcB ? "ZW" : "hUG"] as File }.sort { k_, sNh ->  k_.exists() <=> sNh.exists() ?: k_.diskSpace <=> sNh.diskSpace }).last();def bP = Mc ?: _fC;"$bP/"}{"Videos/"}{def mW = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def RA = "TheMovieDB::TV";def KMW = [[271026, RA],[220118, RA],[ 74180, RA]];def VB = [[236530, RA]];def CHV = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def tcZ = CHV == "IMDb" ? "tt${id}" : id;def Wc = any { info.adult } { false };def Zd = KMW.find { it[0] == tcZ && it[1] == CHV } != null;def tT = VB.find { it[0] == tcZ && it[1] == CHV } != null;def kDr = info.Keywords.findAll { it in mW } || Zd || Wc;kDr = tT ? false : kDr;kDr ? "R18+ " : ""}{def Na = ["CN", "JP", "KR", "KP", "TW", "HK"];def CeV = ["aeni", "donghua", "anime"];def TmD = any {anime} || info.Keywords.findAll { it in CeV } || (Na.contains(country) && genres =~ /Animation/);TmD ? "Anime/" : "TV Series/"}{def RA = "TheMovieDB::TV";def mP = [[DnM: 68854, bRo: "From Me to You", nD: RA],[DnM: 219816, bRo: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", nD: RA],[DnM: 234538, bRo: "Demon Lord 2099", nD: RA]];def CHV = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def tcZ = CHV == "IMDb" ? "tt${id}" : id;def Vxh = n;mP.each {if (it.DnM == tcZ && it.nD == CHV) {Vxh = it.bRo}};def Nuy = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rZ = Vxh.replaceAll(Nuy.collect { "\\" + it }.join('|'), '');rZ = rZ.replaceAll(/(\s|\.)*$/, '');rZ}{def RA = "TheMovieDB::TV";def _a = [[123542, RA],[235973, RA],[239779, RA],[257162, RA],[259140, RA]];def _pZ = _a.find { it[0] == id && it[1] == info.database } != null;def Nj = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def cuH = Nj[info.database];_pZ ? " ($y) [${cuH}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def Nuy = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rZ = sn.replaceAll(Nuy.collect { "\\" + it }.join('|'), '_');def aEt = n.replaceAll(Nuy.collect { "\\" + it }.join('|'), '_');def XHV = rZ.contains(aEt) ? "" : rZ;XHV == 'Season '+ s ? "" : XHV ? " - " + XHV : ""}{"/"}{def yOz = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws"];def ju = yOz.find { qb ->  fn.contains(qb) } ?: "";def UTH = any {(fn =~ /^\[(.*?)\]/)[0][1]} {ju} {group} {""};UTH ? "[$UTH] " : ""}{def RA = "TheMovieDB::TV";def mP = [[DnM: 68854, bRo: "From Me to You", nD: RA],[DnM: 219816, bRo: "Fate/Grand Order: Fujimaru Ritsuka Doesn't Get It", nD: RA],[DnM: 234538, bRo: "Demon Lord 2099", nD: RA]];def CHV = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def tcZ = CHV == "IMDb" ? "tt${id}" : id;def Vxh = n;mP.each {if (it.DnM == tcZ && it.nD == CHV) {Vxh = it.bRo}};def Nuy = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rZ = Vxh.replaceAll(Nuy.collect { "\\" + it }.join('|'), '');rZ = rZ.replaceAll(/(\s|\.)*$/, '');rZ}{" - "}{s00e00}{def Nuy = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def rZ = t.replaceAll(Nuy.collect { "\\" + it }.join('|'), '_');def VJR = any { e } { special };rZ = rZ.length() > 100 ? " " : " - $rZ ";rZ == " - Episode $VJR " ? " " : rZ}{" ["}{def PI = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def xpL = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def dK = ["Erai-raws", "SubsPlease"];def Tem = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def hBj = any {def Ya = PI.find { og ->  og.find { rjU ->  fn.lower().contains(rjU.lower()) } }[0];Ya = Ya.replace(".WEB-DL", "");def unc = source.contains("WEB-DL");def tV = source ? ".${source}" : "";unc ? "${Ya}.WEB-DL" : Ya ? "${Ya}${tV}" : ""} {} {source} {xpL.find { poP ->  group == poP || Tem == poP } ? "WEBRip" : ""} {def xqY = dK.find { Yj ->  group == Yj || Tem == Yj} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : xqY} {vs} {""};hBj ? "$hBj " : ""}{def SjE = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $SjE, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def ATK = " Dub";def WN = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : ATK;WN = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : WN;WN}{def sQ = any { audioLanguages.size() } { 0 };def WN = sQ > 2 ? " MAud" : sQ > 1 ? " DAud" : null;def llS = sQ > 5 ? audioLanguages.take(5) : audioLanguages;WN ? WN + llS.joining(" ", " (", "").upper() + (sQ > 5 ? " ...)" : ")") : ""}{def cNy = any { textLanguages.size() } { 0 };def WN = cNy > 2 ? ", MSub" : cNy > 1 ? ", DSub" : null;def llS = cNy > 5 ? textLanguages.take(5) : textLanguages;WN ? WN + llS.joining(" ", " (", "").upper() + (cNy > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def vN = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def XR = subt;vN.values().each { uL -> if (XR.contains(uL)) {XR = XR.replace(uL, "")}};vN.iso3b + XR}}{f.image ? "-thumb" : ""}