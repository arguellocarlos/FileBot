{def xOn = { System.getProperty(it) };def xtY = xOn("os.name").toLowerCase().contains("windows");def uBP = xOn("user.name");def cY = "/run/media/${uBP}";def DkX = xtY ? "H:/" : "$cY/Videos";def Gn = [[jUR: "Books", dr: "F:/", rz: "$cY/Books"],[jUR: "Data", dr: "D:/", rz: "$cY/Data"],[jUR: "Games", dr: "G:/", rz: "$cY/Games"],[jUR: "Music", dr: "E:/", rz: "$cY/Music"],[jUR: "Videos", dr: "H:/", rz: "$cY/Videos"]];def Lvv = (Gn.collect { it[xtY ? "dr" : "rz"] as File }.sort { MwE, GT ->  MwE.exists() <=> GT.exists() ?: MwE.diskSpace <=> GT.diskSpace }).last();def Jz = DkX ?: Lvv;"$Jz/"}{"Videos/"}{def Mug = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def rdk = "TheMovieDB::TV";def FC = [[ 74180, rdk],[ 93821, rdk],[ 95897, rdk],[220118, rdk],[249891, rdk],[271026, rdk]];def BS = [[236530, rdk]];def Fon = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def vl = Fon == "IMDb" ? "tt${id}" : id;def Ec = any { info.adult } { false };def pJE = FC.find { it[0] == vl && it[1] == Fon } != null;def NtA = BS.find { it[0] == vl && it[1] == Fon } != null;def cka = info.Keywords.findAll { it in Mug } || pJE || Ec;cka = NtA ? false : cka;cka ? "R18+ " : ""}{def wLj = ["CN", "JP", "KR", "KP", "TW", "HK"];def FXF = ["aeni", "donghua", "anime"];def aNo = any {anime} || info.Keywords.findAll { it in FXF } || (wLj.contains(country) && genres =~ /Animation/);aNo ? "Anime/" : "TV Series/"}{def rdk = "TheMovieDB::TV";def OD = [[UDw: 199928, wXe: "Nights With a Cat", MI: rdk],[UDw: 213830, wXe: "I Was Reincarnated as the 7th Prince", MI: rdk],[UDw: 232230, wXe: "Lord of the Mysteries", MI: rdk],[UDw: 248707, wXe: "Neko Oji The Guy That Got Reincarnated As a Cat", MI: rdk],[UDw: 270660, wXe: "Pochars", MI: rdk],[UDw: 277581, wXe: "Dekin no Mogura", MI: rdk],[UDw: 280038, wXe: "Apocalypse Bringer Mynoghra", MI: rdk],[UDw: 280078, wXe: "The All-devouring Whale Homecoming", MI: rdk],[UDw: 283704, wXe: "Fermat Kitchen", MI: rdk],[UDw: 283884, wXe: "Chuhai Lips", MI: rdk],[UDw: 288404, wXe: "The New Chronicles of Extraordinary Beings_ Preface", MI: rdk],[UDw: 288419, wXe: "Chikuwa Senki", MI: rdk]];def Fon = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def vl = Fon == "IMDb" ? "tt${id}" : id;def rgn = n;OD.each {if (it.UDw == vl && it.MI == Fon) {rgn = it.wXe}};def KSV = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Vjx = rgn.replaceAll(KSV.collect { "\\" + it }.join('|'), '');Vjx = Vjx.replaceAll(/(\s|\.)*$/, '');Vjx}{def rdk = "TheMovieDB::TV";def web = [[ 95897, rdk],[123542, rdk],[239779, rdk],[257162, rdk],[259140, rdk],[276204, rdk]];def LMW = web.find { it[0] == id && it[1] == info.database } != null;def _jH = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def bWH = _jH[info.database];LMW ? " ($y) [${bWH}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def KSV = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Vjx = sn.replaceAll(KSV.collect { "\\" + it }.join('|'), '_');def BI = n.replaceAll(KSV.collect { "\\" + it }.join('|'), '_');def CMD = Vjx.contains(BI) ? "" : Vjx;CMD == 'Season '+ s || CMD == 'Series '+ s ? "" : CMD ? " - " + CMD : ""}{"/"}{def wb = ["Alqanime","BlackLuster","darkflux","It's Anime","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def Ry = wb.find { PS ->  fn.lower().contains(PS.lower()) } ?: "";def de = any {Ry} {(fn =~ /^\[(.*?)\]/)[0][1]} {group} {""};de ? "[$de] " : ""}{def rdk = "TheMovieDB::TV";def OD = [[UDw: 199928, wXe: "Nights With a Cat", MI: rdk],[UDw: 213830, wXe: "I Was Reincarnated as the 7th Prince", MI: rdk],[UDw: 232230, wXe: "Lord of the Mysteries", MI: rdk],[UDw: 248707, wXe: "Neko Oji The Guy That Got Reincarnated As a Cat", MI: rdk],[UDw: 270660, wXe: "Pochars", MI: rdk],[UDw: 277581, wXe: "Dekin no Mogura", MI: rdk],[UDw: 280038, wXe: "Apocalypse Bringer Mynoghra", MI: rdk],[UDw: 280078, wXe: "The All-devouring Whale Homecoming", MI: rdk],[UDw: 283704, wXe: "Fermat Kitchen", MI: rdk],[UDw: 283884, wXe: "Chuhai Lips", MI: rdk],[UDw: 288404, wXe: "The New Chronicles of Extraordinary Beings_ Preface", MI: rdk],[UDw: 288419, wXe: "Chikuwa Senki", MI: rdk]];def Fon = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def vl = Fon == "IMDb" ? "tt${id}" : id;def rgn = n;OD.each {if (it.UDw == vl && it.MI == Fon) {rgn = it.wXe}};def KSV = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Vjx = rgn.replaceAll(KSV.collect { "\\" + it }.join('|'), '');Vjx = Vjx.replaceAll(/(\s|\.)*$/, '');Vjx}{" - "}{s00e00}{def KSV = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def Vjx = t.replaceAll(KSV.collect { "\\" + it }.join('|'), '_');Vjx = Vjx.length() > 100 ? " " : " - $Vjx ";def Ok = any { e } { special };def OYs = "Episode $Ok";def meg = Vjx.contains(OYs) ? '' : Vjx;meg != '' ? meg : ''}{" ["}{def TR = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA", "ABEMATV"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["CMIC", "COOLMIC"],["FOD"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LFTL", "LAFTEL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["OVEIL", "OV.WEB-DL", "OceanVeil"],["SHAHID"],["TVER"],["UNEXT"],["VIDIO"],["VIU"],["WETV"],["INSTA", "INSTAGRAM"],["ANIMENOTANE"]];def MCw = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def om = ["DB"];def FpI = ["Ruri-Saizen"];def lY = ["Erai-raws", "SubsPlease"];def Au = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def v_ = any {def Ls = TR.find { Jy ->  Jy.find { JUC ->  fn.lower().contains(JUC.lower()) } }[0];Ls = Ls.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {Ls = Ls.replace(".WEBRip", "");Ls = Ls + ".WEBRip"} else {Ls = Ls + ".WEB-DL"};Ls} {source} {MCw.find { Tp ->  group == Tp || Au == Tp } ? "WEBRip" : ""} {om.find { Tp ->  group == Tp || Au == Tp } ? "BDRip" : ""} {FpI.find { Tp ->  group == g__ || Au == g__} ? "HDTVRip" : ""} {def XBX = lY.find { AP ->  group == AP || Au == AP} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : XBX} {vs} {""};v_ ? "$v_ " : ""}{def SS = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $SS, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def ol = any { audioLanguages.size() } { 0 };def Xt_ = ol > 2 ? " MULTi-AUD" : ol > 1 ? " DUAL-AUD" : "";def UYp = ol > 5 ? audioLanguages.take(5) : audioLanguages;def Jo_ = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : " DUBBED";Xt_ = ol == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : "$Xt_$Jo_";Xt_ ? Xt_ + UYp.ISO2.joining(" ", " (", "").upper() + (ol > 5 ? " ...)" : ")") : ""}{def zOO = text.language.collect {['zh-Hans': 'ZH-S','zh-Hant': 'ZH-T','ar-001': 'AR-MSA'].get(it,it).toUpperCase()}.unique();def aG = any { zOO.size() } { 0 };def Xt_ = aG > 2 ? ", MULTi" : aG > 1 ? ", DUAL" : aG == 1 ? ", SUB" : null;def UYp = aG > 5 ? zOO.take(5) : zOO;Xt_ ? Xt_ + UYp.joining(" ", " (", "").upper() + (aG > 6 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def mE = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def bvH = subt;mE.values().each { aO -> if (bvH.contains(aO)) {bvH = bvH.replace(aO, "")}};mE.iso3b + bvH}}{f.image ? "-thumb" : ""}