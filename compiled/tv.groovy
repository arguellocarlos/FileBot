{def YZy = { System.getProperty(it) };def xX = YZy("os.name").toLowerCase().contains("windows");def Zt = YZy("user.name");def LL = "/run/media/${Zt}";def Wgr = xX ? "H:/" : "$LL/Videos";def UA = [[wjE: "Books", bR: "F:/", bG: "$LL/Books"],[wjE: "Data", bR: "D:/", bG: "$LL/Data"],[wjE: "Games", bR: "G:/", bG: "$LL/Games"],[wjE: "Music", bR: "E:/", bG: "$LL/Music"],[wjE: "Videos", bR: "H:/", bG: "$LL/Videos"]];def AMJ = (UA.collect { it[xX ? "bR" : "bG"] as File }.sort { _vv, VdD ->  _vv.exists() <=> VdD.exists() ?: _vv.diskSpace <=> VdD.diskSpace }).last();def WHA = Wgr ?: AMJ;"$WHA/"}{"Videos/"}{def fq = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def Rq = "TheMovieDB::TV";def L_m = [[271026, Rq],[220118, Rq],[ 74180, Rq]];def gXI = [[236530, Rq]];def iA = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def STk = iA == "IMDb" ? "tt${id}" : id;def lu = any { info.adult } { false };def Jc = L_m.find { it[0] == STk && it[1] == iA } != null;def da_ = gXI.find { it[0] == STk && it[1] == iA } != null;def Bg = info.Keywords.findAll { it in fq } || Jc || lu;Bg = da_ ? false : Bg;Bg ? "R18+ " : ""}{def cQ = ["CN", "JP", "KR", "KP", "TW", "HK"];def ap = ["aeni", "donghua", "anime"];def Cm = any {anime} || info.Keywords.findAll { it in ap } || (cQ.contains(country) && genres =~ /Animation/);Cm ? "Anime/" : "TV Series/"}{def Rq = "TheMovieDB::TV";def cJ = [[RG: 68854, CuV: "From Me to You", nn: Rq],[RG: 94904, CuV: "My Next Life as a Villainess", nn: Rq],[RG: 229743, CuV: "VTuber Legend", nn: Rq],[RG: 234538, CuV: "Demon Lord 2099", nn: Rq],[RG: 237045, CuV: "Cherry Magic!", nn: Rq],[RG: 240633, CuV: "A Journey Through Another World", nn: Rq],[RG: 245285, CuV: "Failure Frame", nn: Rq],[RG: 271026, CuV: "Taisho Era Contract Marriage", nn: Rq]];def iA = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def STk = iA == "IMDb" ? "tt${id}" : id;def xZ = n;cJ.each {if (it.RG == STk && it.nn == iA) {xZ = it.CuV}};def ohD = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dJE = xZ.replaceAll(ohD.collect { "\\" + it }.join('|'), '');dJE = dJE.replaceAll(/(\s|\.)*$/, '');dJE}{def Rq = "TheMovieDB::TV";def qPL = [[ 68854, Rq],[123542, Rq],[204098, Rq],[235973, Rq],[239779, Rq],[240125, Rq],[257162, Rq],[259140, Rq],[262295, Rq],[271026, Rq],[273190, Rq],[275695, Rq]];def yw = qPL.find { it[0] == id && it[1] == info.database } != null;def Mj = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def CQ = Mj[info.database];yw ? " ($y) [${CQ}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def ohD = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dJE = sn.replaceAll(ohD.collect { "\\" + it }.join('|'), '_');def Or = n.replaceAll(ohD.collect { "\\" + it }.join('|'), '_');def onR = dJE.contains(Or) ? "" : dJE;onR == 'Season '+ s ? "" : onR ? " - " + onR : ""}{"/"}{def LFB = ["Alqanime","BlackLuster","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws"];def SGL = LFB.find { CA ->  fn.contains(CA) } ?: "";def _OU = any {(fn =~ /^\[(.*?)\]/)[0][1]} {SGL} {group} {""};_OU ? "[$_OU] " : ""}{def Rq = "TheMovieDB::TV";def cJ = [[RG: 68854, CuV: "From Me to You", nn: Rq],[RG: 94904, CuV: "My Next Life as a Villainess", nn: Rq],[RG: 229743, CuV: "VTuber Legend", nn: Rq],[RG: 234538, CuV: "Demon Lord 2099", nn: Rq],[RG: 237045, CuV: "Cherry Magic!", nn: Rq],[RG: 240633, CuV: "A Journey Through Another World", nn: Rq],[RG: 245285, CuV: "Failure Frame", nn: Rq],[RG: 271026, CuV: "Taisho Era Contract Marriage", nn: Rq]];def iA = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def STk = iA == "IMDb" ? "tt${id}" : id;def xZ = n;cJ.each {if (it.RG == STk && it.nn == iA) {xZ = it.CuV}};def ohD = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dJE = xZ.replaceAll(ohD.collect { "\\" + it }.join('|'), '');dJE = dJE.replaceAll(/(\s|\.)*$/, '');dJE}{" - "}{s00e00}{def ohD = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dJE = t.replaceAll(ohD.collect { "\\" + it }.join('|'), '_');def rDb = any { e } { special };dJE = dJE.length() > 100 ? " " : " - $dJE ";dJE == " - Episode $rDb " ? " " : dJE}{" ["}{def FF = [["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"],["YT.WEB-DL", "YOUTUBE", "YTB"]];def Ggh = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def XK = ["Erai-raws", "SubsPlease"];def DcI = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def gDe = any {def Pg = FF.find { LU ->  LU.find { jGx ->  fn.lower().contains(jGx.lower()) } }[0];Pg = Pg.replace(".WEB-DL", "");Pg ? "${Pg}.WEB-DL" : ""} {} {source} {Ggh.find { lt_ ->  group == lt_ || DcI == lt_ } ? "WEBRip" : ""} {def yA = XK.find { fw ->  group == fw || DcI == fw} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : yA} {vs} {""};gDe ? "$gDe " : ""}{def sU = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $sU, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def MK = " Dub";def axN = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : MK;axN = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : axN;axN}{def IL = any { audioLanguages.size() } { 0 };def axN = IL > 2 ? " MAud" : IL > 1 ? " DAud" : null;def vO = IL > 5 ? audioLanguages.take(5) : audioLanguages;axN ? axN + vO.joining(" ", " (", "").upper() + (IL > 5 ? " ...)" : ")") : ""}{def nw = any { textLanguages.size() } { 0 };def axN = nw > 2 ? ", MSub" : nw > 1 ? ", DSub" : null;def vO = nw > 5 ? textLanguages.take(5) : textLanguages;axN ? axN + vO.joining(" ", " (", "").upper() + (nw > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def Pu = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def WW = subt;Pu.values().each { gTF -> if (WW.contains(gTF)) {WW = WW.replace(gTF, "")}};Pu.iso3b + WW}}{f.image ? "-thumb" : ""}