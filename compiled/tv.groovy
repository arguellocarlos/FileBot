{def KMd = { System.getProperty(it) };def Pes = KMd("os.name").toLowerCase().contains("windows");def qvn = KMd("user.name");def vJ = "/run/media/${qvn}";def Qe = Pes ? "H:/" : "$vJ/Videos";def qu = [[iih: "Books", hiq: "F:/", MoD: "$vJ/Books"],[iih: "Data", hiq: "D:/", MoD: "$vJ/Data"],[iih: "Games", hiq: "G:/", MoD: "$vJ/Games"],[iih: "Music", hiq: "E:/", MoD: "$vJ/Music"],[iih: "Videos", hiq: "H:/", MoD: "$vJ/Videos"]];def EKJ = (qu.collect { it[Pes ? "hiq" : "MoD"] as File }.sort { QU_, mR ->  QU_.exists() <=> mR.exists() ?: QU_.diskSpace <=> mR.diskSpace }).last();def oo_ = Qe ?: EKJ;"$oo_/"}{"Videos/"}{def iZ = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content","nudity", "animefesta"];def lsh = "TheMovieDB::TV";def sWf = [[ 74180, lsh],[ 93821, lsh],[ 95897, lsh],[220118, lsh],[249891, lsh],[271026, lsh]];def IS = [[236530, lsh]];def aF = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def YA = aF == "IMDb" ? "tt${id}" : id;def JT = any { info.adult } { false };def jED = sWf.find { it[0] == YA && it[1] == aF } != null;def cH = IS.find { it[0] == YA && it[1] == aF } != null;def JFU = info.Keywords.findAll { it in iZ } || jED || JT;JFU = cH ? false : JFU;JFU ? "R18+ " : ""}{def IT = ["CN", "JP", "KR", "KP", "TW", "HK"];def rg = ["aeni", "donghua", "anime"];def Tyx = any {anime} || info.Keywords.findAll { it in rg } || (IT.contains(country) && genres =~ /Animation/);Tyx ? "Anime/" : "TV Series/"}{def lsh = "TheMovieDB::TV";def tKu = [[wb: 68854, Ukw: "From Me to You", yo: lsh],[wb: 199928, Ukw: "Nights With a Cat", yo: lsh],[wb: 219816, Ukw: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", yo: lsh],[wb: 245561, Ukw: "Okitsura", yo: lsh],[wb: 248707, Ukw: "Neko Oji The Guy That Got Reincarnated As a Cat", yo: lsh],[wb: 259559, Ukw: "Headhunted to Another World", yo: lsh],[wb: 261301, Ukw: "Botsuraku Kizoku", yo: lsh],[wb: 262141, Ukw: "Can You Keep a Secret", yo: lsh],[wb: 270657, Ukw: "Tono to Inu", yo: lsh],[wb: 276204, Ukw: "Bogus Skill Fruitmaster", yo: lsh]];def aF = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def YA = aF == "IMDb" ? "tt${id}" : id;def XAF = n;tKu.each {if (it.wb == YA && it.yo == aF) {XAF = it.Ukw}};def vHt = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dX = XAF.replaceAll(vHt.collect { "\\" + it }.join('|'), '');dX = dX.replaceAll(/(\s|\.)*$/, '');dX}{def lsh = "TheMovieDB::TV";def XV = [[ 95897, lsh],[123542, lsh],[235973, lsh],[239779, lsh],[257162, lsh],[259140, lsh],[276204, lsh]];def PQM = XV.find { it[0] == id && it[1] == info.database } != null;def ha = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def hHC = ha[info.database];PQM ? " ($y) [${hHC}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def vHt = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dX = sn.replaceAll(vHt.collect { "\\" + it }.join('|'), '_');def fA = n.replaceAll(vHt.collect { "\\" + it }.join('|'), '_');def gB = dX.contains(fA) ? "" : dX;gB == 'Season '+ s || gB == 'Series '+ s ? "" : gB ? " - " + gB : ""}{"/"}{def UzP = ["Alqanime","BlackLuster","darkflux","Kuramanime","NanDesuKa","ToonsHub","Tsundere-Raws","S1PH3R","Samehadaku"];def SU = UzP.find { Inv ->  fn.lower().contains(Inv.lower()) } ?: "";def XcX = any {(fn =~ /^\[(.*?)\]/)[0][1]} {SU} {group} {""};XcX ? "[$XcX] " : ""}{def lsh = "TheMovieDB::TV";def tKu = [[wb: 68854, Ukw: "From Me to You", yo: lsh],[wb: 199928, Ukw: "Nights With a Cat", yo: lsh],[wb: 219816, Ukw: "Fate Grand Order Fujimaru Ritsuka Doesn't Get It", yo: lsh],[wb: 245561, Ukw: "Okitsura", yo: lsh],[wb: 248707, Ukw: "Neko Oji The Guy That Got Reincarnated As a Cat", yo: lsh],[wb: 259559, Ukw: "Headhunted to Another World", yo: lsh],[wb: 261301, Ukw: "Botsuraku Kizoku", yo: lsh],[wb: 262141, Ukw: "Can You Keep a Secret", yo: lsh],[wb: 270657, Ukw: "Tono to Inu", yo: lsh],[wb: 276204, Ukw: "Bogus Skill Fruitmaster", yo: lsh]];def aF = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def YA = aF == "IMDb" ? "tt${id}" : id;def XAF = n;tKu.each {if (it.wb == YA && it.yo == aF) {XAF = it.Ukw}};def vHt = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dX = XAF.replaceAll(vHt.collect { "\\" + it }.join('|'), '');dX = dX.replaceAll(/(\s|\.)*$/, '');dX}{" - "}{s00e00}{def vHt = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def dX = t.replaceAll(vHt.collect { "\\" + it }.join('|'), '_');dX = dX.length() > 100 ? " " : " - $dX ";def GQb = any { e } { special };def AY = "Episode $GQb";def DJ = dX.contains(AY) ? '' : dX;DJ != '' ? DJ : ''}{" ["}{def Ey = [["YTB", "YT.WEB-DL", "YOUTUBE"],["ABEMA"],["ADN"],["BILI", "B-Global", "BiliIntl"],["BSITE", "BILICN"],["COOLMIC"],["HIDIVE", "HIDI.WEB-DL"],["IQIYI", "IQ.WEB-DL"],["JFFP"],["LAFTEL", "LFTL"],["MDON", "MANGADON"],["MW.WEB-DL"],["NF.WEB-DL", "NF WEB"],["SHAHID"],["TVER"],["UNEXT"],["WETV"]];def Hwy = ["ASW", "Judas", "JRx7", "EMBER", "GuodongSubs", "SAMEHADAKU"];def pRw = ["DB"];def ML = ["Ruri-Saizen"];def cFy = ["Erai-raws", "SubsPlease"];def ez = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def zqw = any {def xJ = Ey.find { Iw ->  Iw.find { lD ->  fn.lower().contains(lD.lower()) } }[0];xJ = xJ.replace(".WEB-DL", "");if (fn.contains("WEBRip")) {xJ = xJ.replace(".WEBRip", "");xJ = xJ + ".WEBRip"} else {xJ = xJ + ".WEB-DL"};xJ} {source} {Hwy.find { wo ->  group == wo || ez == wo } ? "WEBRip" : ""} {pRw.find { wo ->  group == wo || ez == wo } ? "BDRip" : ""} {ML.find { wo ->  group == g__ || ez == g__} ? "HDTVRip" : ""} {def QF = cFy.find { Zex ->  group == Zex || ez == Zex} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : QF} {vs} {""};zqw ? "$zqw " : ""}{def Js = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $Js, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def nOU = " Dub";def HGZ = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : nOU;HGZ = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : HGZ;HGZ}{def myk = any { audioLanguages.size() } { 0 };def HGZ = myk > 2 ? " MAud" : myk > 1 ? " DAud" : null;def Nj = myk > 5 ? audioLanguages.take(5) : audioLanguages;HGZ ? HGZ + Nj.joining(" ", " (", "").upper() + (myk > 5 ? " ...)" : ")") : ""}{def QMJ = any { textLanguages.size() } { 0 };def HGZ = QMJ > 2 ? ", MSub" : QMJ > 1 ? ", DSub" : null;def Nj = QMJ > 5 ? textLanguages.take(5) : textLanguages;HGZ ? HGZ + Nj.joining(" ", " (", "").upper() + (QMJ > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{if (f.subtitle) {def tH = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def By = subt;tH.values().each { kyR -> if (By.contains(kyR)) {By = By.replace(kyR, "")}};tH.iso3b + By}}{f.image ? "-thumb" : ""}