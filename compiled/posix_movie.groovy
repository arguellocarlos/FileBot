{def dY = System.getProperty("user.name");def Nd = "/run/media/${dY}";def gn = "$Nd/Videos";def dx = [home,"$Nd/Data","$Nd/Music","$Nd/Videos","$Nd/Games","$Nd/Books"].collect { it as File }.sort { BR, JF ->  BR.exists() <=> JF.exists() ?: BR.diskSpace <=> JF.diskSpace }.last();def zbc = gn ? gn : dx;"$zbc/"}{def DQV = /(CN|JP|KR|KP|TW|HK)/;def XQK = /(aeni|donghua|anime)/;def Wmg = anime || info.Keywords =~ XQK || any {(genres =~ /Animation/ && country =~ DQV)}{false} ? true : false;def _P = Wmg ? "Videos/Anime " : "Videos/";"$_P" + "Movies/"}{def arL = [[DQ: 229743, rr: "VTuber Legend"],[DQ: 240633, rr: "A Journey Through Another World"],[DQ: 245285, rr: "Failure Frame"],[DQ: 237045, rr: "Cherry Magic!"],[DQ: 68854, rr: "From Me to You"],[DQ: 271026, rr: "Taisho Era Contract Marriage"],[DQ: 234538, rr: "Demon Lord 2099"]];def Hgm = n;arL.each {if (it.DQ == tmdbid && type.toString() != "Movie") {Hgm = it.rr}};def Fwi = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def whW = Hgm.replaceAll(Fwi.collect { "\\" + it }.join('|'), '');whW = whW.replaceAll(/(\s|\.)*$/, '');whW}{" ("}{y}{") [tmdbid-"}{tmdbid}{"]/"}{def Hoz = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def J_ = Hoz.find { BN ->  fn.contains(BN) } ?: "";def Qxa = any {(fn =~ /^\[(.*?)\]/)[0][1]} {J_} {group} {""};Qxa ? "[$Qxa] " : ""}{def arL = [[DQ: 229743, rr: "VTuber Legend"],[DQ: 240633, rr: "A Journey Through Another World"],[DQ: 245285, rr: "Failure Frame"],[DQ: 237045, rr: "Cherry Magic!"],[DQ: 68854, rr: "From Me to You"],[DQ: 271026, rr: "Taisho Era Contract Marriage"],[DQ: 234538, rr: "Demon Lord 2099"]];def Hgm = n;arL.each {if (it.DQ == tmdbid && type.toString() != "Movie") {Hgm = it.rr}};def Fwi = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def whW = Hgm.replaceAll(Fwi.collect { "\\" + it }.join('|'), '');whW = whW.replaceAll(/(\s|\.)*$/, '');whW}{" ("}{y}{")"} [{def bk = [[wtb: "Bilibili.tv", cUk: ["B-Global", "BiliIntl", "BILI"]],[wtb: "Prime Video", cUk: ["AMZN"]],[wtb: "U-NEXT", cUk: ["UNEXT"]],[wtb: "ABEMA", cUk: ["ABEMA"]],[wtb: "Hulu", cUk: ["HULU"]],[wtb: "Shahid", cUk: ["SHAHID"]],[wtb: "YouTube", cUk: ["YT.WEB-DL", "YOUTUBE", "YTB"]],[wtb: "Netflix", cUk: ["NF.WEB-DL", "NF WEB"]]];def cAh = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def rv = ["Erai-raws", "SubsPlease"];def _hk = (fn =~ /^\[(.*?)\]/)[0][1];def oJ = any {def fH = bk.find { hkP ->  hkP.cUk.find { Md ->  fn.contains(Md) } }?.cUk.first() ?: "";fH = fH.replace(".WEB-DL", "");fH ? "${fH}.WEB-DL" : ""} {source} {cAh.find { yfz ->  group == yfz || _hk == yfz } ? "WEBRip" : ""} {def ZzY = rv.find { FPt ->  group == FPt || _hk == FPt} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : ZzY} {vs} {""};oJ ? "$oJ " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def Xr = " Dub";def BWQ = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Xr;BWQ = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : BWQ;BWQ}{def _L = any { audioLanguages.size() } { 0 };def BWQ = _L > 2 ? " MAud" : _L > 1 ? " DAud" : null;def TiW = _L > 5 ? audioLanguages.take(5) : audioLanguages;BWQ ? BWQ + TiW.joining(" ", " (", "").upper() + (_L > 5 ? " ...)" : ")") : ""}{def cL = any { textLanguages.size() } { 0 };def BWQ = cL > 2 ? ", MSub" : cL > 1 ? ", DSub" : null;def TiW = cL > 5 ? textLanguages.take(5) : textLanguages;BWQ ? BWQ + TiW.joining(" ", " (", "").upper() + (cL > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}