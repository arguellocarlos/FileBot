{def Myl = System.getProperty("user.name");def Yr = "/run/media/${Myl}";def fs = "$Yr/Videos";def EhT = [home,"$Yr/Data","$Yr/Music","$Yr/Videos","$Yr/Games","$Yr/Books"].collect { it as File }.sort { RbJ,epV ->  RbJ.exists() <=> epV.exists() ?:RbJ.diskSpace <=> epV.diskSpace }.last();def Ks = fs ? fs : EhT;"$Ks/"}{"Videos/"}{def hJ = ["boys' love (bl)","gay theme","yaoi","yuri","lesbian","hentai","hentai","sex","lgbt","explicit","adult animation","adult content"];def OKv = "TheMovieDB::TV";def Gkq = [[271026,OKv],[220118,OKv]];def Pg = [[236530,OKv]];def Rf = any { info.database } { "IMDb" };def DKd = Rf == "IMDb" ? "tt${id}" : id;def V_m = any { info.adult } { false };def uIa = Gkq.find { it[0] == DKd && it[1] == Rf } != null;def ax = Pg.find { it[0] == DKd && it[1] == Rf } != null;def THT = info.Keywords.findAll { it in hJ } || uIa || V_m;THT = ax ? false : THT;THT ? "R18+ " : ""}{def VR = ["CN","JP","KR","KP","TW","HK"];def bH = ["aeni","donghua","anime"];def NP = any {anime} || info.Keywords.findAll { it in bH } || (VR.contains(country) && genres =~ /Animation/);NP ? "Anime Movies/" : "Movies/"}{def OKv = "TheMovieDB::TV";def Igc = [[DM:68854,voA:"From Me to You",zgG:OKv],[DM:229743,voA:"VTuber Legend",zgG:OKv],[DM:234538,voA:"Demon Lord 2099",zgG:OKv],[DM:237045,voA:"Cherry Magic!",zgG:OKv],[DM:240633,voA:"A Journey Through Another World",zgG:OKv],[DM:245285,voA:"Failure Frame",zgG:OKv],[DM:271026,voA:"Taisho Era Contract Marriage",zgG:OKv]];def Rf = any { info.database } { "IMDb" };def DKd = Rf == "IMDb" ? "tt${id}" : id;def cMH = n;Igc.each {if (it.DM == DKd && it.zgG == Rf) {cMH = it.voA}};def tp = ['\\','/',':','*','?','"','<','>','|'];def Ea = cMH.replaceAll(tp.collect { "\\" + it }.join('|'),'');Ea = Ea.replaceAll(/(\s|\.)*$/,'');Ea}{" ("}{y}{")"}{def Rf = any { info.database } { "IMDb" };def mwD = ["TheMovieDB":"tmdbid","TheTVDB::Movie":"tvdbid","IMDb":"imdbid"];def uy = mwD[Rf];def DKd = Rf == "IMDb" ? "tt${id}" : id;" [${uy}-${DKd}]/"}{def dR = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def RID = dR.find { OvC ->  fn.contains(OvC) } ?:"";def mzj = any {(fn =~ /^\[(.*?)\]/)[0][1]} {RID} {group} {""};mzj ? "[$mzj] " : ""}{def OKv = "TheMovieDB::TV";def Igc = [[DM:68854,voA:"From Me to You",zgG:OKv],[DM:229743,voA:"VTuber Legend",zgG:OKv],[DM:234538,voA:"Demon Lord 2099",zgG:OKv],[DM:237045,voA:"Cherry Magic!",zgG:OKv],[DM:240633,voA:"A Journey Through Another World",zgG:OKv],[DM:245285,voA:"Failure Frame",zgG:OKv],[DM:271026,voA:"Taisho Era Contract Marriage",zgG:OKv]];def Rf = any { info.database } { "IMDb" };def DKd = Rf == "IMDb" ? "tt${id}" : id;def cMH = n;Igc.each {if (it.DM == DKd && it.zgG == Rf) {cMH = it.voA}};def tp = ['\\','/',':','*','?','"','<','>','|'];def Ea = cMH.replaceAll(tp.collect { "\\" + it }.join('|'),'');Ea = Ea.replaceAll(/(\s|\.)*$/,'');Ea}{" ("}{y}{")"}{" ["}{def PO = [[pQ:"ABEMA",ipm:["ABEMA"]],[pQ:"Bilibili.tv",ipm:["B-Global","BiliIntl","BILI"]],[pQ:"Hulu",ipm:["HULU"]],[pQ:"MeWatch",ipm:["MW.WEB-DL"]],[pQ:"Netflix",ipm:["NF.WEB-DL","NF WEB"]],[pQ:"Prime Video",ipm:["AMZN"]],[pQ:"TVer",ipm:["TVER"]],[pQ:"Shahid",ipm:["SHAHID"]],[pQ:"U-NEXT",ipm:["UNEXT"]],[pQ:"YouTube",ipm:["YT.WEB-DL","YOUTUBE","YTB"]]];def UjW = ["ASW","Judas","JRx7","EMBER","KawaSubs","GuodongSubs"];def hI = ["Erai-raws","SubsPlease"];def vk = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def foB = any {def rXr = PO.find { VhC ->  VhC.ipm.find { ck ->  fn.contains(ck) } }?.ipm.first() ?:"";rXr = rXr.replace(".WEB-DL","");rXr ? "${rXr}.WEB-DL" : ""} {source} {UjW.find { vHb ->  group == vHb || vk == vHb } ? "WEBRip" : ""} {def yu = hI.find { oD ->  group == oD || vk == oD} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : yu} {vs} {""};foB ? "$foB " : ""}{def oW = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $oW,$ac"}{" "}{af.format(8:'DD+ 7.1',7:'6.1',6:'DD 5.1',5:'5.0',3:'2.1',2:'2.0',1:'1.0')}{def UJ = " Dub";def iV = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : UJ;iV = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : iV;iV}{def Ny = any { audioLanguages.size() } { 0 };def iV = Ny > 2 ? " MAud" : Ny > 1 ? " DAud" : null;def upE = Ny > 5 ? audioLanguages.take(5) : audioLanguages;iV ? iV + upE.joining(" "," (","").upper() + (Ny > 5 ? " ...)" : ")") : ""}{def Oa = any { textLanguages.size() } { 0 };def iV = Oa > 2 ? ",MSub" : Oa > 1 ? ",DSub" : null;def upE = Oa > 5 ? textLanguages.take(5) : textLanguages;iV ? iV + upE.joining(" "," (","").upper() + (Oa > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def FcN = ["ass","srt","ssa","vtt","ttml"];def EK = ["name":"." + lang.name,"iso3b":"." + lang.ISO3B,"iso3":"." +lang.ISO3,"iso2":"." + lang.ISO2];def vL = subt;EK.values().each { ixj -> if (vL.contains(ixj)) {vL = vL.replace(ixj,"")}};FcN.contains(ext) ? EK.iso3b + vL : ""}{def FcN = ["jpg","jpeg","png","bmp"];FcN.contains(ext) ? "-thumb" : ""}