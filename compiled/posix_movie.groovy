{def Hl = System.getProperty("user.name");def dXG = "/run/media/${Hl}";def np = "$dXG/Videos";def Wym = [home,"$dXG/Data","$dXG/Music","$dXG/Videos","$dXG/Games","$dXG/Books"].collect { it as File }.sort { rV, Wr ->  rV.exists() <=> Wr.exists() ?: rV.diskSpace <=> Wr.diskSpace }.last();def IXl = np ? np : Wym;"$IXl/"}{def yCG = /(CN|JP|KR|KP|TW|HK)/;def lo = /(aeni|donghua|anime)/;def Mwd = anime || info.Keywords =~ lo || any {(genres =~ /Animation/ && country =~ yCG)}{false} ? true : false;def DU = Mwd ? "Videos/Anime " : "Videos/";"$DU" + "Movies/"}{def BBh = [[fC: 229743, Va: "VTuber Legend"],[fC: 240633, Va: "A Journey Through Another World"],[fC: 245285, Va: "Failure Frame"],[fC: 237045, Va: "Cherry Magic!"],[fC: 68854, Va: "From Me to You"],[fC: 271026, Va: "Taisho Era Contract Marriage"],[fC: 234538, Va: "Demon Lord 2099"]];def tO = n;BBh.each {if (it.fC == tmdbid && type.toString() != "Movie") {tO = it.Va}};def GQP = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def BWO = tO.replaceAll(GQP.collect { "\\" + it }.join('|'), '');BWO = BWO.replaceAll(/(\s|\.)*$/, '');BWO}{" ("}{y}{") [tmdbid-"}{tmdbid}{"]/"}{def zM = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def Rah = zM.find { th ->  fn.contains(th) } ?: "";def ryH = any {(fn =~ /^\[(.*?)\]/)[0][1]} {Rah} {group} {""};ryH ? "[$ryH] " : ""}{def BBh = [[fC: 229743, Va: "VTuber Legend"],[fC: 240633, Va: "A Journey Through Another World"],[fC: 245285, Va: "Failure Frame"],[fC: 237045, Va: "Cherry Magic!"],[fC: 68854, Va: "From Me to You"],[fC: 271026, Va: "Taisho Era Contract Marriage"],[fC: 234538, Va: "Demon Lord 2099"]];def tO = n;BBh.each {if (it.fC == tmdbid && type.toString() != "Movie") {tO = it.Va}};def GQP = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def BWO = tO.replaceAll(GQP.collect { "\\" + it }.join('|'), '');BWO = BWO.replaceAll(/(\s|\.)*$/, '');BWO}{" ("}{y}{")"} [{def XRO = [[rjk: "Bilibili.tv", wt: ["B-Global", "BiliIntl", "BILI"]],[rjk: "Prime Video", wt: ["AMZN"]],[rjk: "U-NEXT", wt: ["UNEXT"]],[rjk: "ABEMA", wt: ["ABEMA"]],[rjk: "Hulu", wt: ["HULU"]],[rjk: "Shahid", wt: ["SHAHID"]],[rjk: "YouTube", wt: ["YT.WEB-DL", "YOUTUBE", "YTB"]],[rjk: "Netflix", wt: ["NF.WEB-DL", "NF WEB"]]];def hKF = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def wy = ["Erai-raws", "SubsPlease"];def ZGv = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def wU = any {def wjm = XRO.find { dKo ->  dKo.wt.find { ZPJ ->  fn.contains(ZPJ) } }?.wt.first() ?: "";wjm = wjm.replace(".WEB-DL", "");wjm ? "${wjm}.WEB-DL" : ""} {source} {hKF.find { PLZ ->  group == PLZ || ZGv == PLZ } ? "WEBRip" : ""} {def lMn = wy.find { OOo ->  group == OOo || ZGv == OOo} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : lMn} {vs} {""};wU ? "$wU " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def Jv = " Dub";def It = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Jv;It = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : It;It}{def Nir = any { audioLanguages.size() } { 0 };def It = Nir > 2 ? " MAud" : Nir > 1 ? " DAud" : null;def PBm = Nir > 5 ? audioLanguages.take(5) : audioLanguages;It ? It + PBm.joining(" ", " (", "").upper() + (Nir > 5 ? " ...)" : ")") : ""}{def GV = any { textLanguages.size() } { 0 };def It = GV > 2 ? ", MSub" : GV > 1 ? ", DSub" : null;def PBm = GV > 5 ? textLanguages.take(5) : textLanguages;It ? It + PBm.joining(" ", " (", "").upper() + (GV > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}