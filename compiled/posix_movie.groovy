{def Gtp = System.getProperty("user.name");def oSd = "/run/media/${Gtp}";def Jq = "$oSd/Videos";def TWR = [home,"$oSd/Data","$oSd/Music","$oSd/Videos","$oSd/Games","$oSd/Books"].collect { it as File }.sort { aC, Bd ->  aC.exists() <=> Bd.exists() ?: aC.diskSpace <=> Bd.diskSpace }.last();def _RW = Jq ? Jq : TWR;"$_RW/"}{def gFx = /(CN|JP|KR|KP|TW|HK)/;def VVY = /(aeni|donghua|anime)/;def Cy = anime || info.Keywords =~ VVY || any {(genres =~ /Animation/ && country =~ gFx)}{false} ? true : false;def Wf = Cy ? "Videos/Anime " : "Videos/";"$Wf" + "Movies/"}{def dS = [[MV: 229743, GE: "VTuber Legend"],[MV: 240633, GE: "A Journey Through Another World"],[MV: 245285, GE: "Failure Frame"],[MV: 237045, GE: "Cherry Magic!"],[MV: 68854, GE: "From Me to You"],[MV: 271026, GE: "Taisho Era Contract Marriage"],[MV: 234538, GE: "Demon Lord 2099"]];def jo = n;dS.each {if (it.MV == tmdbid && type.toString() != "Movie") {jo = it.GE}};def vp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def GAR = jo.replaceAll(vp.collect { "\\" + it }.join('|'), '');GAR = GAR.replaceAll(/(\s|\.)*$/, '');GAR}{" ("}{y}{") [tmdbid-"}{tmdbid}{"]/"}{def kTP = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def OZ = kTP.find { dn ->  fn.contains(dn) } ?: "";def uP = any {(fn =~ /^\[(.*?)\]/)[0][1]} {OZ} {group} {""};uP ? "[$uP] " : ""}{def dS = [[MV: 229743, GE: "VTuber Legend"],[MV: 240633, GE: "A Journey Through Another World"],[MV: 245285, GE: "Failure Frame"],[MV: 237045, GE: "Cherry Magic!"],[MV: 68854, GE: "From Me to You"],[MV: 271026, GE: "Taisho Era Contract Marriage"],[MV: 234538, GE: "Demon Lord 2099"]];def jo = n;dS.each {if (it.MV == tmdbid && type.toString() != "Movie") {jo = it.GE}};def vp = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def GAR = jo.replaceAll(vp.collect { "\\" + it }.join('|'), '');GAR = GAR.replaceAll(/(\s|\.)*$/, '');GAR}{" ("}{y}{")"} [{def QeY = [[XJa: "Bilibili.tv", hQ: ["B-Global", "BiliIntl", "BILI"]],[XJa: "Prime Video", hQ: ["AMZN"]],[XJa: "U-NEXT", hQ: ["UNEXT"]],[XJa: "ABEMA", hQ: ["ABEMA"]],[XJa: "Hulu", hQ: ["HULU"]],[XJa: "Shahid", hQ: ["SHAHID"]],[XJa: "YouTube", hQ: ["YT.WEB-DL", "YOUTUBE", "YTB"]],[XJa: "Netflix", hQ: ["NF.WEB-DL", "NF WEB"]]];def dw = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def UGJ = ["Erai-raws", "SubsPlease"];def mq = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def cn = any {def hO = QeY.find { gHy ->  gHy.hQ.find { ugb ->  fn.contains(ugb) } }?.hQ.first() ?: "";hO = hO.replace(".WEB-DL", "");hO ? "${hO}.WEB-DL" : ""} {source} {dw.find { YR ->  group == YR || mq == YR } ? "WEBRip" : ""} {def Wv = UGJ.find { wg ->  group == wg || mq == wg} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : Wv} {vs} {""};cn ? "$cn " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def Jt = " Dub";def CS = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Jt;CS = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : CS;CS}{def iM = any { audioLanguages.size() } { 0 };def CS = iM > 2 ? " MAud" : iM > 1 ? " DAud" : null;def Ji = iM > 5 ? audioLanguages.take(5) : audioLanguages;CS ? CS + Ji.joining(" ", " (", "").upper() + (iM > 5 ? " ...)" : ")") : ""}{def gUD = any { textLanguages.size() } { 0 };def CS = gUD > 2 ? ", MSub" : gUD > 1 ? ", DSub" : null;def Ji = gUD > 5 ? textLanguages.take(5) : textLanguages;CS ? CS + Ji.joining(" ", " (", "").upper() + (gUD > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}