{def cLa = "H:/";def Nw = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { Off, rQD ->  Off.exists() <=> rQD.exists() ?: Off.diskSpace <=> rQD.diskSpace }.last();def Tsk = cLa ? cLa : Nw;"$Tsk/"}{"Videos/"}{def sb = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","sex", "lgbt", "explicit", "adult animation", "adult content"];def fLN = "TheMovieDB::TV";def CX = [[271026, fLN],[220118, fLN],[ 74180, fLN]];def fCH = [[236530, fLN]];def B_ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def FKT = B_ == "IMDb" ? "tt${id}" : id;def YV = any { info.adult } { false };def lpS = CX.find { it[0] == FKT && it[1] == B_ } != null;def Vp = fCH.find { it[0] == FKT && it[1] == B_ } != null;def QJG = info.Keywords.findAll { it in sb } || lpS || YV;QJG = Vp ? false : QJG;QJG ? "R18+ " : ""}{def Wi = ["CN", "JP", "KR", "KP", "TW", "HK"];def YF = ["aeni", "donghua", "anime"];def Ce = any {anime} || info.Keywords.findAll { it in YF } || (Wi.contains(country) && genres =~ /Animation/);Ce ? "Anime/" : "TV Series/"}{def fLN = "TheMovieDB::TV";def hY = [[FE_: 68854, vO: "From Me to You", pf: fLN],[FE_: 94904, vO: "My Next Life as a Villainess", pf: fLN],[FE_: 229743, vO: "VTuber Legend", pf: fLN],[FE_: 234538, vO: "Demon Lord 2099", pf: fLN],[FE_: 237045, vO: "Cherry Magic!", pf: fLN],[FE_: 240633, vO: "A Journey Through Another World", pf: fLN],[FE_: 245285, vO: "Failure Frame", pf: fLN],[FE_: 271026, vO: "Taisho Era Contract Marriage", pf: fLN]];def B_ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def FKT = B_ == "IMDb" ? "tt${id}" : id;def LP = n;hY.each {if (it.FE_ == FKT && it.pf == B_) {LP = it.vO}};def hv = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def zQ = LP.replaceAll(hv.collect { "\\" + it }.join('|'), '');zQ = zQ.replaceAll(/(\s|\.)*$/, '');zQ}{def fLN = "TheMovieDB::TV";def aD = [[ 68854, fLN],[123542, fLN],[204098, fLN],[235973, fLN],[239779, fLN],[240125, fLN],[257162, fLN],[259140, fLN],[262295, fLN],[271026, fLN],[273190, fLN],[275695, fLN]];def uc = aD.find { it[0] == id && it[1] == info.database } != null;def fvO = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def sw = fvO[info.database];uc ? " ($y) [${sw}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def hv = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def zQ = sn.replaceAll(hv.collect { "\\" + it }.join('|'), '_');def At = n.replaceAll(hv.collect { "\\" + it }.join('|'), '_');def DlH = zQ.contains(At) ? "" : zQ;DlH == 'Season '+ s ? "" : DlH ? " - " + DlH : ""}{"/"}{def vTf = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def YDu = vTf.find { SRY ->  fn.contains(SRY) } ?: "";def N_d = any {(fn =~ /^\[(.*?)\]/)[0][1]} {YDu} {group} {""};N_d ? "[$N_d] " : ""}{def fLN = "TheMovieDB::TV";def hY = [[FE_: 68854, vO: "From Me to You", pf: fLN],[FE_: 94904, vO: "My Next Life as a Villainess", pf: fLN],[FE_: 229743, vO: "VTuber Legend", pf: fLN],[FE_: 234538, vO: "Demon Lord 2099", pf: fLN],[FE_: 237045, vO: "Cherry Magic!", pf: fLN],[FE_: 240633, vO: "A Journey Through Another World", pf: fLN],[FE_: 245285, vO: "Failure Frame", pf: fLN],[FE_: 271026, vO: "Taisho Era Contract Marriage", pf: fLN]];def B_ = any { info.database } { id == tmdbid ? "TheMovieDB" : "IMDb" };def FKT = B_ == "IMDb" ? "tt${id}" : id;def LP = n;hY.each {if (it.FE_ == FKT && it.pf == B_) {LP = it.vO}};def hv = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def zQ = LP.replaceAll(hv.collect { "\\" + it }.join('|'), '');zQ = zQ.replaceAll(/(\s|\.)*$/, '');zQ}{" - "}{s00e00}{def hv = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def zQ = t.replaceAll(hv.collect { "\\" + it }.join('|'), '_');def en = any { e } { special };zQ = zQ.length() > 100 ? " " : " - $zQ ";zQ == " - Episode $en " ? " " : zQ}{" ["}{def uv = [[IU: "ABEMA", bO: ["ABEMA"]],[IU: "Bilibili.tv", bO: ["BILI", "B-Global", "BiliIntl", "B-Site", "BiliCN"]],[IU: "Hulu", bO: ["HULU"]],[IU: "iQIYI", bO: ["IQ.WEB-DL", "IQIYI"]],[IU: "MeWatch", bO: ["MW.WEB-DL"]],[IU: "Netflix", bO: ["NF.WEB-DL", "NF WEB"]],[IU: "Prime Video", bO: ["AMZN"]],[IU: "Shahid", bO: ["SHAHID"]],[IU: "TVer", bO: ["TVER"]],[IU: "U-NEXT", bO: ["UNEXT"]],[IU: "YouTube", bO: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def To = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def sX = ["Erai-raws", "SubsPlease"];def VK = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def eL = any {def PR = uv.find { zd ->  zd.bO.find { QRM ->  fn.contains(QRM) } }?.bO.Off() ?: "";PR = PR.replace(".WEB-DL", "");PR ? "${PR}.WEB-DL" : ""} {source} {To.find { zUd ->  group == zUd || VK == zUd } ? "WEBRip" : ""} {def PJt = sX.find { soH ->  group == soH || VK == soH} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : PJt} {vs} {""};eL ? "$eL " : ""}{def tUn = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $tUn, $ac"}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0')}{def _ev = " Dub";def zp = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : _ev;zp = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : zp;zp}{def xVc = any { audioLanguages.size() } { 0 };def zp = xVc > 2 ? " MAud" : xVc > 1 ? " DAud" : null;def lh = xVc > 5 ? audioLanguages.take(5) : audioLanguages;zp ? zp + lh.joining(" ", " (", "").upper() + (xVc > 5 ? " ...)" : ")") : ""}{def VF = any { textLanguages.size() } { 0 };def zp = VF > 2 ? ", MSub" : VF > 1 ? ", DSub" : null;def lh = VF > 5 ? textLanguages.take(5) : textLanguages;zp ? zp + lh.joining(" ", " (", "").upper() + (VF > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def SD = ["ass", "srt", "ssa", "vtt", "ttml"];def Zb = ["name": "." + lang.name,"iso3b": "." + lang.ISO3B,"iso3": "." +lang.ISO3,"iso2": "." + lang.ISO2];def Sb = subt;Zb.values().each { hSb -> if (Sb.contains(hSb)) {Sb = Sb.replace(hSb, "")}};SD.contains(ext) ? Zb.iso3b + Sb : ""}{def SD = ["jpg", "jpeg", "png", "bmp"];SD.contains(ext) ? "-thumb" : ""}