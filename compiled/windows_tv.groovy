{def kDO = "H:/";def bv = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { pWl, _Y ->  pWl.exists() <=> _Y.exists() ?: pWl.diskSpace <=> _Y.diskSpace }.last();def JG = kDO ? kDO : bv;"$JG/"}{"Videos/"}{def t_ = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","hentai", "sex", "lgbt", "explicit", "adult animation", "adult content"];def YpX = "TheMovieDB::TV";def KNw = [[271026, YpX],[220118, YpX]];def qLh = [[236530, YpX]];def RF = any { info.RF } { "IMDb" };def nxl = RF == "IMDb" ? "tt${id}" : id;def VO = any { info.adult } { false };def pb = KNw.find { it[0] == nxl && it[1] == RF } != null;def Ebf = qLh.find { it[0] == nxl && it[1] == RF } != null;def gc = info.Keywords.findAll { it in t_ } || pb || VO;gc = Ebf ? false : gc;gc ? "R18+ " : ""}{def bp = ["CN", "JP", "KR", "KP", "TW", "HK"];def ckv = ["aeni", "donghua", "anime"];def gz = any {anime} || info.Keywords.findAll { it in ckv } || (bp.contains(country) && genres =~ /Animation/);gz ? "Anime/" : "TV Series/"}{def YpX = "TheMovieDB::TV";def rvQ = [[EFS: 68854, iyF: "From Me to You", WV: YpX],[EFS: 229743, iyF: "VTuber Legend", WV: YpX],[EFS: 234538, iyF: "Demon Lord 2099", WV: YpX],[EFS: 237045, iyF: "Cherry Magic!", WV: YpX],[EFS: 240633, iyF: "A Journey Through Another World", WV: YpX],[EFS: 245285, iyF: "Failure Frame", WV: YpX],[EFS: 271026, iyF: "Taisho Era Contract Marriage", WV: YpX]];def RF = any { info.RF } { "IMDb" };def nxl = RF == "IMDb" ? "tt${id}" : id;def dbY = n;rvQ.each {if (it.EFS == nxl && it.WV == RF) {dbY = it.iyF}};def gs = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def sz = dbY.replaceAll(gs.collect { "\\" + it }.join('|'), '');sz = sz.replaceAll(/(\s|\.)*$/, '');sz}{def YpX = "TheMovieDB::TV";def Ph = [[ 68854, YpX],[123542, YpX],[204098, YpX],[235973, YpX],[239779, YpX],[240125, YpX],[257162, YpX],[259140, YpX],[262295, YpX],[271026, YpX],[273190, YpX],[275695, YpX]];def Ht = Ph.find { it[0] == id && it[1] == info.RF } != null;def lr = ["TheMovieDB::TV": "tmdbid","AniDB": "anidbid","TheTVDB": "tvdbid","TVmaze": "tvmazeid"];def BA = lr[info.RF];Ht ? " ($y) [${BA}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def gs = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def sz = sn.replaceAll(gs.collect { "\\" + it }.join('|'), '_');def PWt = n.replaceAll(gs.collect { "\\" + it }.join('|'), '_');def Uad = sz.contains(PWt) ? "" : sz;Uad == 'Season '+ s ? "" : Uad ? " - " + Uad : ""}{"/"}{def oB = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def fo = oB.find { Pw ->  fn.contains(Pw) } ?: "";def aTk = any {(fn =~ /^\[(.*?)\]/)[0][1]} {fo} {group} {""};aTk ? "[$aTk] " : ""}{def YpX = "TheMovieDB::TV";def rvQ = [[EFS: 68854, iyF: "From Me to You", WV: YpX],[EFS: 229743, iyF: "VTuber Legend", WV: YpX],[EFS: 234538, iyF: "Demon Lord 2099", WV: YpX],[EFS: 237045, iyF: "Cherry Magic!", WV: YpX],[EFS: 240633, iyF: "A Journey Through Another World", WV: YpX],[EFS: 245285, iyF: "Failure Frame", WV: YpX],[EFS: 271026, iyF: "Taisho Era Contract Marriage", WV: YpX]];def RF = any { info.RF } { "IMDb" };def nxl = RF == "IMDb" ? "tt${id}" : id;def dbY = n;rvQ.each {if (it.EFS == nxl && it.WV == RF) {dbY = it.iyF}};def gs = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def sz = dbY.replaceAll(gs.collect { "\\" + it }.join('|'), '');sz = sz.replaceAll(/(\s|\.)*$/, '');sz}{" - "}{s00e00}{def gs = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def sz = t.replaceAll(gs.collect { "\\" + it }.join('|'), '_');def ofu = any { e } { special };sz = sz.length() > 100 ? " " : " - $sz ";sz == " - Episode $ofu " ? " " : sz}{" ["}{def fXY = [[DLy: "ABEMA", Pxd: ["ABEMA"]],[DLy: "Bilibili.tv", Pxd: ["B-Global", "BiliIntl", "BILI"]],[DLy: "Hulu", Pxd: ["HULU"]],[DLy: "MeWatch", Pxd: ["MW.WEB-DL"]],[DLy: "Netflix", Pxd: ["NF.WEB-DL", "NF WEB"]],[DLy: "Prime Video", Pxd: ["AMZN"]],[DLy: "TVer", Pxd: ["TVER"]],[DLy: "Shahid", Pxd: ["SHAHID"]],[DLy: "U-NEXT", Pxd: ["UNEXT"]],[DLy: "YouTube", Pxd: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def uZP = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def Hrv = ["Erai-raws", "SubsPlease"];def al = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def _W = any {def StH = fXY.find { nwj ->  nwj.Pxd.find { aoG ->  fn.contains(aoG) } }?.Pxd.first() ?: "";StH = StH.replace(".WEB-DL", "");StH ? "${StH}.WEB-DL" : ""} {source} {uZP.find { Kzr ->  group == Kzr || al == Kzr } ? "WEBRip" : ""} {def qVm = Hrv.find { OR ->  group == OR || al == OR} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : qVm} {vs} {""};_W ? "$_W " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac}{" "}{af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def mvU = " Dub";def MZ = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : mvU;MZ = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : MZ;MZ}{def xsh = any { audioLanguages.size() } { 0 };def MZ = xsh > 2 ? " MAud" : xsh > 1 ? " DAud" : null;def Wx = xsh > 5 ? audioLanguages.take(5) : audioLanguages;MZ ? MZ + Wx.joining(" ", " (", "").upper() + (xsh > 5 ? " ...)" : ")") : ""}{def SqP = any { textLanguages.size() } { 0 };def MZ = SqP > 2 ? ", MSub" : SqP > 1 ? ", DSub" : null;def Wx = SqP > 5 ? textLanguages.take(5) : textLanguages;MZ ? MZ + Wx.joining(" ", " (", "").upper() + (SqP > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}