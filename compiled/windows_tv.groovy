{def gMK = "H:/";def MtF = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { nNp, IDe ->  nNp.exists() <=> IDe.exists() ?: nNp.diskSpace <=> IDe.diskSpace }.last();def UQ = gMK ? gMK : MtF;"$UQ/"}{"Videos/"}{def pzG = ["boys' love (bl)", "gay theme", "yaoi", "yuri", "lesbian", "hentai","hentai", "sex", "lgbt", "explicit", "adult animation", "adult content"];def mlF = [271026,220118];def zhl = any { info.adult } { false };def XlM = any { info.Keywords.findAll { it in pzG } } { id in mlF } { zhl };XlM ? "R18+ " : ""}{def zF = ["CN", "JP", "KR", "KP", "TW", "HK"];def eA = ["aeni", "donghua", "anime"];def UU = any { anime } { info.Keywords.findAll { it in eA } } { zF.contains(country) } { false };UU && genres =~ /Animation/ ? "Anime/" : "TV Series/"}{def MlQ = [[fQE: 229743, oxU: "VTuber Legend"],[fQE: 240633, oxU: "A Journey Through Another World"],[fQE: 245285, oxU: "Failure Frame"],[fQE: 237045, oxU: "Cherry Magic!"],[fQE: 68854, oxU: "From Me to You"],[fQE: 271026, oxU: "Taisho Era Contract Marriage"],[fQE: 234538, oxU: "Demon Lord 2099"]];def tp = n;MlQ.each {if (it.fQE == tmdbid && type.toString() != "Movie") {tp = it.oxU}};def Mc = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tTw = tp.replaceAll(Mc.collect { "\\" + it }.join('|'), '');tTw = tTw.replaceAll(/(\s|\.)*$/, '');tTw}{def fwe = [68854,235973,262295,259140,204098,239779,273190,271026,240125,275695,123542,257162];def sor = fwe.find { ax ->  tmdbid == ax } ?: "";sor ? " ($y) [tmdbid-$sor]" : ""}/{episode.special ? 'Specials' : 'Season '+s}{def Mc = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tTw = sn.replaceAll(Mc.collect { "\\" + it }.join('|'), '_');def Gh = n.replaceAll(Mc.collect { "\\" + it }.join('|'), '_');def YQJ = tTw.contains(Gh) ? "" : tTw;YQJ == 'Season '+ s ? "" : YQJ ? " - " + YQJ : ""}/{def Pxu = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def GHE = Pxu.find { INk ->  fn.contains(INk) } ?: "";def gFU = any {(fn =~ /^\[(.*?)\]/)[0][1]} {GHE} {group} {""};gFU ? "[$gFU] " : ""}{def MlQ = [[fQE: 229743, oxU: "VTuber Legend"],[fQE: 240633, oxU: "A Journey Through Another World"],[fQE: 245285, oxU: "Failure Frame"],[fQE: 237045, oxU: "Cherry Magic!"],[fQE: 68854, oxU: "From Me to You"],[fQE: 271026, oxU: "Taisho Era Contract Marriage"],[fQE: 234538, oxU: "Demon Lord 2099"]];def tp = n;MlQ.each {if (it.fQE == tmdbid && type.toString() != "Movie") {tp = it.oxU}};def Mc = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tTw = tp.replaceAll(Mc.collect { "\\" + it }.join('|'), '');tTw = tTw.replaceAll(/(\s|\.)*$/, '');tTw} - {s00e00}{def Mc = ['\\', '/', ':', '*', '?', '"', '<', '>', '|'];def tTw = t.replaceAll(Mc.collect { "\\" + it }.join('|'), '_');def LVj = any { e } { special };tTw = tTw.length() > 100 ? " " : " - $tTw ";tTw == " - Episode $LVj " ? " " : tTw} [{def KnB = [[ZM: "ABEMA", SvN: ["ABEMA"]],[ZM: "Bilibili.tv", SvN: ["B-Global", "BiliIntl", "BILI"]],[ZM: "Hulu", SvN: ["HULU"]],[ZM: "MeWatch", SvN: ["MW.WEB-DL"]],[ZM: "Netflix", SvN: ["NF.WEB-DL", "NF WEB"]],[ZM: "Prime Video", SvN: ["AMZN"]],[ZM: "TVer", SvN: ["TVER"]],[ZM: "Shahid", SvN: ["SHAHID"]],[ZM: "U-NEXT", SvN: ["UNEXT"]],[ZM: "YouTube", SvN: ["YT.WEB-DL", "YOUTUBE", "YTB"]]];def dW = ["ASW", "Judas", "JRx7", "EMBER", "KawaSubs", "GuodongSubs"];def kyd = ["Erai-raws", "SubsPlease"];def qYh = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def mby = any {def rW = KnB.find { te ->  te.SvN.find { ndE ->  fn.contains(ndE) } }?.SvN.first() ?: "";rW = rW.replace(".WEB-DL", "");rW ? "${rW}.WEB-DL" : ""} {source} {dW.find { Ji ->  group == Ji || qYh == Ji } ? "WEBRip" : ""} {def rH = kyd.find { nJ ->  group == nJ || qYh == nJ} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : rH} {vs} {""};mby ? "$mby " : ""}{resolution} {vcf.upper()}{bitdepth ? " ${bitdepth}bit" : ""}, {ac} {af.format(8: 'DD+ 7.1',7: '6.1',6: 'DD 5.1',5: '5.0',3: '2.1',2: '2.0',1: '1.0',)}{def cu = " Dub";def cHE = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : cu;cHE = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : cHE;cHE}{def dDb = any { audioLanguages.size() } { 0 };def cHE = dDb > 2 ? " MAud" : dDb > 1 ? " DAud" : null;def go = dDb > 5 ? audioLanguages.take(5) : audioLanguages;cHE ? cHE + go.joining(" ", " (", "").upper() + (dDb > 5 ? " ...)" : ")") : ""}{def Sf = any { textLanguages.size() } { 0 };def cHE = Sf > 2 ? ", MSub" : Sf > 1 ? ", DSub" : null;def go = Sf > 5 ? textLanguages.take(5) : textLanguages;cHE ? cHE + go.joining(" ", " (", "").upper() + (Sf > 5 ? " ...)" : ")") : ""}][{crc32.upper()}]{ext =~ /(ass|srt|ssa|vtt)/ ? '.' + lang.ISO3B : ""}{ext =~ /jp(?:e)?g|png/ ? "-thumb" : ""}