{def fvF = "H:/";def hJ = [home,"D:/","E:/","F:/","G:/","H:/"].collect { it as File }.sort { Ik,NJ ->  Ik.exists() <=> NJ.exists() ?:Ik.diskSpace <=> NJ.diskSpace }.last();def iV = fvF ? fvF : hJ;"$iV/"}{"Videos/"}{def BRh = ["boys' love (bl)","gay theme","yaoi","yuri","lesbian","hentai","hentai","sex","lgbt","explicit","adult animation","adult content"];def Pb = "TheMovieDB::TV";def tko = [[271026,Pb],[220118,Pb]];def ZnW = [[236530,Pb]];def mk = any { info.database } { "IMDb" };def SDO = mk == "IMDb" ? "tt${id}" : id;def Js = any { info.adult } { false };def ETS = tko.find { it[0] == SDO && it[1] == mk } != null;def Ok = ZnW.find { it[0] == SDO && it[1] == mk } != null;def JSX = info.Keywords.findAll { it in BRh } || ETS || Js;JSX = Ok ? false : JSX;JSX ? "R18+ " : ""}{def ke = ["CN","JP","KR","KP","TW","HK"];def eq = ["aeni","donghua","anime"];def sr = any {anime} || info.Keywords.findAll { it in eq } || (ke.contains(country) && genres =~ /Animation/);sr ? "Anime/" : "TV Series/"}{def Pb = "TheMovieDB::TV";def lo = [[Ii:68854,uhP:"From Me to You",pg:Pb],[Ii:229743,uhP:"VTuber Legend",pg:Pb],[Ii:234538,uhP:"Demon Lord 2099",pg:Pb],[Ii:237045,uhP:"Cherry Magic!",pg:Pb],[Ii:240633,uhP:"A Journey Through Another World",pg:Pb],[Ii:245285,uhP:"Failure Frame",pg:Pb],[Ii:271026,uhP:"Taisho Era Contract Marriage",pg:Pb]];def mk = any { info.database } { "IMDb" };def SDO = mk == "IMDb" ? "tt${id}" : id;def eo = n;lo.each {if (it.Ii == SDO && it.pg == mk) {eo = it.uhP}};def Evw = ['\\','/',':','*','?','"','<','>','|'];def Fzq = eo.replaceAll(Evw.collect { "\\" + it }.join('|'),'');Fzq = Fzq.replaceAll(/(\s|\.)*$/,'');Fzq}{def Pb = "TheMovieDB::TV";def Aj = [[ 68854,Pb],[123542,Pb],[204098,Pb],[235973,Pb],[239779,Pb],[240125,Pb],[257162,Pb],[259140,Pb],[262295,Pb],[271026,Pb],[273190,Pb],[275695,Pb]];def aV = Aj.find { it[0] == id && it[1] == info.database } != null;def g_S = ["TheMovieDB::TV":"tmdbid","AniDB":"anidbid","TheTVDB":"tvdbid","TVmaze":"tvmazeid"];def ZZw = g_S[info.database];aV ? " ($y) [${ZZw}-${id}]" : ""}{"/"}{episode.special ? 'Specials' : 'Season '+s}{def Evw = ['\\','/',':','*','?','"','<','>','|'];def Fzq = sn.replaceAll(Evw.collect { "\\" + it }.join('|'),'_');def sgz = n.replaceAll(Evw.collect { "\\" + it }.join('|'),'_');def BbT = Fzq.contains(sgz) ? "" : Fzq;BbT == 'Season '+ s ? "" : BbT ? " - " + BbT : ""}{"/"}{def KI = ["Alqanime","BlackLuster","NanDesuKa","ToonsHub","Tsundere-Raws"];def wkc = KI.find { sk ->  fn.contains(sk) } ?:"";def wj = any {(fn =~ /^\[(.*?)\]/)[0][1]} {wkc} {group} {""};wj ? "[$wj] " : ""}{def Pb = "TheMovieDB::TV";def lo = [[Ii:68854,uhP:"From Me to You",pg:Pb],[Ii:229743,uhP:"VTuber Legend",pg:Pb],[Ii:234538,uhP:"Demon Lord 2099",pg:Pb],[Ii:237045,uhP:"Cherry Magic!",pg:Pb],[Ii:240633,uhP:"A Journey Through Another World",pg:Pb],[Ii:245285,uhP:"Failure Frame",pg:Pb],[Ii:271026,uhP:"Taisho Era Contract Marriage",pg:Pb]];def mk = any { info.database } { "IMDb" };def SDO = mk == "IMDb" ? "tt${id}" : id;def eo = n;lo.each {if (it.Ii == SDO && it.pg == mk) {eo = it.uhP}};def Evw = ['\\','/',':','*','?','"','<','>','|'];def Fzq = eo.replaceAll(Evw.collect { "\\" + it }.join('|'),'');Fzq = Fzq.replaceAll(/(\s|\.)*$/,'');Fzq}{" - "}{s00e00}{def Evw = ['\\','/',':','*','?','"','<','>','|'];def Fzq = t.replaceAll(Evw.collect { "\\" + it }.join('|'),'_');def FF = any { e } { special };Fzq = Fzq.length() > 100 ? " " : " - $Fzq ";Fzq == " - Episode $FF " ? " " : Fzq}{" ["}{def JZK = [[VHS:"ABEMA",Gm:["ABEMA"]],[VHS:"Bilibili.tv",Gm:["B-Global","BiliIntl","BILI"]],[VHS:"Hulu",Gm:["HULU"]],[VHS:"MeWatch",Gm:["MW.WEB-DL"]],[VHS:"Netflix",Gm:["NF.WEB-DL","NF WEB"]],[VHS:"Prime Video",Gm:["AMZN"]],[VHS:"TVer",Gm:["TVER"]],[VHS:"Shahid",Gm:["SHAHID"]],[VHS:"U-NEXT",Gm:["UNEXT"]],[VHS:"YouTube",Gm:["YT.WEB-DL","YOUTUBE","YTB"]]];def HR = ["ASW","Judas","JRx7","EMBER","KawaSubs","GuodongSubs"];def wZ = ["Erai-raws","SubsPlease"];def YtU = any {(fn =~ /^\[(.*?)\]/)[0][1]} {""};def gE = any {def iCL = JZK.find { vHy ->  vHy.Gm.find { hA ->  fn.contains(hA) } }?.Gm.first() ?:"";iCL = iCL.replace(".WEB-DL","");iCL ? "${iCL}.WEB-DL" : ""} {source} {HR.find { UT ->  group == UT || YtU == UT } ? "WEBRip" : ""} {def cPY = wZ.find { cj ->  group == cj || YtU == cj} ? "WEB-DL" : "";(source == "Erai-raws" && vcf.upper() == "HEVC") ? "WEBRip" : cPY} {vs} {""};gE ? "$gE " : ""}{def jXw = bitdepth ? " ${bitdepth}bit" : "";"$resolution $vcf $jXw,$ac"}{" "}{af.format(8:'DD+ 7.1',7:'6.1',6:'DD 5.1',5:'5.0',3:'2.1',2:'2.0',1:'1.0')}{def Jva = " Dub";def hv = audioLanguages.any { it.ISO3B == language.ISO3B } ? "" : Jva;hv = audioLanguages.size() == 1 && audioLanguages.any { it.ISO3B == "und" } ? "" : hv;hv}{def AA = any { audioLanguages.size() } { 0 };def hv = AA > 2 ? " MAud" : AA > 1 ? " DAud" : null;def BO = AA > 5 ? audioLanguages.take(5) : audioLanguages;hv ? hv + BO.joining(" "," (","").upper() + (AA > 5 ? " ...)" : ")") : ""}{def W_ = any { textLanguages.size() } { 0 };def hv = W_ > 2 ? ",MSub" : W_ > 1 ? ",DSub" : null;def BO = W_ > 5 ? textLanguages.take(5) : textLanguages;hv ? hv + BO.joining(" "," (","").upper() + (W_ > 5 ? " ...)" : ")") : ""}{"]["}{crc32.upper()}{"]"}{def _dk = ["ass","srt","ssa","vtt","ttml"];def xdk = ["name":"." + lang.name,"iso3b":"." + lang.ISO3B,"iso3":"." +lang.ISO3,"iso2":"." + lang.ISO2];def RWD = subt;xdk.values().each { wxr -> if (RWD.contains(wxr)) {RWD = RWD.replace(wxr,"")}};_dk.contains(ext) ? xdk.iso3b + RWD : ""}{def _dk = ["jpg","jpeg","png","bmp"];_dk.contains(ext) ? "-thumb" : ""}